"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../common/assets.js"),a=require("../../../../api/device.js"),s=require("../../hooks/useDevice.js"),u=require("../../../../enums/appEnums.js"),i=require("../../hooks/useDeviceWs.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),require("../../../../hooks/useWebSocket.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-icon")+e.resolveComponent("z-paging")+e.resolveComponent("u-button")+e.resolveComponent("u-popup")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js"))();const n=e.defineComponent({__name:"auto_task",setup(n){const{platformLogo:o}=s.useDevice(),{send:c,onEvent:r,close:p}=i.useDeviceWs(),l=e.ref(Object.values(o).map((e=>({...e,icon:e.activeIcon})))),m=e.ref(null),d=e.ref(!1),v=e.ref(0),_=e.ref([]),f=e.ref(!0),g=e.ref(""),h=e.ref({}),y=e.ref({}),b=e.ref(!1),k=e.ref(!1),j={key:"clues_setting",name:"关键词获客",status:0,platform:[o[u.AppTypeEnum.SPH]],color:"#CADEFD"},E={key:"takeover_setting",name:"私信接管",status:0,platform:[o[u.AppTypeEnum.XHS],o[u.AppTypeEnum.DOUYIN],o[u.AppTypeEnum.KUAISHOU]],color:"#CADEFD"},A={key:"publish_setting",name:"社媒平台发布内容",status:0,platform:[o[u.AppTypeEnum.XHS],o[u.AppTypeEnum.DOUYIN],o[u.AppTypeEnum.KUAISHOU],{activeIcon:t.SphIcon}],color:"#BCFFB5"},q={key:"circle_interaction",name:"朋友圈互动",status:4,platform:[{activeIcon:t.CircleIcon}],color:"#DAD4FF"},I={key:"touch_setting",name:"评论区获客",status:0,platform:[o[u.AppTypeEnum.DOUYIN],o[u.AppTypeEnum.KUAISHOU],o[u.AppTypeEnum.XHS],o[u.AppTypeEnum.SPH]],color:"#FFE4C1"},x={key:"add_wechat_setting",name:"自动加微",status:0,platform:[o[u.AppTypeEnum.WECHAT]],color:"#DAD4FF"},T={key:"auto_account",name:"自动养号",status:3,platform:[o[u.AppTypeEnum.XHS],o[u.AppTypeEnum.DOUYIN],o[u.AppTypeEnum.KUAISHOU],o[u.AppTypeEnum.SPH]],color:"#FFE4C1"},D=e.ref([{...j,time:["01:00","06:00"],platform:[{activeIcon:t.SphIcon}]},{...E,time:["06:00","07:30"]},{...A,time:["08:00","08:30"]},{...q,time:["08:30","10:00"],disabled:!0},{...I,time:["10:00","12:30"],platform:[o[u.AppTypeEnum.DOUYIN]]},{...A,time:["13:00","13:30"]},{...q,time:["14:00","15:00"],disabled:!0},{...I,time:["15:30","17:30"],platform:[o[u.AppTypeEnum.XHS]]},{...I,time:["17:30","18:00"],status:4,platform:[{activeIcon:t.SphIcon}],disabled:!0},{...A,time:["18:00","18:30"]},{...I,time:["18:30","20:30"],platform:[o[u.AppTypeEnum.KUAISHOU]],disabled:!0},{...x,time:["20:30","21:30"]},{...T,time:["21:30","23:00"]}]),w=[{scene:"auto_phone_sph_add_wechat",name:"视频号获客",description:" 按照识别执行线索数量进行扣费",cast_price:"1",price:"2",unit:"算力/次",times:999},{scene:"auto_phone_matrix_publish",name:"社媒平台发布",description:"按照内容的发布条数进行扣费",cast_price:"10",price:"20",unit:"算力/条",times:999},{scene:"auto_phone_intercept",name:"截流私信/评论",description:"按照主动私信/评论时产生的token进行扣费",cast_price:"1",price:"2",unit:"算力/1000token",times:999},{scene:"auto_phone_touch_reach",name:"截流触达",description:"按照找到的用户数进行扣费",cast_price:"1",price:"2",unit:"算力/个",times:999},{scene:"auto_phone_comment",name:"朋友圈评论",description:"按照评论朋友圈时产生的token进行扣费",cast_price:"1",price:"2",unit:"算力/1000token",times:999},{scene:"auto_phone_circle_publish",name:"朋友圈发布",description:"按照内容的发布条数进行扣费",cast_price:"1",price:"2",unit:"算力/条",times:999},{scene:"auto_phone_matrix_publish",name:"朋友圈点赞",description:"按点赞朋友圈的次数进行扣费",cast_price:"1",price:"2",unit:"算力/次",times:999},{scene:"auto_phone_add_wechat",name:"自动加微",description:"按发送好友申请的次数进行扣费",cast_price:"1",price:"2",unit:"算力/个",times:999},{scene:"auto_phone_reply",name:"私信接管(社媒平台)",description:"按照自动回复时产生的token进行扣费）",cast_price:"1",price:"2",unit:"算力/1000token",times:999},{scene:"auto_phone_matrix_publish",name:"自动养号(社媒平台)",description:"按照自动养号运行时长进行扣费",cast_price:"1",price:"2",unit:"算力/分钟",times:999}],S=e.computed((()=>l.value.every((e=>e.active)))),F=e.computed((()=>_.value.some((e=>2===e.status)))),C=()=>{var e;R(),null==(e=m.value)||e.complete(D.value)},U=()=>{v.value=0;let t=l.value;S.value||(t=l.value.filter((e=>!e.active)));const a=t.map((e=>{const t=Object.values(o).find((t=>t.type===e.type));return{status:0,title:(null==t?void 0:t.name)||e.name,type:e.type}}));0!==a.length?(_.value=a,d.value=!0,_.value.length>0&&(_.value[v.value].status=1,H(_.value[v.value].type))):e.index.$u.toast("所有账号均已获取")},O=()=>{d.value=!1,v.value=0,N()},H=e=>{c({type:u.DeviceCmdEnum.GET_USER_INFO,content:{deviceId:g.value},deviceId:g.value,appType:e})},N=async()=>{e.index.showLoading({title:"加载中...",mask:!0});try{const e=await a.getDeviceDetail({device_code:g.value});h.value=e,await R()}finally{f.value=!1,e.index.hideLoading()}},R=async()=>{const e=await a.getAutoTaskDetail({device_code:g.value}),{auto_setting:t,is_empty:s}=e;y.value=e,b.value=0===s,b.value&&(l.value=Object.values(o).map((e=>{const t=h.value.accounts.find((t=>t.type==e.type));return{...e,active:!!t,icon:t?e.activeIcon:e.icon}}))),D.value.forEach((e=>{const{key:a}=e;t[a]&&(e.status=t[a].is_config)}))};return r("success",(async e=>{var t;const{type:s,content:i,deviceId:n,appType:o}=e;if(s!==u.DeviceCmdEnum.GET_USER_INFO)return;_.value[v.value]&&(_.value[v.value].status=2);const{account:c,account_no:r,extra:p,avatar:l,nickname:m}=i,d=null==(t=h.value.accounts)?void 0:t.find((e=>e.type===o)),f={account:c,account_no:r,avatar:l,device_code:n,type:o,nickname:m,extra:JSON.stringify(p)};d?await a.updateDeviceAccount({...f,id:d.id}):await a.addDeviceAccount(f),v.value++,v.value<_.value.length?(_.value[v.value].status=1,H(_.value[v.value].type)):await N()})),r("error",(e=>{const t=v.value;if(_.value.length>0&&_.value[t]){const e={..._.value[t],status:3};_.value.splice(t,1,e)}})),e.onShow((()=>{N()})),e.onLoad((e=>{g.value=e.device_code})),e.onUnload((()=>{p()})),(a,s)=>e.e({a:!e.unref(f)},e.unref(f)?{}:e.e({b:e.p({title:"24h自动任务配置","title-bold":!0,"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"}}),c:!e.unref(b)||e.unref(S)},!e.unref(b)||e.unref(S)?{d:t._imports_0$36}:{e:t._imports_1$22,f:e.o(U)},{g:e.f(e.unref(l),((e,t,a)=>({a:e.icon,b:t}))),h:e.unref(b)?"":1,i:e.p({name:"question-circle",color:"#535354"}),j:e.o((e=>k.value=!0)),k:1==e.unref(y).is_config},1==e.unref(y).is_config?{l:t._imports_0$36}:{},{m:e.f(e.unref(D),((t,a,s)=>e.e({a:e.t(t.time[0]),b:e.t(t.time[1]),c:t.color,d:e.f(t.platform,((e,t,a)=>({a:t,b:e.activeIcon}))),e:e.t(t.name),f:t.disabled},t.disabled?{}:e.e({g:1==t.status||!e.unref(b)},1!=t.status&&e.unref(b)?(0==t.status||2==t.status||t.status,{}):{},{h:0==t.status,i:2==t.status,j:3==t.status}),{k:e.n(t.disabled?"text-_h0000004d_":1!=t.status&&3!=t.status&&e.unref(b)?0==t.status?"text-_hFF2442_":2==t.status?"text-primary":"":"text-_h00C08E_"),l:3!=t.status&&!t.disabled},3==t.status||t.disabled?{}:{m:"c54647a3-3-"+s+",c54647a3-2",n:e.p({name:"arrow-right",size:"20",color:"#0000004d"})},{o:a,p:e.o((a=>(t=>{const{key:a,disabled:s}=t;if(s)return void e.index.$u.toast("该功能敬请期待~");const u={clues_setting:"/ai_modules/device/pages/setting_clue/setting_clue",active_setting:"/ai_modules/device/pages/setting_auto_account/setting_auto_account",publish_setting:"/ai_modules/device/pages/setting_publish/setting_publish",takeover_setting:"/ai_modules/device/pages/setting_private_take/setting_private_take",circle_interaction:"/ai_modules/device/pages/setting_circle/setting_circle",touch_setting:"/ai_modules/device/pages/setting_ca/setting_ca",add_wechat_setting:"/ai_modules/device/pages/setting_add_wechat/setting_add_wechat"},i={type:a,device_code:g.value};"touch_setting"===a&&(i.account_type=t.platform[0].type),u[a]&&e.index.$u.route({url:u[a],params:i})})(t)),a)}))),n:t._imports_0$37,o:e.sr(m,"c54647a3-2",{k:"pagingRef"}),p:e.o(C),q:e.o((t=>e.isRef(D)?D.value=t:null)),r:e.p({auto:!1,fixed:!1,"loading-more-enabled":!1,modelValue:e.unref(D)}),s:!e.unref(b)},e.unref(b)?{}:{t:e.o((t=>{e.index.$u.route({url:"/ai_modules/device/pages/create_auto_task/create_auto_task",params:{device_code:g.value}})})),v:e.p({name:"question-circle",color:"#535354"}),w:e.o((e=>k.value=!0))}),{x:e.f(e.unref(_),((t,a,s)=>e.e({a:0==t.status},(t.status,{}),{b:1==t.status||3==t.status},(1==t.status||t.status,{}),{c:2==t.status},2==t.status?{d:"c54647a3-6-"+s+",c54647a3-5",e:e.p({name:"checkmark",color:"#0065FB",size:"16"})}:{},{f:a!==e.unref(_).length-1},a!==e.unref(_).length-1?{g:e.n(2==t.status?"bg-primary":"bg-_h0000001a_")}:{},{h:e.t(t.title),i:0==t.status?1:"",j:1==t.status},(t.status,{}),{k:3==t.status},(t.status,{}),{l:a}))),y:e.unref(F)},e.unref(F)?{z:e.o(O),A:e.p({type:"primary","custom-style":{height:"90rpx",width:"100%",fontWeight:"bold",borderRadius:"20rpx"}})}:{},{B:e.o(O),C:e.p({"custom-style":{height:"90rpx",fontWeight:"bold",borderRadius:"20rpx"}}),D:e.o(O),E:e.o((t=>e.isRef(d)?d.value=t:null)),F:e.p({mode:"center","border-radius":"20",width:"80%","mask-close-able":!1,modelValue:e.unref(d)}),G:e.f(w,((t,a,s)=>({a:e.t(t.name),b:e.t(t.description),c:e.t(t.price),d:e.t(t.unit),e:a,f:a===w.length-1?1:""}))),H:e.o((t=>e.isRef(k)?k.value=t:null)),I:e.p({title:"24小时自动任务算力消耗明细（内测期间暂不收费）","custom-class":"bg-_hF6F6F6_",modelValue:e.unref(k)})})}}),o=e._export_sfc(n,[["__scopeId","data-v-c54647a3"]]);wx.createPage(o);
