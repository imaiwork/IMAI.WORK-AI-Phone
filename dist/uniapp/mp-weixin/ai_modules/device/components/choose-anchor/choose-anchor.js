"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../api/digital_human.js"),s=require("../../../../enums/appEnums.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("z-paging")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js"))();const t=e.defineComponent({__name:"choose-anchor",props:{modelValue:{type:Boolean,default:!1},limit:null},emits:["update:modelValue","confirm","close"],setup(t,{emit:i}){const l=t,n=e.computed({get:()=>l.modelValue,set(e){i("update:modelValue",e)}}),a=e.shallowRef(),o=e.ref([]),r=e.ref([]),c=async(e,s)=>{var t,i;try{const{lists:i}=await u.getPublicAnchorListV2({page_no:e,page_size:s,status:[0,1,2]});null==(t=a.value)||t.complete(i)}catch(l){null==(i=a.value)||i.complete([])}},m=e=>r.value.some((u=>u.id===e.id)),p=()=>{r.value.length==o.value.length?r.value=[]:r.value=o.value.slice(0,l.limit||o.value.length)},d=()=>{i("confirm",r.value),f()},f=()=>{r.value=[],n.value=!1,i("close")},g=()=>{e.index.$u.route({url:"/ai_modules/digital_human/pages/anchor_create/anchor_create",params:{source:[s.DigitalHumanModelVersionEnum.CHANJING,s.DigitalHumanModelVersionEnum.STANDARD]}})};return e.watch((()=>l.modelValue),(e=>{var u;e&&(null==(u=a.value)||u.reload())})),(u,s)=>e.e({a:e.t(e.unref(r).length),b:e.p({name:"plus",color:"#ffffff",size:"20"}),c:e.o(g),d:e.f(e.unref(o),((u,s,t)=>e.e({a:u.pic,b:[0,1].includes(u.status)},([0,1].includes(u.status),{}),{c:m(u)&&2==u.status},(m(u)&&u.status,{}),{d:s,e:e.o((s=>(u=>{if([0,1].includes(u.status))e.index.$u.toast("该形象正在生成中，请稍后再选择");else if(m(u))r.value=r.value.filter((e=>e.id!=e.id));else{if(l.limit&&r.value.length>=l.limit)return void e.index.$u.toast(`最多选择${l.limit}个形象`);r.value.push(u)}})(u)),s)}))),e:e.sr(a,"9c8db2f8-1,9c8db2f8-0",{k:"pagingRef"}),f:e.o(c),g:e.o((u=>e.isRef(o)?o.value=u:null)),h:e.p({fixed:!1,"hide-empty-view":!0,"safe-area-inset-bottom":!0,modelValue:e.unref(o)}),i:e.unref(r).length>0&&e.unref(r).length==e.unref(o).length},(e.unref(r).length>0&&(e.unref(r).length,e.unref(o).length),{}),{j:e.o(p),k:e.o(d),l:e.o(f),m:e.o((u=>e.isRef(n)?n.value=u:null)),n:e.p({title:"请选择形象","custom-class":"bg-_hF9FAFB_","is-disabled-touch":!0,modelValue:e.unref(n)})})}});wx.createComponent(t);
