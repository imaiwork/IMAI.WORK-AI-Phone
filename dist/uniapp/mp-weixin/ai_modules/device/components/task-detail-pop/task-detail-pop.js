"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../api/device.js"),u=require("../../hooks/useDevice.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),require("../../../../common/assets.js"),require("../../../../enums/appEnums.js"),!Array){(e.resolveComponent("empty")+e.resolveComponent("popup-bottom")+e.resolveComponent("confirm-dialog"))()}Math||((()=>"../../../../components/empty/empty.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js")+(()=>"../../../../components/confirm-dialog/confirm-dialog.js")+i)();const i=()=>"../../../../components/video-preview/video-preview.js",n=e.defineComponent({__name:"task-detail-pop",props:{modelValue:{type:Boolean}},emits:["delete","play","update:modelValue"],setup(i,{expose:n,emit:a}){const r=i,o=e.ref({}),s=e.computed({get:()=>r.modelValue,set:e=>a("update:modelValue",e)}),l=e.ref(!1),d=e.ref(!1),{platformLogo:c,getTaskStatusStyle:p,getTaskStatusText:f}=u.useDevice(),m=async()=>{l.value=!1,e.index.showLoading({title:"删除中...",mask:!0});try{await t.deleteDeviceTaskCalendar({id:o.value.task_id,sub_task_id:o.value.sub_task_id,source:o.value.source}),e.index.hideLoading(),e.index.showToast({title:"删除成功",icon:"none",duration:3e3}),s.value=!1,a("delete")}catch(u){e.index.hideLoading(),e.index.showToast({title:"删除失败",icon:"none",duration:3e3})}},v=()=>{d.value=!0},_=()=>{const{material_url:t}=o.value.detail;if(!t)return;const u=t.split(",");e.index.previewImage({urls:u})};return n({getDetail:async e=>{const u=await t.getDeviceTaskSubtasks({id:e.id,sub_task_id:e.sub_task_id,source:e.source});o.value={...u,task_id:e.id,sub_task_id:e.sub_task_id,source:e.source}}}),(t,u)=>{var i,n,a,r,k,y,j,q,g,h,b,w,x,T,C,V,D,L,S,E,F;return e.e({a:e.t(null==(i=e.unref(o).detail)?void 0:i.name),b:e.t(e.unref(f)(e.unref(o).status)),c:e.n(e.unref(p)(e.unref(o).status)),d:e.t(e.unref(o).task_category),e:e.t(0===e.unref(o).auto_type?"手动":"24h任务"),f:e.t((null==(n=e.unref(o).device_info)?void 0:n.device_name)||(null==(a=e.unref(o).device_info)?void 0:a.device_code)||"-"),g:e.t(e.unref(o).day),h:e.t(e.unref(o).start_time),i:e.t(e.unref(o).end_time),j:(null==(r=e.unref(o).account_info)?void 0:r.avatar)||(null==(k=e.unref(o).account_info)?void 0:k.wechat_avatar),k:e.unref(o).account_type},e.unref(o).account_type?{l:e.unref(c)[e.unref(o).account_type].activeIcon}:{},{m:e.t((null==(y=e.unref(o).account_info)?void 0:y.nickname)||(null==(j=e.unref(o).account_info)?void 0:j.wechat_nickname)||"-"),n:[4,1].includes(e.unref(o).task_type)},[4,1].includes(e.unref(o).task_type)?e.e({o:e.unref(o).detail},e.unref(o).detail?e.e({p:4==e.unref(o).task_type},4==e.unref(o).task_type?{q:e.t((null==(g=null==(q=e.unref(o).detail)?void 0:q.keywords)?void 0:g.length)||0),r:e.f(null==(h=e.unref(o).detail)?void 0:h.keywords,((t,u,i)=>({a:e.t(t),b:t})))}:{},{s:1==e.unref(o).task_type},1==e.unref(o).task_type?e.e({t:null==(b=e.unref(o).detail)?void 0:b.pic,v:e.o(_),w:1==(null==(w=e.unref(o).detail)?void 0:w.material_type)},1==(null==(x=e.unref(o).detail)?void 0:x.material_type)?{x:e.o(v)}:{},{y:e.t(null==(T=e.unref(o).detail)?void 0:T.material_title),z:e.t(null==(C=e.unref(o).detail)?void 0:C.material_subtitle),A:null==(V=e.unref(o).detail)?void 0:V.material_tag},(null==(D=e.unref(o).detail)?void 0:D.material_tag)?{B:e.f(null==(L=e.unref(o).detail)?void 0:L.material_tag,((t,u,i)=>({a:e.t(t),b:t})))}:{},{C:e.t(null==(S=e.unref(o).detail)?void 0:S.publish_time)}):{}):{D:e.p({text:"内容还在生成中，请耐心等待...",size:240})}):{},{E:0===e.unref(o).auto_type},0===e.unref(o).auto_type?{F:e.o((e=>l.value=!0))}:{},{G:e.o((t=>e.isRef(s)?s.value=t:null)),H:e.p({title:"任务详情","custom-class":"bg-_hF6F6F6_","show-footer":!1,height:"80%",modelValue:e.unref(s)}),I:e.o(m),J:e.o((t=>e.isRef(l)?l.value=t:null)),K:e.p({content:"确定要删除任务吗？",center:!0,"z-index":1001,modelValue:e.unref(l)}),L:e.o((t=>e.isRef(d)?d.value=t:null)),M:e.p({title:"视频预览",poster:null==(E=e.unref(o).detail)?void 0:E.pic,"video-url":null==(F=e.unref(o).detail)?void 0:F.material_url,modelValue:e.unref(d)})})}}});wx.createComponent(n);
