"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../common/assets.js"),n=require("../../../../api/digital_human.js"),a=require("../../../../enums/appEnums.js"),r=require("../../../../hooks/useAudio.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-tabs")+e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-tabs/u-tabs.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+s+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+i)();const i=()=>"../../../../components/video-preview/video-preview.js",s=()=>"../../components/anchor-video/anchor-video.js",t=e.defineComponent({__name:"clone_manage",setup(i){const s=[{name:"形象克隆"},{name:"声音克隆"}],t=e.ref(0),o=e.ref([]),l=e.ref([]),c=e.ref(0),{isPlaying:d,play:m,pause:p,pauseAll:v,destroy:f}=r.useAudio(),h=e.shallowRef(),g=async(e,u)=>{var r,i;try{const i=`${a.DigitalHumanModelVersionEnum.CHANJING},${a.DigitalHumanModelVersionEnum.STANDARD},${a.DigitalHumanModelVersionEnum.SHANJIAN}`,{lists:s,count:o}=0==t.value?await n.getPublicAnchorList({page_no:e,page_size:u}):await n.getVoiceList({page_no:e,page_size:u,builtin:1,model_version:i});c.value=o,null==(r=h.value)||r.complete(s)}catch(s){null==(i=h.value)||i.complete([])}},_=e=>{var u;t.value=e,l.value=[],null==(u=h.value)||u.reload(),1==t.value&&(v(),f())},j=e.ref(""),b=e.ref(!1),q=e=>{j.value=e,b.value=!0},w=e.ref(null),y=e=>l.value.includes(e),k=e=>{y(e)?l.value=l.value.filter((u=>u!==e)):l.value.push(e)},A=e.ref(!1),x=()=>{A.value=!A.value,l.value=[]},z=()=>{l.value.length===o.value.length?l.value=[]:l.value=o.value.map(((e,u)=>u))},$=async(u,a)=>{if(await async function(u,n){return new Promise((a=>e.index.showModal({title:u,content:n,success:a}))).then((e=>e.confirm))}("提示","确定要删除吗？")){e.index.showLoading({title:"删除中...",mask:!0});try{if(0==t.value)if(u){let e="human_anchor"===a?n.deleteAnchor:"shanjian_anchor"===a?n.deleteShanjianAnchor:n.deletePublicAnchor;await e({id:u})}else await C("human_anchor",n.deleteAnchor),await C("shanjian_anchor",n.deleteShanjianAnchor),await C("public_anchor",n.deletePublicAnchor);1==t.value&&await n.deleteVoice({id:u||l.value.map((e=>o.value[e].id))}),o.value=o.value.filter(((e,u)=>!l.value.includes(u))),l.value=[],e.index.showToast({title:"删除成功",icon:"success",duration:3e3})}catch(r){e.index.showToast({title:r||"删除失败",icon:"error",duration:3e3})}finally{e.index.hideLoading(),A.value=!1,l.value=[]}}};async function C(e,u){const n=o.value.filter(((u,n)=>l.value.includes(n)&&u.source_type==e)).map((e=>e.id));0!==n.length&&await u({id:n})}return e.onUnload((()=>{f()})),(n,a)=>e.e({a:e.p({"border-bottom":!1,"is-fixed":!1,background:{background:"transparent"},title:"我的克隆","title-bold":!0}),b:e.o(_),c:e.p({list:s,"is-scroll":!1,current:e.unref(t),"bg-color":""}),d:e.t(e.unref(c)),e:0==e.unref(t)},0==e.unref(t)?{f:e.f(e.unref(o),((u,n,a)=>e.e(e.unref(A)?e.e({a:y(n)},y(n)?{b:"d491b22e-3-"+a+",d491b22e-2",c:e.p({name:"checkmark",color:"#fff",size:20})}:{},{d:y(n)?1:"",e:e.o((e=>k(n)),n)}):{},{f:e.o($,n),g:e.o(q,n),h:"d491b22e-4-"+a+",d491b22e-2",i:e.p({item:{id:u.id,name:u.name,pic:u.pic,status:u.status,url:u.result_url,remark:u.remark,source_type:u.source_type}}),j:n}))),g:e.unref(A)}:{},{h:1==e.unref(t)},1==e.unref(t)?{i:e.f(e.unref(o),((n,a,r)=>e.e({a:e.t(n.name),b:e.t(n.create_time),c:1==n.status},1==n.status?e.e({d:e.unref(d)&&e.unref(w)==n.id},e.unref(d)&&e.unref(w)==n.id?{e:u._imports_1$5}:{f:u._imports_2$2},{g:e.t(e.unref(d)&&e.unref(w)==n.id?"暂停":"试听"),h:e.o((e=>(async e=>{d.value&&w.value!==e.id&&v(),d.value?p():(m(e.voice_urls),w.value=e.id)})(n)),a)}):2===n.status?{j:u._imports_3$4}:[0,3,4,5].includes(n.status)?{l:u._imports_4$4}:{},{i:2===n.status,k:[0,3,4,5].includes(n.status)},e.unref(A)?e.e({m:y(a)},y(a)?{n:"d491b22e-5-"+r+",d491b22e-2",o:e.p({name:"checkmark",color:"#fff",size:20})}:{},{p:y(a)?1:"",q:e.o((e=>k(a)),a)}):{},{r:a}))),j:u._imports_0$7,k:e.unref(A)}:{},{l:e.sr(h,"d491b22e-2",{k:"pagingRef"}),m:e.o(g),n:e.o((u=>e.isRef(o)?o.value=u:null)),o:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(o)}),p:e.unref(o).length>0},e.unref(o).length>0?e.e({q:e.t(e.unref(A)?"取消":"管理"),r:e.o(x),s:e.unref(A)},e.unref(A)?{t:e.o(z)}:{},{v:e.unref(A)},e.unref(A)?{w:e.t(e.unref(l).length),x:e.o((e=>$()))}:{}):{},{y:e.o((e=>b.value=!1)),z:e.o((u=>e.isRef(b)?b.value=u:null)),A:e.p({title:"视频预览","video-url":e.unref(j),modelValue:e.unref(b)})})}}),o=e._export_sfc(t,[["__scopeId","data-v-d491b22e"]]);wx.createPage(o);
