"use strict";const e=require("../common/vendor.js"),t=new Map,o=(e,o)=>{const n=t.get(e);n&&n.forEach((t=>{try{t(o)}catch(n){console.error(`[Bus Error] Event "${e}" handler failed:`,n)}}))};exports.useEventBusManager=()=>{const n=new Map;return e.onBeforeUnmount((()=>{n.forEach(((e,o)=>{const n=t.get(o);n&&(e.forEach((e=>{n.delete(e)})),0===n.size&&t.delete(o))})),n.clear()})),{on:(e,o)=>{"string"==typeof e&&"function"==typeof o?(t.has(e)||t.set(e,new Set),t.get(e).add(o),n.has(e)||n.set(e,new Set),n.get(e).add(o)):console.error("Bus.on: eventName 必须是字符串，callback 必须是函数。")},off:(e,o)=>{const r=t.get(e);r&&(r.delete(o),0===r.size&&t.delete(e));const s=n.get(e);s&&(s.delete(o),0===s.size&&n.delete(e))},emit:o}};
