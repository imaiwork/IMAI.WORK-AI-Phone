"use strict";const e=require("../../../../common/vendor.js"),s=require("../../../../common/assets.js"),t=require("../../../../api/digital_human.js"),r=require("../../../../stores/user.js"),u=require("../../../../enums/appEnums.js"),n=require("../../enums/index.js"),i=require("../../../../hooks/useEventBusManager.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){e.resolveComponent("u-button")()}Math;const a=e.defineComponent({__name:"sora_ai_copywriter",setup(a){const{emit:o}=i.useEventBusManager(),c=r.useUserStore(),{userTokens:l}=e.toRefs(c),p=e.ref(""),d=e.ref([]),q=e.ref(!1),m=e.computed((()=>{var e;const s=null==(e=c.getTokenByScene(u.TokensSceneEnum.SORA_COPYWRITING))?void 0:e.score;return parseFloat(s)}));return(r,u)=>({a:500,b:e.unref(p),c:e.o((s=>e.isRef(p)?p.value=s.detail.value:null)),d:e.t(e.unref(p).length),e:e.t(500),f:e.f(e.unref(d),((t,r,u)=>e.e({a:"pending"===t.status},"pending"===t.status?{b:s._imports_0$14}:{c:e.t(t.content),d:e.o((s=>(s=>{const{status:t,content:r}=s;"pending"!==t?(o("confirm",{type:n.ListenerTypeEnum.SORA_AI_COPYWRITER,data:r}),d.value=[],e.index.navigateBack()):e.index.$u.toast("文案在生成中...")})(t)),t.id),e:"1146e55a-0-"+u,f:e.p({type:"primary",size:"mini"})},{g:t.id}))),g:e.t(e.unref(m)),h:e.n(e.unref(p).length>0?"bg-black":"bg-_h787878CC_"),i:e.o((s=>(async()=>{if(p.value.trim())if(q.value)e.index.$u.toast("文案在生成中...");else if(l.value<m.value)e.index.$u.toast("算力不足，请充值！");else try{q.value=!0;const s=e.reactive({content:"",status:"pending"});d.value.unshift(s);const r=await t.generateSoraPrompt({keywords:p.value});s.content=r.message,s.status="success",q.value=!1}catch(s){q.value=!1,e.index.showToast({title:s||"生成失败，请重试",icon:"none",duration:3e3})}else e.index.$u.toast("请输入文案")})()))})}}),o=e._export_sfc(a,[["__scopeId","data-v-1146e55a"]]);wx.createPage(o);
