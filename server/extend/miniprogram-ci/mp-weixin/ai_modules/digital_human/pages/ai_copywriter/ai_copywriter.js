"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../utils/util.js"),t=require("../../../../api/digital_human.js"),i=require("../../../../stores/user.js"),n=require("../../../../enums/appEnums.js"),u=require("../../config/copywriter.js"),s=require("../../enums/index.js"),o=require("../../../../hooks/useEventBusManager.js");if(require("../../../../stores/navigationBarTitle.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-line")+e.resolveComponent("u-input")+e.resolveComponent("u-button"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-line/u-line.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const a=e.defineComponent({__name:"ai_copywriter",setup(a){const{emit:l}=o.useEventBusManager(),p=i.useUserStore(),{userTokens:c}=e.toRefs(p),d=()=>{m.value=u.aiTemplateCopywriter[0%u.aiTemplateCopywriter.length]},m=e.ref(""),h=e.ref(150),v=e.ref([]),f=[{id:1,name:"短",length:150},{id:2,name:"中",length:300},{id:3,name:"长",length:1e3}],g=e.computed((()=>f.filter((e=>e.length<=h.value)))),j=e.computed((()=>{var e;const r=null==(e=p.getTokenByScene(n.TokensSceneEnum.HUMAN_COPYWRITING_CREATE))?void 0:e.score;return parseFloat(r)})),q=e.ref(g.value[0]),x=e.ref(0),{proxy:y}=e.getCurrentInstance(),_=async()=>{await e.nextTick$1(),r.getRect(".content-box",!1,y).then((e=>{x.value=e.height}))};return e.onLoad((e=>{h.value=e.limit})),(r,i)=>({a:e.o(d),b:e.p({color:"#e5e5e5"}),c:e.o((r=>e.isRef(m)?m.value=r:null)),d:e.p({type:"textarea",focus:!0,height:"160",placeholder:"请输入或粘贴您的文案 ...","placeholder-style":"color: #00000033; font-size: 26rpx;",maxlength:500,modelValue:e.unref(m)}),e:e.t(e.unref(m).length),f:e.t(500),g:e.f(e.unref(g),((r,t,i)=>{var n;return{a:e.t(r.name),b:r.id,c:e.n((null==(n=e.unref(q))?void 0:n.id)===r.id?"bg-primary-light-9 text-primary":"bg-_hF3F3F3_ text-_h323232_"),d:e.o((e=>q.value=r),r.id)}})),h:e.f(e.unref(v),((r,t,i)=>({a:e.t(r),b:e.o((t=>{return i=r,l("confirm",{type:s.ListenerTypeEnum.AI_COPYWRITER,data:i}),v.value=[],void e.index.navigateBack();var i}),r.id),c:"ac71ef40-2-"+i,d:r.id}))),i:e.p({type:"primary",size:"mini"}),j:e.unref(x),k:e.t(e.unref(j)),l:e.o((r=>(async r=>{if(r.trim())if(c.value<j.value)e.index.$u.toast("算力不足，请充值！");else{e.index.showLoading({title:"生成中...",mask:!0});try{const{content:i}=await t.generatePrompt({keywords:r,number:q.value.length});v.value.push(i),e.index.hideLoading()}catch(i){e.index.hideLoading(),e.index.showToast({title:i||"生成失败，请重试",icon:"none",duration:3e3})}finally{setTimeout((()=>{_()}),500)}}else e.index.$u.toast("请输入文案")})(e.unref(m)))),m:e.p({type:"primary",shape:"circle","custom-style":{height:"90rpx",boxShadow:"0px 6px 12px 0px rgba(0, 101, 251, 0.20)",fontSize:"26rpx"}})})}}),l=e._export_sfc(a,[["__scopeId","data-v-ac71ef40"]]);wx.createPage(l);
