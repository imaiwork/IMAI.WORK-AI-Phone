"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../common/assets.js"),n=require("../../../../api/drawing.js"),t=require("../../../../stores/user.js"),r=require("../../../../enums/appEnums.js"),s=require("../../enums/index.js"),i=require("../../../../hooks/useEventBusManager.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-input")+e.resolveComponent("u-icon"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js"))();const a=e.defineComponent({__name:"puzzle_ai_copywriter",setup(a){const{emit:o}=i.useEventBusManager(),l=t.useUserStore(),{userTokens:c}=e.toRefs(l),f=e.ref(""),p=e.ref([]),m=[1,3,5,10,20],v=e.ref(1),d=e.ref(!1),q=e.computed(()=>p.value.every(e=>"success"===e.status)),j=e.computed(()=>{var e;const u=null==(e=l.getTokenByScene(r.TokensSceneEnum.PUZZLE_AI_COPYWRITER))?void 0:e.score;return parseFloat(u)*v.value}),g=async u=>{if(u.trim()){if(q.value)if(c.value<j.value)e.index.$u.toast("算力不足，请充值！");else try{d.value=!0,p.value=Array.from({length:v.value},()=>({title:"",content:"",status:"pending"}));const t=await n.generatePuzzlePrompt({keywords:u,number:v.value});t.content&&t.content.length>0?p.value=t.content.map(e=>({content:e,status:"success"})):(e.index.$u.toast("文案生成失败，请重新输入"),d.value=!1,p.value=[])}catch(t){d.value=!1,e.index.showToast({title:t||"生成失败，请重试",icon:"none",duration:3e3})}}else e.index.$u.toast("请输入文案")},h=()=>{q.value?(o("confirm",{type:s.ListenerTypeEnum.PUZZLE_AI_COPYWRITER,data:p.value.filter(e=>e.content.some(e=>""!==e.trim())).map(e=>e.content)}),p.value=[],e.index.navigateBack()):e.index.$u.toast("文案在生成中...")};return(n,t)=>e.e({a:!e.unref(d)},e.unref(d)?{h:e.f(e.unref(p),(n,t,r)=>e.e({a:"pending"===n.status},"pending"===n.status?{b:u._imports_0$14,c:e.t(t+1)}:{d:e.f(n.content,(u,s,i)=>({a:"1032c670-0-"+r+"-"+i,b:e.o(u=>e.unref(p)[t].content[s]=u,s),c:e.p({"placeholder-style":"color: #7C7E80; ",maxlength:"100",modelValue:e.unref(p)[t].content[s]}),d:s,e:s<n.content.length-1?1:""})),e:e.t(0==t?"主标题":"副标题"),f:"1032c670-1-"+r,g:e.p({name:"close",color:"#ffffff",size:"16"}),h:e.o(e=>(e=>{p.value.splice(e,1),0===p.value.length&&(d.value=!1)})(t),t)},{i:t}))}:{b:500,c:e.unref(f),d:e.o(u=>e.isRef(f)?f.value=u.detail.value:null),e:e.t(e.unref(f).length),f:e.t(500),g:e.f(m,(u,n,t)=>({a:e.t(u),b:u,c:e.unref(v)===u?1:"",d:e.o(e=>v.value=u,u)}))},{i:!e.unref(d)},e.unref(d)?{m:e.o(u=>g(e.unref(f))),n:e.n(e.unref(q)?"bg-black":"bg-_h787878CC_"),o:e.o(h)}:{j:e.t(e.unref(j)),k:e.n(e.unref(f).length>0?"bg-black":"bg-_h787878CC_"),l:e.o(u=>g(e.unref(f)))})}}),o=e._export_sfc(a,[["__scopeId","data-v-1032c670"]]);wx.createPage(o);
