"use strict";const e=require("../../../../common/vendor.js"),s=require("../../../../common/assets.js"),o=require("../../stores/material.js"),r=require("../../../../hooks/useUpload.js");if(require("../../../../components/file-upload/choose-file.js"),require("../../../../api/app.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-button")+e.resolveComponent("upload-progress")+e.resolveComponent("choose-material")+e.resolveComponent("video-preview"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../components/upload-progress/upload-progress.js")+(()=>"../../../../components/choose-material/choose-material.js")+(()=>"../../../../components/video-preview/video-preview.js"))();const i=e.defineComponent({__name:"video_material",setup(i){const u=o.useMaterialStore(),{videoList:t}=e.storeToRefs(u),n=e.ref(JSON.parse(JSON.stringify(t.value))),l=e.ref(!1),a=e.ref(!1),p=e.ref({url:"",pic:""}),{showUploadProgress:c,uploadMaterialList:d,uploadAndProcessFiles:m}=r.useUpload({videoAccept:["mp4","mov"],fileAccept:["mp4","mov"],onSuccess:e=>{n.value.push(...e)}}),v=()=>{e.index.showActionSheet({itemList:['从"微信聊天"中选择','从"素材库"中选择','从"手机相册"中选择'],success:e=>{0===e.tapIndex?m("file"):1===e.tapIndex?l.value=!0:2===e.tapIndex&&m("video")}})},f=e=>{n.value.push(...e.map(e=>({pic:e.pic,url:e.content,type:"video"})))},j=()=>{0!==n.value.length?(u.setVideoList(n.value),e.index.navigateBack()):e.index.$u.toast("请至少选择一个视频素材")};return(o,r)=>({a:e.t(e.unref(n).length),b:s._imports_0$37,c:e.o(v),d:e.f(e.unref(n),(s,o,r)=>e.e({a:"file"===s.type||!s.pic},"file"!==s.type&&s.pic?{c:s.pic}:{b:s.url},{d:"b07b26e0-0-"+r,e:e.o(e=>(e=>{n.value.splice(e,1)})(o),o),f:e.o(e=>(e=>{p.value={url:e.url,pic:e.pic},a.value=!0})(s),o),g:o})),e:e.p({name:"close",color:"#ffffff",size:"16"}),f:e.o(j),g:e.p({type:"primary","custom-style":{height:"100rpx",borderRadius:"16rpx",fontWeight:"bold"}}),h:e.o(s=>e.isRef(c)?c.value=s:null),i:e.p({"upload-list":e.unref(d),modelValue:e.unref(c)}),j:e.o(f),k:e.o(s=>e.isRef(l)?l.value=s:null),l:e.p({type:"video",modelValue:e.unref(l)}),m:e.o(s=>e.isRef(a)?a.value=s:null),n:e.p({"video-url":e.unref(p).url,poster:e.unref(p).pic,modelValue:e.unref(a)})})}});wx.createPage(i);
