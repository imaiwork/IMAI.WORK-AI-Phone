"use strict";const e=require("../../../../common/vendor.js"),s=require("../../../../common/assets.js"),r=require("../../stores/material.js"),i=require("../../../../hooks/useUpload.js");if(require("../../../../components/file-upload/choose-file.js"),require("../../../../api/app.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-button")+e.resolveComponent("upload-progress")+e.resolveComponent("choose-material"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../components/upload-progress/upload-progress.js")+(()=>"../../../../components/choose-material/choose-material.js"))();const u=e.defineComponent({__name:"image_material",setup(u){const o=r.useMaterialStore(),{imageList:t}=e.storeToRefs(o),a=e.ref(JSON.parse(JSON.stringify(t.value))),n=e.ref(!1),{showUploadProgress:p,uploadMaterialList:l,uploadAndProcessFiles:c}=i.useUpload({imageAccept:["jpg","jpeg","png","webp"],fileAccept:["jpg","jpeg","png","webp"],onSuccess:e=>{a.value.push(...e.map((e=>({pic:e.pic||e.url,url:e.url,type:"image"}))))}}),m=()=>{e.index.showActionSheet({itemList:['从"微信聊天"中选择','从"素材库"中选择','从"手机相册"中选择'],success:e=>{0===e.tapIndex?c("file"):1===e.tapIndex?n.value=!0:2===e.tapIndex&&c("image")}})},d=e=>{a.value.push(...e.map((e=>({pic:e.pic,url:e.content,type:"image"}))))},j=()=>{0!==a.value.length?(o.setList("imageList",a.value),e.index.navigateBack()):e.index.$u.toast("请至少选择一个图片素材")};return(r,i)=>({a:e.t(e.unref(a).length),b:s._imports_0$39,c:e.o(m),d:e.f(e.unref(a),((s,r,i)=>({a:s.pic,b:"b770f884-0-"+i,c:e.o((e=>(e=>{a.value.splice(e,1)})(r)),r),d:r,e:e.o((s=>(s=>{e.index.previewImage({urls:a.value.map((e=>e.pic)),current:s})})(r)),r)}))),e:e.p({name:"close",color:"#ffffff",size:"16"}),f:e.o(j),g:e.p({type:"primary","custom-style":{height:"100rpx",borderRadius:"16rpx",fontWeight:"bold"}}),h:e.o((s=>e.isRef(p)?p.value=s:null)),i:e.p({"upload-list":e.unref(l),modelValue:e.unref(p)}),j:e.o(d),k:e.o((s=>e.isRef(n)?n.value=s:null)),l:e.p({type:"image",modelValue:e.unref(n)})})}});wx.createPage(u);
