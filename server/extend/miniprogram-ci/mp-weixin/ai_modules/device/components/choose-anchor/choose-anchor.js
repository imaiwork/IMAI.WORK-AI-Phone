"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../api/digital_human.js"),t=require("../../../../stores/app.js"),i=require("../../../digital_human/enums/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../config/index.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("empty")+e.resolveComponent("z-paging")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../components/empty/empty.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js"))();const n=e.defineComponent({__name:"choose-anchor",props:{modelValue:{type:Boolean,default:!1},limit:null},emits:["update:modelValue","confirm","close"],setup(n,{emit:o}){const s=n,r=e.computed({get:()=>s.modelValue,set(e){o("update:modelValue",e)}}),l=t.useAppStore(),a=e.computed(()=>{var e;return(null==(e=l.getDigitalHumanConfig)?void 0:e.channel)||[]});e.computed(()=>a.value.reduce((e,u)=>(e[u.id]=u.name,e),{}));const m=e.shallowRef(),p=e.ref([]),c=e.ref([]),d=e.reactive({name:"",model_version:`${i.DigitalHumanModelVersionEnum.CHANJING}`,status:1,type:0}),g=async(e,t)=>{var i,n;try{const{lists:n}=await u.getAnchorList({page_no:e,page_size:t,...d});null==(i=m.value)||i.complete(n)}catch(o){null==(n=m.value)||n.complete([])}},f=e=>c.value.some(u=>u.id===e.id),v=()=>{c.value.length==p.value.length?c.value=[]:c.value=p.value.slice(0,s.limit||p.value.length)},h=()=>{o("confirm",c.value),j()},j=()=>{c.value=[],r.value=!1,o("close")},q=()=>{e.index.$u.route({url:"/ai_modules/digital_human/pages/anchor_create/anchor_create",params:{source:[i.DigitalHumanModelVersionEnum.CHANJING,i.DigitalHumanModelVersionEnum.STANDARD]}})};return e.watch(()=>s.modelValue,e=>{var u;e&&(null==(u=m.value)||u.reload())}),(u,t)=>e.e({a:e.t(e.unref(c).length),b:e.p({name:"plus",color:"#ffffff",size:"20"}),c:e.o(q),d:e.f(e.unref(p),(u,t,i)=>e.e({a:u.pic,b:f(u)},(f(u),{}),{c:t,d:e.o(t=>(u=>{if(f(u))c.value=c.value.filter(e=>e.id!=e.id);else{if(s.limit&&c.value.length>=s.limit)return void e.index.$u.toast(`最多选择${s.limit}个形象`);c.value.push(u)}})(u),t)})),e:e.sr(m,"48b45872-1,48b45872-0",{k:"pagingRef"}),f:e.o(g),g:e.o(u=>e.isRef(p)?p.value=u:null),h:e.p({fixed:!1,"safe-area-inset-bottom":!0,modelValue:e.unref(p)}),i:e.unref(c).length>0&&e.unref(c).length==e.unref(p).length},(e.unref(c).length>0&&(e.unref(c).length,e.unref(p).length),{}),{j:e.o(v),k:e.o(h),l:e.o(j),m:e.o(u=>e.isRef(r)?r.value=u:null),n:e.p({title:"请选择形象","custom-class":"bg-_hF9FAFB_","is-disabled-touch":!0,show:e.unref(r)})})}});wx.createComponent(n);
