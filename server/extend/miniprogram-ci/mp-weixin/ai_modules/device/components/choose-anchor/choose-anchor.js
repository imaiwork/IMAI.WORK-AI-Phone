"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../api/digital_human.js"),s=require("../../../../enums/appEnums.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("z-paging")+e.resolveComponent("popup-bottom"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js"))();const i=e.defineComponent({__name:"choose-anchor",props:{modelValue:{type:Boolean,default:!1},limit:null},emits:["update:modelValue","confirm","close"],setup(i,{expose:t,emit:l}){const n=i,o=e.computed({get:()=>n.modelValue,set(e){l("update:modelValue",e)}}),r=e.shallowRef(),a=e.ref([]),c=e.ref([]),m=async(e=1,s=10)=>{var i,t;try{const{lists:t}=await u.getPublicAnchorListV2({page_no:e,page_size:s,status:[0,1,2]});null==(i=r.value)||i.complete(t)}catch(l){null==(t=r.value)||t.complete([])}},p=e=>c.value.some((u=>u.id===e.id)),d=()=>{c.value.length==a.value.length?c.value=[]:c.value=a.value.slice(0,n.limit||a.value.length)},f=()=>{l("confirm",c.value),g()},g=()=>{c.value=[],o.value=!1,l("close")},h=()=>{e.index.$u.route({url:"/ai_modules/digital_human/pages/anchor_create/anchor_create",params:{source:[s.DigitalHumanModelVersionEnum.CHANJING,s.DigitalHumanModelVersionEnum.STANDARD]}})};return e.watch((()=>n.modelValue),(e=>{var u;e&&(null==(u=r.value)||u.reload())})),t({queryList:m}),(u,s)=>e.e({a:e.t(e.unref(c).length),b:e.p({name:"plus",color:"#ffffff",size:"20"}),c:e.o(h),d:e.f(e.unref(a),((u,s,i)=>e.e({a:u.pic,b:[0,1].includes(u.status)},([0,1].includes(u.status),{}),{c:p(u)},(p(u),{}),{d:s,e:e.o((s=>(u=>{if([0,1].includes(u.status))e.index.$u.toast("该形象正在生成中，请稍后再选择");else if(p(u))c.value=c.value.filter((e=>e.id!=e.id));else{if(n.limit&&c.value.length>=n.limit)return void e.index.$u.toast(`最多选择${n.limit}个形象`);c.value.push(u)}})(u)),s)}))),e:e.sr(r,"9c8db2f8-1,9c8db2f8-0",{k:"pagingRef"}),f:e.o(m),g:e.o((u=>e.isRef(a)?a.value=u:null)),h:e.p({fixed:!1,"hide-empty-view":!0,"safe-area-inset-bottom":!0,modelValue:e.unref(a)}),i:e.unref(c).length>0&&e.unref(c).length==e.unref(a).length},(e.unref(c).length>0&&(e.unref(c).length,e.unref(a).length),{}),{j:e.o(d),k:e.o(f),l:e.o(g),m:e.o((u=>e.isRef(o)?o.value=u:null)),n:e.p({title:"请选择形象","custom-class":"bg-_hF9FAFB_","is-disabled-touch":!0,modelValue:e.unref(o)})})}});wx.createComponent(i);
