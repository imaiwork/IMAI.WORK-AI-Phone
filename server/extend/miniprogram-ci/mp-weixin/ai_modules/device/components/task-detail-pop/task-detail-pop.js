"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../api/device.js"),i=require("../../hooks/useDevice.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../stores/app.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),require("../../../../config/index.js"),require("../../../../common/assets.js"),require("../../../../enums/appEnums.js"),!Array){(e.resolveComponent("empty")+e.resolveComponent("popup-bottom")+e.resolveComponent("confirm-dialog"))()}Math||((()=>"../../../../components/empty/empty.js")+(()=>"../../../../components/popup-bottom/popup-bottom.js")+(()=>"../../../../components/confirm-dialog/confirm-dialog.js")+u)();const u=()=>"../../../../components/video-preview/video-preview.js",n=e.defineComponent({__name:"task-detail-pop",props:{modelValue:{type:Boolean}},emits:["delete","play","update:modelValue"],setup(u,{expose:n,emit:a}){const r=u,o=e.ref({}),s=e.computed({get:()=>r.modelValue,set:e=>a("update:modelValue",e)}),l=e.ref(!1),d=e.ref(!1),{platformLogo:c,getTaskStatusStyle:p,getTaskStatusText:f}=i.useDevice(),m=async()=>{l.value=!1,e.index.showLoading({title:"删除中...",mask:!0});try{await t.deleteDeviceTaskCalendar({id:o.value.task_id,sub_task_id:o.value.sub_task_id,source:o.value.source}),e.index.hideLoading(),e.index.showToast({title:"删除成功",icon:"none",duration:3e3}),s.value=!1,a("delete")}catch(i){e.index.hideLoading(),e.index.showToast({title:"删除失败",icon:"none",duration:3e3})}},v=()=>{d.value=!0},_=()=>{const{material_url:t}=o.value.detail;if(!t)return;const i=t.split(",");console.log("pics",i),e.index.previewImage({urls:i})};return n({getDetail:async e=>{const i=await t.getDeviceTaskSubtasks({id:e.id,sub_task_id:e.sub_task_id,source:e.source});o.value={...i,task_id:e.id,sub_task_id:e.sub_task_id,source:e.source}}}),(t,i)=>{var u,n,a,r,k,j,q,y,g,h,b,w,x,T,C,D,V,S,E,F,L;return e.e({a:e.t(null==(u=e.unref(o).detail)?void 0:u.name),b:e.t(e.unref(f)(e.unref(o).status)),c:e.n(e.unref(p)(e.unref(o).status)),d:e.t(e.unref(o).task_category),e:e.t((null==(n=e.unref(o).device_info)?void 0:n.device_name)||(null==(a=e.unref(o).device_info)?void 0:a.device_code)||"-"),f:e.t(e.unref(o).day),g:e.t(e.unref(o).start_time),h:e.t(e.unref(o).end_time),i:(null==(r=e.unref(o).account_info)?void 0:r.avatar)||(null==(k=e.unref(o).account_info)?void 0:k.wechat_avatar),j:e.unref(o).account_type},e.unref(o).account_type?{k:e.unref(c)[e.unref(o).account_type].activeIcon}:{},{l:e.t((null==(j=e.unref(o).account_info)?void 0:j.nickname)||(null==(q=e.unref(o).account_info)?void 0:q.wechat_nickname)||"-"),m:[4,1].includes(e.unref(o).task_type)},[4,1].includes(e.unref(o).task_type)?e.e({n:e.unref(o).detail},e.unref(o).detail?e.e({o:4==e.unref(o).task_type},4==e.unref(o).task_type?{p:e.t((null==(g=null==(y=e.unref(o).detail)?void 0:y.keywords)?void 0:g.length)||0),q:e.f(null==(h=e.unref(o).detail)?void 0:h.keywords,(t,i,u)=>({a:e.t(t),b:t}))}:{},{r:1==e.unref(o).task_type},1==e.unref(o).task_type?e.e({s:null==(b=e.unref(o).detail)?void 0:b.pic,t:e.o(_),v:1==(null==(w=e.unref(o).detail)?void 0:w.material_type)},1==(null==(x=e.unref(o).detail)?void 0:x.material_type)?{w:e.o(v)}:{},{x:e.t(null==(T=e.unref(o).detail)?void 0:T.material_title),y:e.t(null==(C=e.unref(o).detail)?void 0:C.material_subtitle),z:null==(D=e.unref(o).detail)?void 0:D.material_tag},(null==(V=e.unref(o).detail)?void 0:V.material_tag)?{A:e.f(null==(S=e.unref(o).detail)?void 0:S.material_tag,(t,i,u)=>({a:e.t(t),b:t}))}:{},{B:e.t(null==(E=e.unref(o).detail)?void 0:E.publish_time)}):{}):{C:e.p({text:"内容还在生成中，请耐心等待...",size:240})}):{},{D:e.o(e=>l.value=!0),E:e.o(t=>e.isRef(s)?s.value=t:null),F:e.p({title:"任务详情","custom-class":"bg-_hF6F6F6_","show-footer":!1,height:"80%",show:e.unref(s)}),G:e.o(m),H:e.o(t=>e.isRef(l)?l.value=t:null),I:e.p({content:"确定要删除任务吗？",center:!0,"z-index":1001,modelValue:e.unref(l)}),J:e.o(t=>e.isRef(d)?d.value=t:null),K:e.p({title:"视频预览",poster:null==(F=e.unref(o).detail)?void 0:F.pic,"video-url":null==(L=e.unref(o).detail)?void 0:L.material_url,modelValue:e.unref(d)})})}}});wx.createComponent(n);
