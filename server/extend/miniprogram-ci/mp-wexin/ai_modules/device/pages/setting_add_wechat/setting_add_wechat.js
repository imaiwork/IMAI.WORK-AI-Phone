"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../api/device.js"),a=require("../../../../stores/app.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../utils/auth.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/cache.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../hooks/useShareMessage.js"),require("../../../../router/index.js"),require("../../../../utils/util.js"),require("../../../../stores/navigationBarTitle.js"),require("../../../../config/index.js"),require("../../../../api/app.js"),require("../../../../api/chat.js"),require("../../../../api/voice_chat.js"),!Array){(e.resolveComponent("u-radio")+e.resolveComponent("u-radio-group")+e.resolveComponent("u-icon"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-radio/u-radio.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-radio-group/u-radio-group.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+s)();const s=()=>"../../components/keywords-edit/keywords-edit.js",i=e.defineComponent({__name:"setting_add_wechat",setup(s){const i=a.useAppStore(),t=e.ref(""),u=e.computed((()=>i.config.wechat_remarks||[])),o=e.reactive({type:1,wechat_remarks:u.value||[]}),n=e.ref(!1),c=e.ref(-1),l=e.ref(),d=e=>{var r;n.value=!0,c.value=e,null==(r=l.value)||r.setFormData(o.wechat_remarks[e]||"")},p=e=>{-1===c.value?o.wechat_remarks.push(e):o.wechat_remarks[c.value]=e,c.value=-1,n.value=!1},m=async()=>{if(1!==o.type||0!==o.wechat_remarks.length){e.index.showLoading({title:"保存中...",mask:!0});try{await r.createAutoTaskAddWechatConfig({device_code:t.value,speech_type:o.type,remarks:o.wechat_remarks}),e.index.hideLoading(),e.index.showToast({title:"保存成功",icon:"none",duration:3e3}),e.index.navigateBack()}catch(a){e.index.hideLoading(),e.index.showToast({title:"保存失败",icon:"none",duration:3e3})}}else e.index.$u.toast("请添加好友备注")};return e.watch((()=>u.value),(e=>{o.wechat_remarks=e||[]})),e.onLoad((e=>{t.value=e.device_code,(async()=>{const e=await r.getAutoTaskAddWechatConfigDetail({device_code:t.value});o.type=e.speech_type,o.wechat_remarks=e.remarks})()})),(r,a)=>e.e({a:e.f([{value:1,label:"固定话术"},{value:2,label:"AI回复"},{value:3,label:"AI根据固话优化"}],((r,a,s)=>({a:e.t(r.label),b:"af343484-1-"+s+",af343484-0",c:e.p({name:r.value,size:28})}))),b:e.o((r=>e.unref(o).type=r)),c:e.p({modelValue:e.unref(o).type}),d:1==e.unref(o).type},1==e.unref(o).type?{e:e.f(e.unref(o).wechat_remarks,((r,a,s)=>({a:e.t(r),b:"af343484-2-"+s,c:e.o((e=>(e=>{o.wechat_remarks.splice(e,1)})(a)),a),d:a,e:e.o((e=>d(a)),a)}))),f:e.p({name:"close",color:"#ffffff",size:"16"}),g:e.p({name:"plus",color:"#0065FB",size:"20"}),h:e.o((e=>d(-1)))}:{},{i:e.o(m),j:e.sr(l,"af343484-4",{k:"keywordsEditRef"}),k:e.o(p),l:e.o((r=>e.isRef(n)?n.value=r:null)),m:e.p({title:"好友备注",modelValue:e.unref(n)})})}});wx.createPage(i);
