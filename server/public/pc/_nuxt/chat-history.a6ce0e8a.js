import{d as I,c as V,r as $,o as L,k as a,l as r,m as t,q as c,s as v,Z as i,bB as R,J as _,I as D,K as x,t as y,Y as u,a0 as K,L as P,bC as b,y as T,ay as q,_ as J}from"./entry.8705b591.js";import{E as Z}from"./index.656bf02e.js";import{E as G}from"./index.d5b2ab73.js";import{E as O}from"./el-empty.a2e85def.js";/* empty css                   *//* empty css                     */import{useChatHistory as Q}from"./useChatHistory.a8b10571.js";import"./chat.68e7292d.js";import"./useChatManager.5d5aef4e.js";import"./useChatEventBus.d6647ad1.js";const U={class:"w-full h-full flex flex-col bg-[#F9FAFB] border-r border-gray-200"},W={class:"px-4 mt-[33px]"},X={class:"flex items-center gap-1 mt-[25px]"},ee={class:"grow min-h-0 mt-4"},te={key:0,class:"px-2 pt-1 animate-pulse"},se={class:"px-2"},oe={class:"text-[#81858c] text-xs px-2 py-2.5 sticky top-0 z-[88] bg-[#f9fafb]"},ae={class:"mb-4 flex flex-col gap-y-1"},de=["onClick"],re={class:"text-[14px] truncate"},ie=["onClick"],le={class:"flex flex-col gap-2"},ne=["onClick"],ce={class:"flex w-5 h-5 rounded items-center justify-center bg-[#0000000b]"},pe={key:0,class:"text-tx-secondary text-center text-xs w-full py-4"},fe={key:1,class:"p-10 text-center"},ve=I({__name:"chat-history",setup(_e){const{chatHistory:m,isLoading:ue,isRefreshing:k,isFinished:w,currentSessionId:C,fetchChatRecord:E,createNewSession:B,switchToSession:F,deleteSession:S,loadHistory:H}=Q(),M=V(()=>{const l=b(),e=new Map;return m.value.forEach(s=>{const o=b(s.create_time);let n;l.diff(o,"day")<30?n="30天内":n=o.format("YYYY-MM"),e.has(n)||e.set(n,[]),e.get(n).push(s)}),Array.from(e.entries()).map(([s,o])=>({date:s,sessions:o})).sort((s,o)=>s.date===o.date?0:s.date==="30天内"?-1:o.date==="30天内"?1:o.date.localeCompare(s.date))}),f=$(""),N=(l,e)=>{f.value=l?e:""},j=l=>{f.value=l},z=()=>{B()},A=l=>{l=="bottom"&&H()};return L(()=>{E()}),(l,e)=>{const p=T,s=q,o=Z,n=G,Y=O;return a(),r("div",U,[t("div",W,[c(s,{class:"w-full !h-[45px]",onClick:z},{default:v(()=>[c(p,{name:"local-icon-history_add",size:16}),e[0]||(e[0]=t("span",{class:"ml-2 text-[14px] font-bold"},"新建会话",-1))]),_:1}),t("div",X,[c(p,{name:"local-icon-time",size:16}),e[1]||(e[1]=t("span",{class:"text-[14px] font-bold"},"最近对话",-1))])]),t("div",ee,[i(k)?(a(),r("div",te,[...e[2]||(e[2]=[R('<div class="px-2 py-2.5" data-v-8c56499d><div class="h-3 w-16 bg-gray-200 rounded-full" data-v-8c56499d></div></div><div class="mb-4 flex flex-col gap-y-1" data-v-8c56499d><div class="h-10 bg-gray-200 rounded-lg" data-v-8c56499d></div><div class="h-10 bg-gray-200 rounded-lg" data-v-8c56499d></div><div class="h-10 bg-gray-200 rounded-lg" data-v-8c56499d></div></div><div class="px-2 py-2.5" data-v-8c56499d><div class="h-3 w-24 bg-gray-200 rounded-full" data-v-8c56499d></div></div><div class="mb-4 flex flex-col gap-y-1" data-v-8c56499d><div class="h-10 bg-gray-200 rounded-lg" data-v-8c56499d></div><div class="h-10 bg-gray-200 rounded-lg" data-v-8c56499d></div></div>',4)])])):(a(),r(_,{key:1},[i(m).length>0?(a(),D(n,{key:0,onEndReached:A},{default:v(()=>[t("div",se,[(a(!0),r(_,null,x(i(M),g=>(a(),r("div",null,[t("div",oe,y(g.date),1),t("div",ae,[(a(!0),r(_,null,x(g.sessions,d=>(a(),r("div",{key:d.task_id,class:u(["h-10 flex items-center justify-between px-2 py-[9px] cursor-pointer transition-colors rounded-lg group relative",[i(C)===d.task_id?"bg-[#e4edfd] text-primary hover:bg-[#e4edfd] hover:text-primary":" hover:bg-[#f1f3f5] "]]),onClick:()=>i(F)(d.task_id)},[t("div",re,y(d.message),1),c(o,{"popper-class":"!p-2 !rounded-xl !border-[#efefef]",trigger:"click","show-arrow":!1,onHide:h=>N(!1,d.task_id)},{reference:v(()=>[t("div",{class:u(["absolute -right-2 h-full flex items-center justify-center w-[56px] invisible group-hover:visible",i(f)===d.task_id?"!visible":""]),onClick:K(h=>j(d.task_id),["stop"])},[t("div",{class:u(["w-[28px] h-[28px] flex items-center justify-center rounded-full hover:bg-[#2631480f] text-gray-500",i(f)===d.task_id?"!bg-[#2631480f]":""])},[c(p,{name:"el-icon-MoreFilled",size:14})],2)],10,ie)]),default:v(()=>[t("div",le,[t("div",{class:"h-8 px-3 rounded-lg cursor-pointer flex items-center gap-3 hover:shadow-[0_0_0_1px_rgba(239,239,239,1)] hover:bg-[#F6F6F6]",onClick:h=>i(S)(d.task_id)},[t("span",ce,[c(p,{name:"local-icon-delete"})]),e[3]||(e[3]=t("span",null,"删除",-1))],8,ne)])]),_:2},1032,["onHide"])],10,de))),128))])]))),256)),i(w)?P("",!0):(a(),r("div",pe," 暂无更多了~ "))])]),_:1})):(a(),r("div",fe,[c(Y,{description:"暂无会话记录"})]))],64))])])}}});const Be=J(ve,[["__scopeId","data-v-8c56499d"]]);export{Be as default};
