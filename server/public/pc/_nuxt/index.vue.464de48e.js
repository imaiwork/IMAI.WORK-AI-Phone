import{E as G,a as K}from"./index.899f58ef.js";import{d as O,bP as Y,aG as J,r as h,k as d,l as y,m as s,q as l,s as a,Z as o,$ as M,v as c,aI as Z,I as g,t as p,Y as H,L as E,bM as Q,J as W,bC as C,ai as $,u as X,G as V,ay as ee,av as te,ba as le,y as se,cY as oe}from"./entry.556496e9.js";import{E as ae}from"./index.4bb9b943.js";import{E as ne,a as ie}from"./index.e8affe9d.js";import{E as re}from"./el-empty.5e752bd7.js";import{_ as de}from"./index.vue.ba665940.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                 */import{u as pe}from"./useSocialPlatform.5862be66.js";import{u as ue}from"./usePaging.cb2ddca4.js";import{e as ce,f as me}from"./device.b8ac970d.js";import{_ as fe}from"./edit.vue.e0099c8c.js";import{_ as _e}from"./detail.vue.6302f216.js";const ve={class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px]"},ye={class:"flex items-center justify-end h-[88px]"},ge={class:"flex items-center gap-[14px]"},be={class:"grow min-h-0 overflow-hidden flex flex-col"},xe={class:"grow min-h-0"},ke=["onClick"],Ee={class:"text-white"},we={class:"flex justify-center items-center gap-x-1"},Ce=["src"],$e={class:"flex items-center justify-center gap-2"},Ve={key:0},Pe={key:1},Te={key:2},Se={class:"flex justify-end items-center"},Be={class:"flex justify-center p-4"},Ze=O({__name:"index",setup(De){const{getPlatform:P}=pe();Y();const m=J({name:"",task_type:3,page_size:20,media_type:""}),{pager:f,getLists:i,resetPage:T}=ue({fetchFun:ce,params:m}),b=h(!1),w=h(),x=h(!1),k=h(),S=r=>{const{publish_start:t,publish_end:u}=r;return t&&u?C(u).diff(C(t),"day")+1+"天":"-"},B=async r=>{b.value=!0,await $(),w.value.open(r)},D=async r=>{x.value=!0,await $(),k.value.open(),k.value.setFormData(r)},j=async r=>{X().$confirm({message:"是否删除该任务？",theme:"dark",onConfirm:async()=>{try{await me({id:r}),V.msgSuccess("删除成功"),i()}catch(t){V.msgError(t||"删除失败")}}})};return i(),(r,t)=>{const u=G,R=K,v=ee,I=te,N=le,z=ae,L=se,n=ne,A=re,F=ie,U=de,q=oe;return d(),y(W,null,[s("div",ve,[s("div",he,[l(z,null,{default:a(()=>[s("div",ye,[s("div",ge,[s("div",null,[l(R,{modelValue:o(m).media_type,"onUpdate:modelValue":t[0]||(t[0]=e=>o(m).media_type=e),class:"!w-[160px]",placeholder:"请选择发布类型",clearable:"","popper-class":"dark-select-popper","show-arrow":!1,"empty-values":[null,void 0],onClear:t[1]||(t[1]=e=>o(i)()),onChange:t[2]||(t[2]=e=>o(i)())},{default:a(()=>[l(u,{label:"全部",value:""}),l(u,{label:"视频",value:"1"}),l(u,{label:"图片",value:"2"})]),_:1},8,["modelValue"])]),l(I,{modelValue:o(m).name,"onUpdate:modelValue":t[4]||(t[4]=e=>o(m).name=e),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:t[5]||(t[5]=e=>o(i)()),onKeydown:t[6]||(t[6]=M(e=>o(i)(),["enter"]))},{append:a(()=>[l(v,{text:"",onClick:t[3]||(t[3]=e=>o(i)())},{default:a(()=>[...t[12]||(t[12]=[c(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),s("div",null,[l(N,{content:"刷新"},{default:a(()=>[l(v,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:t[7]||(t[7]=e=>o(T)())})]),_:1})])])])]),_:1})]),s("div",be,[s("div",xe,[Z((d(),g(F,{height:"100%",data:o(f).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:a(()=>[l(A)]),default:a(()=>[l(n,{prop:"name",label:"任务名称",width:"240",fixed:"left"},{default:a(({row:e})=>[s("div",{class:"flex items-center justify-center gap-2 cursor-pointer",onClick:_=>D(e)},[s("div",Ee,p(e.name),1),l(L,{name:"local-icon-edit",color:"#ffffff"})],8,ke)]),_:1}),l(n,{label:"发布账号",props:"account","min-width":"200","show-overflow-tooltip":""},{default:a(({row:e})=>{var _;return[s("div",we,[s("img",{src:(_=o(P)(e.account_type))==null?void 0:_.icon,class:"w-4 h-4"},null,8,Ce),s("span",null,p(e.account),1)])]}),_:1}),l(n,{label:"任务类型",width:"120"},{default:a(({row:e})=>[c(p(e.auto_type==0?"手动":"24h任务"),1)]),_:1}),l(n,{label:"发布类型",width:"80"},{default:a(({row:e})=>[c(p(e.media_type==1?"视频":"图片"),1)]),_:1}),l(n,{label:"任务状态",width:"120"},{default:a(({row:e})=>[s("div",$e,[s("div",{class:H(["w-[6px] h-[6px] rounded-full",{"bg-primary":e.status==1,"bg-[#3BB840]":e.status==2}])},null,2),e.status==1?(d(),y("div",Ve,"进行中")):e.status==2?(d(),y("div",Pe,"已完成")):(d(),y("div",Te,"-"))])]),_:1}),l(n,{label:"开始时间",prop:"publish_start",width:"120"}),l(n,{label:"结束时间",prop:"publish_end",width:"120"}),l(n,{label:"发布周期","min-width":"100"},{default:a(({row:e})=>[s("div",null,p(S(e)),1)]),_:1}),l(n,{label:"发布进度",width:"100"},{default:a(({row:e})=>[c(p(e.published_count)+" / "+p(e.count),1)]),_:1}),l(n,{prop:"create_time",label:"创建时间",width:"180"}),l(n,{label:"操作",width:"120",fixed:"right",align:"right"},{default:a(({row:e})=>[s("div",Se,[l(v,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:_=>B(e)},{default:a(()=>[...t[13]||(t[13]=[c("详情",-1)])]),_:1},8,["onClick"]),e.auto_type==0?(d(),g(v,{key:0,type:"danger",link:"",size:"small",onClick:_=>j(e.id)},{default:a(()=>[...t[14]||(t[14]=[c("删除",-1)])]),_:1},8,["onClick"])):E("",!0)])]),_:1})]),_:1},8,["data"])),[[q,o(f).loading]])]),s("div",Be,[l(U,{modelValue:o(f),"onUpdate:modelValue":t[8]||(t[8]=e=>Q(f)?f.value=e:null),layout:"prev, pager, next",onChange:o(i)},null,8,["modelValue","onChange"])])])]),o(x)?(d(),g(fe,{key:0,ref_key:"editPopupRef",ref:k,onClose:t[9]||(t[9]=e=>x.value=!1),onSuccess:t[10]||(t[10]=e=>o(i)())},null,512)):E("",!0),o(b)?(d(),g(_e,{key:1,ref_key:"detailPopupRef",ref:w,onClose:t[11]||(t[11]=e=>b.value=!1)},null,512)):E("",!0)],64)}}});export{Ze as _};
