import{E as L,a as I}from"./el-tabs.80898acc.js";import{d as $,bP as G,r as u,cj as a,aF as K,A as P,c as j,dn as M,cx as U,D as H,o as J,k as p,l as _,m,q as d,s as f,J as Z,K as O,I as v,Z as i,bM as b,v as E,L as V,aq as Q,t as W,aH as X,bK as Y,G as C,y as ee,ax as te,_ as oe}from"./entry.062f432e.js";import{z as ie,A as re,B as me}from"./agent.e14901d7.js";import{KnbTypeEnum as k}from"./index.5bd136e1.js";import{ModeTypeEnum as ne}from"./index.11e2700c.js";import{_ as ae}from"./index.vue.585370ad.js";import se from"./index.1bc9aa34.js";import pe from"./index.48cc2f39.js";import le from"./index.3af046e0.js";import de from"./index.7171aefa.js";import ce from"./index.f059601b.js";import _e from"./index.8f7f6ac3.js";import{_ as ue}from"./index.vue.f1adc776.js";import"./raf.b9a1b517.js";import"./strings.21d5dbba.js";import"./clamp.ae7e1fa1.js";import"./toNumber.c46fba7d.js";import"./index.77032a68.js";import"./index.cd458299.js";import"./index.cf337782.js";import"./index.d50bd4d3.js";import"./cloneDeep.fcebcf93.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.a6d01468.js";import"./index.9217f5dd.js";import"./index.a7371e30.js";import"./_baseIteratee.64c51a6a.js";import"./index.27037b00.js";/* empty css                  *//* empty css               *//* empty css                     */import"./agent_bg.d1170fa3.js";import"./agent-logo.e69ecab2.js";import"./el-slider.05e3ae6d.js";import"./el-input-number.e6fb0bd1.js";import"./index.62bb7770.js";import"./debounce.ea0eb2e3.js";import"./el-switch.89c5d79b.js";import"./knowledge_base.519704cc.js";import"./index.66741974.js";import"./index.b74e9e2b.js";import"./el-empty.f71775a4.js";/* empty css                        *//* empty css                 */import"./menu-edit.9c5907af.js";import"./index.vue.87ce5496.js";import"./el-image.95dc6784.js";import"./el-image-viewer.78bb4aee.js";import"./throttle.78a6b94c.js";import"./web.vue.97e94e99.js";import"./index.24c52925.js";import"./index.vue.f7b69569.js";/* empty css                   */import"./useCopy.8d15a943.js";import"./usePaging.8d013439.js";import"./create-popup.vue.ff477319.js";import"./usage-setting.vue.99ce0520.js";import"./poster-setting.vue.37f8ffe0.js";import"./vue-qr.517d87e3.js";import"./js.vue.2eb0d8a1.js";import"./code-view.vue.cd1f25ba.js";import"./index.vue.8ae77c6b.js";import"./index.3864ff87.js";import"./gzh.vue.69bcbe93.js";import"./gzh-config.vue.44c73082.js";import"./api.vue.ba3534e2.js";import"./call-code.vue.a5385d29.js";import"./el-collapse.b7418b7d.js";import"./index.3347c311.js";import"./keywords-edit.vue.23e381c3.js";import"./add-content.431e6a21.js";import"./el-alert.46be68b7.js";import"./index.vue.5e1ffdab.js";import"./index.vue.b6c9e4fc.js";import"./arrow_down.70a5466c.js";import"./dom.7f5b5a10.js";import"./index.cf59f1a8.js";import"./emoji.vue.7aab2083.js";import"./useHandle.1586da0e.js";import"./person_wechat.703f63bb.js";import"./mini-program-card.vue.b34d25cf.js";import"./material-picker.vue.628a1b3b.js";import"./index.vue.86e69ecb.js";import"./sidebar.36aff9e8.js";import"./useMaterial.dd2e14eb.js";import"./container.aaa9f586.js";import"./upload.ec2901c6.js";import"./preview.vue.e4a2fc57.js";import"./link-card.vue.f1285504.js";import"./file-card.vue.1cbf166e.js";import"./workflow-edit.vue.3a46d21f.js";import"./import-data.vue.f5f73e0c.js";import"./el-steps.a6261c39.js";import"./customParseFormat.63173f8a.js";import"./chatting.6fb7cc26.js";import"./cloneDeep.9a60fb11.js";import"./chat.ecf9d7b5.js";import"./useChatManager.2be95be9.js";const fe={class:"h-full flex flex-col p-4"},be={class:"bg-white rounded-[20px] px-[50px]"},ke={class:"grow min-h-0 bg-white rounded-[20px] mt-4 flex"},ge={class:"flex-1 flex flex-col w-full"},ye={class:"px-[14px] h-[72px] flex items-center justify-between flex-shrink-0 border-b-[1px] border-[#0000000d]"},xe={key:0},he={class:"grow min-h-0"},we={key:0,class:"w-[400px] flex flex-col border-l-[1px] border-[#0000000d]"},ve={class:"h-[72px] flex items-center gap-x-2 justify-between flex-shrink-0 border-b-[1px] border-[#0000000d] px-5"},Ee={class:"flex-1 overflow-hidden text-ellipsis whitespace-nowrap"},Ve={class:"grow min-h-0"},Ce=$({__name:"edit",emits:["back"],setup(Ne,{emit:N}){const R=N,A=G(),l=Number(A.query.id),s=u("base"),g=u([{label:"人设",name:"base",component:a(ae)},{label:"知识库",name:"knb",component:a(se)},{label:"拟人化",name:"humanize",component:a(pe)},{label:"界面配置",name:"interface",component:a(le)},{label:"发布",name:"publish",component:a(de)},{label:"技能",name:"skill",component:a(ce)},{label:"调用设置",name:"call",component:a(_e)}]),e=K({id:l,kb_type:k.RAG,kb_ids:"",icons:"",image:"",bg_image:"",name:"",intro:"",model_id:"",model_sub_id:"",roles_prompt:"",search_mode:"similar",search_tokens:3e3,search_similar:.4,ranking_status:0,ranking_score:.5,context_num:3,is_public:0,is_enable:1,optimize_ask:0,optimize_m_id:"",optimize_s_id:"",search_empty_type:1,search_empty_text:"",top_p:.9,temperature:.6,presence_penalty:.2,frequency_penalty:.2,logprobs:0,top_logprobs:10,welcome_introducer:"",copyright:"",menus:[],flow_status:0,flow_config:{workflow_id:"",bot_id:"",app_id:"",api_token:""},threshold:.5,mode_type:ne.BALANCE}),y=u(),x=P(),S=j(()=>{var o;return(o=g.value.find(t=>t.name===s.value))==null?void 0:o.component}),T=async()=>{var o;await X(),(o=x.value)==null||o.startNewChat()},B=async()=>{if(l)try{const o=await ie({id:l});Y(o,e),e.kb_type==k.RAG&&o.kb_ids.length>0&&(e.kb_ids=o.kb_ids[0]),e.presence_penalty=Number(e.presence_penalty),e.frequency_penalty=Number(e.frequency_penalty),e.top_p=Number(e.top_p),e.temperature=Number(e.temperature)}catch(o){console.error("获取智能体详情失败:",o)}},h=async o=>{var t,c;try{await((c=(t=y.value)==null?void 0:t.validate)==null?void 0:c.call(t));const n={...e,kb_ids:e.kb_type==k.RAG&&typeof e.kb_ids=="string"?[e.kb_ids]:e.kb_ids};e.id?await re(n):await me(n),o||C.msgSuccess(`${e.id?"编辑":"添加"}成功`)}catch(n){o||C.msgError(typeof n=="string"?n:"请填写相关信息")}},D=M(()=>h(!0),300),{lockFn:q,isLock:z}=U(()=>h(!1));return H(e,()=>{D()},{deep:!0}),J(()=>{B()}),(o,t)=>{const c=L,n=I,F=ee,w=te;return p(),_("div",fe,[m("div",be,[d(n,{modelValue:i(s),"onUpdate:modelValue":t[0]||(t[0]=r=>b(s)?s.value=r:null)},{default:f(()=>[(p(!0),_(Z,null,O(i(g),r=>(p(),v(c,{key:r.name,label:r.label,name:r.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])]),m("div",ke,[m("div",ge,[m("div",ye,[m("div",{class:"flex items-center gap-2 cursor-pointer",onClick:t[1]||(t[1]=r=>R("back"))},[d(F,{name:"el-icon-ArrowLeft"}),t[4]||(t[4]=m("div",null,"返回",-1))]),["skill","publish","call"].includes(i(s))?V("",!0):(p(),_("div",xe,[d(w,{type:"primary",class:"!rounded-full !w-[68px]",loading:i(z),onClick:i(q)},{default:f(()=>[...t[5]||(t[5]=[E(" 保存 ",-1)])]),_:1},8,["loading","onClick"])]))]),m("div",he,[(p(),v(Q(i(S)),{ref_key:"formRef",ref:y,modelValue:i(e),"onUpdate:modelValue":t[2]||(t[2]=r=>b(e)?e.value=r:null),"agent-id":i(l)},null,8,["modelValue","agent-id"]))])]),["publish"].includes(i(s))?V("",!0):(p(),_("div",we,[m("div",ve,[m("div",Ee,W(i(e).name),1),d(w,{onClick:T},{default:f(()=>[...t[6]||(t[6]=[E("新建对话",-1)])]),_:1})]),m("div",Ve,[d(ue,{ref_key:"chatRef",ref:x,modelValue:i(e),"onUpdate:modelValue":t[3]||(t[3]=r=>b(e)?e.value=r:null),"agent-id":i(l)},null,8,["modelValue","agent-id"])])]))])])}}});const ho=oe(Ce,[["__scopeId","data-v-6beec613"]]);export{ho as default};
