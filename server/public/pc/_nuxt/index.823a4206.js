import{d as O,a as Q,r as p,aG as W,A as X,o as ee,ai as f,f as oe,k as n,l as c,aI as N,Z as t,m as o,q as l,s as r,J as P,K as se,I as R,t as T,Y as z,d$ as te,v as E,dU as ae,a8 as ie,L as M,G as B,y as ne,ay as le,cY as re,u as de,_ as ce}from"./entry.556496e9.js";import{E as pe}from"./el-card.7b8b3049.js";import{E as fe}from"./index.a390bc0e.js";/* empty css                   */import{u as ue}from"./usePaging.cb2ddca4.js";import{u as me,i as _e,T as ve}from"./useMindMap.d078806b.js";import{b as ge,c as xe}from"./mind_map.667e7a11.js";import{_ as he}from"./fixed-btns.vue.0d8b7863.js";import{_ as we}from"./index.vue.590d0eb3.js";import{E as ye}from"./index.1e989812.js";import"./index.3864ff87.js";import"./index.937f4495.js";import"./katex.3347b9ac.js";import"./index.899f58ef.js";import"./index.4bb9b943.js";import"./index.ef7246b4.js";import"./strings.09a7c832.js";import"./_baseIteratee.4a27397d.js";import"./toNumber.844d22bd.js";import"./clamp.b3f2460d.js";import"./index.c754b099.js";import"./el-slider.3edc03f9.js";import"./el-input-number.fadfd561.js";import"./index.e9eda615.js";import"./debounce.0430f44a.js";/* empty css                  *//* empty css               *//* empty css                     */import"./useDictOptions.8bb858a6.js";import"./knowledge_base.519704cc.js";import"./common.1728c92e.js";import"./throttle.ede6b671.js";const ke=["infinite-scroll-disabled"],be={class:"grow flex flex-col min-h-0"},Ce={class:"px-4 pb-4"},Ee={class:"grid grid-cols-2 gap-3 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},Me={class:"bg-[#F2F2F2] grow w-full relative"},Be={class:"p-3"},$e={class:"line-clamp-1 font-semibold pr-3 flex-shrink-0"},Le={class:"text-tx-primary text-sm"},Se={class:"rotate-90 origin-center p-1"},Fe={class:"flex flex-col gap-2"},De=["onClick"],Ne={class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg"},Pe=["onClick"],Re={key:0,class:"text-center py-4 text-gray-500"},Te={key:1,class:"w-full h-full fixed top-0 left-[9000px] opacity-0"},ze=O({__name:"index",setup(Ae){const $=Q(),A=de(),u=p(),g=W({page_no:1,page_size:15}),{getLists:x,pager:d}=ue({fetchFun:ge,params:g,isScroll:!0}),I=()=>{$.push("/app/mind_map/editor")},h=p(null),w=p(!1),V=async s=>{var e,a;w.value=!0,await f(),(e=h.value)==null||e.open(),(a=h.value)==null||a.setFormData({type:"txt",fileName:s.ask,content:s.reply})},K=()=>{$.back()},q=async()=>{d.lists=[],await x(),await f(),D()},L=(s,e)=>{s?u.value=e:u.value=void 0},G=async(s,e)=>{await A.$confirm({message:"确定删除此思维导图吗？",onConfirm:async()=>{await xe({id:s}),B.msgSuccess("删除成功"),d.lists.splice(e,1)}})},S=X([]),{createCanvasPng:H}=me(),y=p(!1),k=p(null),Y=async s=>{y.value=!0,B.loading("生成中..."),await f(),(await F(k.value,d.lists[s].reply)).fit(),setTimeout(()=>{H(k.value),y.value=!1,B.closeLoading()},1e3)},F=async(s,e)=>{let a=_e.create(s);await f();const m=new ve,{root:_}=m.transform(e);return a.setData(_),setTimeout(()=>{a.fit()},100),a},D=async s=>{d.lists.forEach(async(e,a)=>{await F(S.value[a],e.reply)})};p(!1);const j=async()=>{g.page_no+=1,await x()};return ee(async()=>{await x(),await f(),D()}),(s,e)=>{const a=ne,m=oe("router-link"),_=pe,b=le,J=fe,U=re,Z=ye;return n(),c(P,null,[N((n(),c("div",{class:"flex flex-col h-full overflow-y-auto","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!t(d).isLoad,"infinite-scroll-distance":10},[e[6]||(e[6]=o("div",{class:"text-[20px] font-bold p-4"},"思维导图",-1)),o("div",be,[o("div",Ce,[N((n(),c("div",Ee,[l(_,{shadow:"never",class:"!rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]"},{default:r(()=>[l(m,{to:"/app/mind_map/editor",class:"flex w-full h-72 items-center justify-center flex-col gap-4 cursor-pointer"},{default:r(()=>[l(a,{name:"el-icon-Plus",color:"var(--color-primary)",size:32}),e[1]||(e[1]=o("div",{class:"text-primary"},"新增思维导图",-1))]),_:1})]),_:1}),(n(!0),c(P,null,se(t(d).lists,(i,C)=>(n(),R(_,{shadow:"never",class:z(["cursor-pointer !rounded-xl bg-white relative hover:scale-[1.02] hover:shadow-[0_14px_24px_0_rgba(0,0,0,0.05)] !p-0 group",[t(u)==i.id?"shadow-[0_14px_24px_0_rgba(0,0,0,0.05)]":""]]),key:C},{default:r(()=>[l(m,{to:`/app/mind_map/editor?id=${i.id}`,class:"w-full flex-grow h-72 group flex flex-col"},{default:r(()=>[o("div",Me,[(n(),c("svg",{ref_for:!0,ref_key:"mindMapContainer",ref:S,class:"w-full h-full"},null,512)),e[2]||(e[2]=o("div",{class:"absolute w-full h-full z-20 top-0 left-0"},null,-1))]),o("div",Be,[o("div",$e,T(i.ask),1),o("div",Le,T(i.create_time),1)])]),_:2},1032,["to"]),o("div",{class:z(["h-full absolute top-4 right-2 z-50 invisible group-hover:visible",[t(u)==i.id?"!visible":""]])},[l(J,{"show-arrow":!1,"popper-class":"!w-[120px] !min-w-[120px] !p-[6px] !rounded-xl",onShow:v=>L(!0,i.id),onHide:v=>L(!1,i.id)},{reference:r(()=>[o("div",Se,[l(a,{name:"el-icon-MoreFilled"})])]),default:r(()=>[o("div",Fe,[o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>Y(C)},[l(b,{link:"",icon:t(te)},{default:r(()=>[...e[3]||(e[3]=[E(" 导出文件 ",-1)])]),_:1},8,["icon"])],8,De),o("div",Ne,[l(b,{link:"",icon:t(ae),onClick:v=>V(i)},{default:r(()=>[...e[4]||(e[4]=[E(" 训练知识库 ",-1)])]),_:1},8,["icon","onClick"])]),o("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg",onClick:v=>G(i.id,C)},[l(b,{link:"",icon:t(ie)},{default:r(()=>[...e[5]||(e[5]=[E(" 删除 ",-1)])]),_:1},8,["icon"])],8,Pe)])]),_:2},1032,["onShow","onHide"])],2)]),_:2},1032,["class"]))),128))])),[[U,t(d).loading]])]),t(d).isLoad?M("",!0):(n(),c("div",Re,"暂无更多了"))]),l(he,{"show-add":t(g).page_no>1,onAdd:I,onBack:K,onRefresh:q},null,8,["show-add"])],8,ke)),[[Z,j]]),t(w)?(n(),R(we,{key:0,ref_key:"knbBindRef",ref:h,onClose:e[0]||(e[0]=i=>w.value=!1)},null,512)):M("",!0),t(y)?(n(),c("div",Te,[(n(),c("svg",{ref_key:"exportSvg",ref:k,class:"w-full h-full"},null,512))])):M("",!0)],64)}}});const xo=ce(ze,[["__scopeId","data-v-7d08a23d"]]);export{xo as default};
