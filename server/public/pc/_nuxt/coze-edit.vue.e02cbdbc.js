import{d as S,au as U,c as q,A as g,aG as G,cy as $,G as i,bK as j,k as L,I as N,s as r,m as l,q as t,a3 as T,Z as a,v as W,c_ as K,c$ as X,y as Z,av as H,aw as J,d0 as M,d1 as O,az as P,ay as Q,cX as Y}from"./entry.9c858de7.js";import{_ as ee}from"./index.31653464.js";import{i as oe,j as te}from"./agent.4a5bb123.js";import{CozeTypeEnum as ae}from"./index.11e2700c.js";import{_ as x}from"./coze_bg.3844d1de.js";import se from"./agent-logo.bb6ce9af.js";const le={class:"mt-10"},ne={class:"mt-[25px]"},re={class:"p-8"},de={class:"flex justify-center"},ge=S({__name:"coze-edit",emits:["close","success"],setup(ce,{expose:b,emit:v}){const u=v,y=U(),w=q(()=>{const{shop_logo:s}=y.getWebsiteConfig||{};return s}),m=g(),o=G({id:"",name:"",type:ae.AGENT,introduced:"",bg_image:"",coze_id:"",stream:1,avatar:w.value,permissions:0}),z={name:[{required:!0,message:"请输入智能体名称"}],introduced:[{required:!0,message:"请输入智能体介绍"}],coze_id:[{required:!0,message:"请输入Coze智能体ID"}],stream:[{required:!0,message:"请选择输出方式"}]},p=g(),V=s=>{const{uri:e}=s.data;o.bg_image=e},E=async()=>{try{const s=await K(x,"coze_bg.png"),{uri:e}=await X({file:s});o.bg_image=e}catch(s){console.error("默认背景上传失败:",s)}},{lockFn:k,isLock:C}=$(async()=>{var s;if(!o.avatar){i.msgError("请上传智能体头像");return}await((s=p.value)==null?void 0:s.validate()),o.bg_image||await E();try{o.id?await oe(o):await te(o),i.msgSuccess(`${o.id?"编辑":"添加"}成功`),_(),u("success")}catch(e){i.msgError(e)}}),I=async()=>{m.value.open()},_=()=>{u("close")};return b({open:I,setFormData:s=>j(s,o)}),(s,e)=>{const F=Z,B=ee,c=H,d=J,f=M,R=O,h=P,A=Q,D=Y;return L(),N(D,{ref_key:"popupRef",ref:m,async:"",width:"415px","confirm-button-text":"","cancel-button-text":"","header-class":"!p-0","footer-class":"!p-0","body-class":"coze-edit-body",style:{padding:"0"},"show-close":!1},{default:r(()=>[l("div",null,[l("div",{class:"absolute w-6 h-6 flex items-center justify-center rounded-full right-4 top-4 cursor-pointer bg-[#dfdfdf4d]",onClick:_},[t(F,{name:"el-icon-Close",color:"#8B9199"})]),l("div",{class:"top",style:T({backgroundImage:`url(${a(o).bg_image||a(x)})`})},[l("div",le,[t(se,{modelValue:a(o).avatar,"onUpdate:modelValue":e[0]||(e[0]=n=>a(o).avatar=n)},null,8,["modelValue"])]),l("div",ne,[t(B,{limit:1,"show-progress":"","show-file-list":!1,onSuccess:V},{default:r(()=>[...e[5]||(e[5]=[l("div",{class:"w-[72px] h-[29px] flex items-center justify-center rounded-[32px] bg-[#00000066] text-white"}," 更换背景 ",-1)])]),_:1})])],4),l("div",re,[e[7]||(e[7]=l("div",{class:"text-lg font-bold"},"新增Coze智能体",-1)),e[8]||(e[8]=l("div",{class:"text-xs text-[#0000004d] mt-2"},"快速搭建对话式智能体",-1)),t(h,{ref_key:"formRef",ref:p,model:a(o),rules:z,"label-position":"top",class:"mt-6"},{default:r(()=>[t(d,{label:"智能体名称",prop:"name"},{default:r(()=>[t(c,{modelValue:a(o).name,"onUpdate:modelValue":e[1]||(e[1]=n=>a(o).name=n),class:"!h-10",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"智能体介绍",prop:"introduced"},{default:r(()=>[t(c,{modelValue:a(o).introduced,"onUpdate:modelValue":e[2]||(e[2]=n=>a(o).introduced=n),type:"textarea",placeholder:"请输入智能体的说明",resize:"none",rows:6},null,8,["modelValue"])]),_:1}),t(d,{label:"Coze智能体ID",prop:"coze_id"},{default:r(()=>[t(c,{modelValue:a(o).coze_id,"onUpdate:modelValue":e[3]||(e[3]=n=>a(o).coze_id=n),class:"!h-10",placeholder:"请输入Coze智能体ID"},null,8,["modelValue"])]),_:1}),t(d,{label:"输出方式",prop:"stream"},{default:r(()=>[t(R,{modelValue:a(o).stream,"onUpdate:modelValue":e[4]||(e[4]=n=>a(o).stream=n)},{default:r(()=>[t(f,{label:"流式输出",value:1}),t(f,{label:"直接返回",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),l("div",de,[t(A,{color:"#000000",class:"!rounded-full !h-[50px] w-[310px] shadow-[0_6px_12px_0px_#0065FB33]",loading:a(C),onClick:a(k)},{default:r(()=>[...e[6]||(e[6]=[W(" 保存 ",-1)])]),_:1},8,["loading","onClick"])])])])]),_:1},512)}}});export{ge as _};
