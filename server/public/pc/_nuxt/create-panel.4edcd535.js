import{d as le,aG as oe,bC as ae,r as S,D as re,cy as ie,G as m,bb as de,k as r,l as i,m as t,q as a,s as d,v as M,Z as l,L as u,J as c,K as v,I as g,t as x,Y as P,aI as W,a0 as ne,cZ as me,y as fe,ay as pe,av as ue,d0 as ce,d1 as _e,ax as ve,_ as xe}from"./entry.9c858de7.js";import{_ as be}from"./index.31653464.js";import{E as ge,a as ke}from"./index.c162b53f.js";import{E as we}from"./el-date-picker-panel.a83e363a.js";import{E as ye}from"./el-time-picker.fdc252b2.js";import{E as he}from"./el-switch.79e3c4c6.js";import{_ as Ve}from"./index.vue.421b9ac0.js";import{E as Ee}from"./index.d2366752.js";/* empty css                  *//* empty css               *//* empty css                     */import{f as Ce,d as De}from"./sph.d6d2831a.js";import{_ as Re}from"./remark-pop.vue.265ca3cb.js";import{useCreateTask as $e}from"./useCreateTask.5bb3e34b.js";import"./index.c8d73379.js";import"./index.3f0b5ea1.js";import"./cloneDeep.051307f4.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.bbca104f.js";import"./strings.39ad33fc.js";import"./_baseIteratee.86867911.js";import"./toNumber.590fb445.js";import"./clamp.c33da429.js";import"./index.c04086ee.js";import"./customParseFormat.daac6c48.js";import"./panel-time-pick.62840ccc.js";import"./index.0a3baecf.js";import"./debounce.3f6e2cd0.js";import"./useDictOptions.e7948432.js";import"./device.b8ac970d.js";import"./person_wechat.703f63bb.js";const Ue={class:"h-full bg-app-bg-2 rounded-[20px] flex flex-col"},Le={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},Se={class:"flex items-center gap-1"},Me={class:"grow min-h-0"},Pe={class:"w-[456px] mx-auto mt-6"},We={class:"mt-6 flex flex-col gap-y-3"},Ye={key:0},Te={class:"flex flex-col items-center justify-center py-6"},Fe={key:1},je={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4"},ze={class:"mt-4"},Ae={class:"flex flex-wrap gap-2"},Be=["onClick"],He={key:0,class:"mt-2"},Ie={class:"mt-4"},Ge={key:0,class:"mt-2"},Ne={class:"text-[#FF2442] mt-1 text-xs"},qe={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4 mt-4"},Oe={class:"mt-4"},Ke={class:"mt-2"},Ze={class:"mt-2"},Je={class:"flex items-center gap-x-4"},Qe={class:"flex-1"},Xe={class:"flex items-center gap-x-2"},et={class:"flex-1"},tt={class:"flex-1"},st={class:"flex items-center gap-x-2"},lt={class:"flex-1"},ot={class:"mt-3"},at={class:"flex items-center justify-between mb-3"},rt={key:0},it={class:"flex flex-wrap gap-2"},dt=["onClick"],nt={class:"text-white text-xs"},mt=["onClick"],ft={class:"flex justify-end"},pt=le({__name:"create-panel",emits:["back"],setup(ut,{emit:Y}){const h=Y,o=oe({name:`自动加好友任务${ae().format("YYYYMMDDHHmmss")}`,source:1,fileurl:"",crawling_task_ids:[],add_type:"1",add_number:15,add_interval_time:10,add_friends_prompt:"",add_remark_enable:1,remarks:[],wechat_id:[],wechat_reg_type:0,task_frep:1,custom_date:[],time_config:["",""],device_codes:[]}),k=S(""),{getWechatRemarks:T,deviceOptions:V,currentFrequency:_,disabledDate:F,handleFrequency:j,isAddRemarkGen:E,remarkPopupRef:z,handleAddRemark:A,handleAddRemarkConfirm:B,handleEditRemark:H,handleDeleteRemark:I,checkTimeConfig:G}=$e(o);re(T,n=>{o.remarks=[...n||[]]},{immediate:!0});const C=S([]),N=n=>{o.fileurl=n.data.uri},{isLock:q,lockFn:O}=ie(async()=>{if(o.name)if(o.source==1&&o.fileurl==""){m.msgWarning("请上传文件");return}else if(o.source==2&&o.crawling_task_ids.length==0){m.msgWarning("请选择获客任务");return}else if(o.device_codes.length==0){m.msgWarning("请选择执行设备");return}else if(_.value==5&&o.custom_date.length==0){m.msgWarning("请选择自定义日期");return}else if(G()){if(o.wechat_id.length==0){m.msgWarning("请选择加微微信");return}else if(o.add_remark_enable==1&&o.remarks.length==0){m.msgWarning("请输入加好友备注内容");return}}else return;else{m.msgWarning("请输入任务名称");return}try{await Ce({...o,time_config:[`${o.time_config[0]}-${o.time_config[1]}`]}),m.msgSuccess("创建成功"),h("back")}catch(n){k.value=n,m.msgError(n)}}),D=async n=>{const{lists:e}=await De({page:1,page_size:20,status:"3,4",name:n});C.value=e};return D(),(n,e)=>{const w=fe,R=pe,y=ue,$=ce,K=_e,Z=be,f=ge,b=ke,J=we,Q=ye,X=he,ee=Ve,te=ve,se=Ee,U=de("number-input");return r(),i(c,null,[t("div",Ue,[t("div",Le,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=s=>h("back"))},[a(w,{name:"el-icon-ArrowLeft",color:"#ffffff"}),e[15]||(e[15]=t("div",{class:"text-white"},"返回",-1))]),t("div",Se,[a(R,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:l(q),onClick:l(O)},{default:d(()=>[...e[16]||(e[16]=[M(" 确认执行 ",-1)])]),_:1},8,["loading","onClick"])])]),t("div",Me,[a(se,null,{default:d(()=>[t("div",Pe,[e[42]||(e[42]=t("div",{class:"text-[20px] font-bold text-white"},"创建新的自动加好友任务",-1)),t("div",We,[t("div",null,[e[17]||(e[17]=t("div",{class:"text-[#ffffff80] mb-3"},"任务名称",-1)),a(y,{modelValue:l(o).name,"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).name=s),placeholder:"请输入任务名称",class:"!h-11",maxlength:"30","show-word-limit":"",clearable:""},null,8,["modelValue"])]),t("div",null,[e[20]||(e[20]=t("div",{class:"text-[#ffffff80] mb-3"},"线索来源",-1)),t("div",null,[a(K,{modelValue:l(o).source,"onUpdate:modelValue":e[2]||(e[2]=s=>l(o).source=s)},{default:d(()=>[a($,{value:1,border:""},{default:d(()=>[...e[18]||(e[18]=[t("div",{class:"text-white"},"表格导入",-1)])]),_:1}),a($,{value:2,border:""},{default:d(()=>[...e[19]||(e[19]=[t("div",{class:"text-white"},"获客任务引用",-1)])]),_:1})]),_:1},8,["modelValue"])])]),l(o).source==1?(r(),i("div",Ye,[e[23]||(e[23]=t("div",{class:"flex items-center justify-between mb-3"},[t("div",{class:"text-[#ffffff80]"},"导入模版"),t("div",{class:"text-primary cursor-pointer"},[t("a",{href:"/static/file/template/wechatidcsv.csv",target:"_blank"},"下载模版")])],-1)),a(Z,{type:"file","list-type":"text","show-file-list":"",accept:".csv,.xlsx",drag:"","max-size":20,limit:1,onSuccess:N,onRemove:e[3]||(e[3]=s=>l(o).fileurl="")},{default:d(()=>[t("div",Te,[a(w,{name:"local-icon-upload2",size:48,color:"#ffffff4d"}),e[21]||(e[21]=t("div",{class:"mt-3 text-[#ffffff4d]"},"点击添加或将文件拖拽到该处",-1)),e[22]||(e[22]=t("div",{class:"text-xs text-[#ffffff33] mt-2 w-[80%]"}," 支持扩展名：.csv、.xlsx格式 ",-1))])]),_:1})])):u("",!0),l(o).source==2?(r(),i("div",Fe,[e[24]||(e[24]=t("div",{class:"text-[#ffffff80] mb-3"},"获客任务引用",-1)),a(b,{modelValue:l(o).crawling_task_ids,"onUpdate:modelValue":e[4]||(e[4]=s=>l(o).crawling_task_ids=s),placeholder:"请选择获客任务",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"dark-select-popper","show-arrow":!1,"remote-method":D},{default:d(()=>[(r(!0),i(c,null,v(l(C),s=>(r(),g(f,{label:s.name,value:s.id,key:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):u("",!0),t("div",null,[e[25]||(e[25]=t("div",{class:"text-[#ffffff80] mb-3"},"执行设备",-1)),t("div",null,[a(b,{modelValue:l(o).device_codes,"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).device_codes=s),placeholder:"请选择执行设备",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[(r(!0),i(c,null,v(l(V).deviceLists,s=>(r(),g(f,{label:s.device_code,value:s.device_code,key:s.device_code},{default:d(()=>[M(x(s.device_name)+"（"+x(s.device_code)+"） ",1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),t("div",null,[e[29]||(e[29]=t("div",{class:"text-[#ffffff80] mb-3"},"时间设置",-1)),t("div",je,[e[27]||(e[27]=t("div",{class:"text-white"},"自动加好友设置",-1)),t("div",ze,[t("div",Ae,[(r(),i(c,null,v([1,3,5,10,30],(s,p)=>t("div",{key:p,class:P(["cursor-pointer rounded-md px-4 py-2 border border-app-border-2 text-white hover:bg-app-bg-1",[l(o).task_frep==s&&l(_)!=5?"bg-primary":""]]),onClick:L=>l(j)(s,p)},x(s)+"天 ",11,Be)),64)),t("div",{class:P(["cursor-pointer rounded-md px-4 py-2 border border-app-border-2 text-white",[l(_)==5?"bg-primary":""]]),onClick:e[6]||(e[6]=s=>_.value=5)}," 自定义 ",2)]),l(_)==5?(r(),i("div",He,[a(J,{modelValue:l(o).custom_date,"onUpdate:modelValue":e[7]||(e[7]=s=>l(o).custom_date=s),type:"dates",placeholder:"请选择自定义日期",format:"MM-DD","value-format":"YYYY-MM-DD","popper-class":"dark-date-picker-popper","disabled-date":l(F)},null,8,["modelValue","disabled-date"])])):u("",!0)]),e[28]||(e[28]=t("div",{class:"text-white mt-4"},"每日执行时间",-1)),t("div",Ie,[a(Q,{modelValue:l(o).time_config,"onUpdate:modelValue":e[8]||(e[8]=s=>l(o).time_config=s),type:"time","is-range":"","start-placeholder":"请选择开始时间","end-placeholder":"请选择结束时间",format:"HH:mm","value-format":"HH:mm","popper-class":"dark-select-popper","show-arrow":!1},null,8,["modelValue"])]),l(k)?(r(),i("div",Ge,[e[26]||(e[26]=t("div",null,"任务冲突",-1)),t("view",Ne,x(l(k)),1)])):u("",!0)])]),t("div",qe,[e[40]||(e[40]=t("div",{class:"text-white"},"自动加好友设置",-1)),e[41]||(e[41]=t("div",{class:"text-[#ffffff80] text-xs mt-2"}," 注意：开启此任务请确保当前网络是常用安全网络，加资账号为常态化老号 ",-1)),t("div",Oe,[e[30]||(e[30]=t("div",{class:"text-[#ffffff80] mb-3"},"加微微信：",-1)),a(b,{modelValue:l(o).wechat_id,"onUpdate:modelValue":e[9]||(e[9]=s=>l(o).wechat_id=s),placeholder:"请选择添加的微信",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[(r(!0),i(c,null,v(l(V).wechatLists,s=>(r(),g(f,{label:s.wechat_nickname,value:s.wechat_id,key:s.wechat_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",Ke,[e[31]||(e[31]=t("div",{class:"text-[#ffffff80] mb-3"},"加微规则：",-1)),a(b,{modelValue:l(o).wechat_reg_type,"onUpdate:modelValue":e[10]||(e[10]=s=>l(o).wechat_reg_type=s),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:d(()=>[a(f,{label:"全部",value:0}),a(f,{label:"微信号",value:1}),a(f,{label:"手机号",value:2})]),_:1},8,["modelValue"])]),t("div",Ze,[e[36]||(e[36]=t("div",{class:"text-[#ffffff80] mb-3"},"自动加好友频率：",-1)),t("div",Je,[t("div",Qe,[e[33]||(e[33]=t("div",{class:"text-white mb-3"},"当天执行",-1)),t("div",Xe,[t("div",et,[W(a(y,{modelValue:l(o).add_number,"onUpdate:modelValue":e[11]||(e[11]=s=>l(o).add_number=s),type:"number",class:"!h-11"},null,8,["modelValue"]),[[U,{min:1,max:99}]])]),e[32]||(e[32]=t("span",{class:"text-[#ffffff80]"},"条",-1))])]),t("div",tt,[e[35]||(e[35]=t("div",{class:"text-white mb-3"},"每次间隔",-1)),t("div",st,[t("div",lt,[W(a(y,{modelValue:l(o).add_interval_time,"onUpdate:modelValue":e[12]||(e[12]=s=>l(o).add_interval_time=s),type:"number",class:"!h-11"},null,8,["modelValue"]),[[U,{min:1,max:999}]])]),e[34]||(e[34]=t("span",{class:"text-[#ffffff80]"},"分钟",-1))])])])]),t("div",ot,[t("div",at,[e[37]||(e[37]=t("div",{class:"text-white"},"加好友验证内容",-1)),a(X,{modelValue:l(o).add_remark_enable,"onUpdate:modelValue":e[13]||(e[13]=s=>l(o).add_remark_enable=s),style:{"--el-switch-off-color":"#333333"},"active-value":1,"inactive-value":0},null,8,["modelValue"])]),l(o).add_remark_enable==1?(r(),i("div",rt,[t("div",it,[(r(!0),i(c,null,v(l(o).remarks,(s,p)=>(r(),i("div",{key:p,class:"cursor-pointer hover:bg-app-bg-1 transition-all duration-300 border border-app-border-2 rounded-md px-4 py-2 flex items-center",onClick:L=>l(H)(s,p)},[t("div",nt,x(s),1),e[38]||(e[38]=t("div",{class:"w-[1px] h-[8px] bg-app-border-2 mx-2"},null,-1)),t("div",{class:"w-4 h-4",onClick:ne(L=>l(I)(p),["stop"])},[a(ee,{"icon-size":10,theme:l(me).DARK},null,8,["theme"])],8,mt)],8,dt))),128))]),a(te,{class:"!my-4 !border-app-border-2"}),t("div",ft,[a(R,{class:"!h-8 !border-[#ffffff1a]",color:"#121212",onClick:l(A)},{default:d(()=>[a(w,{name:"el-icon-Plus",color:"#ffffff",size:12}),e[39]||(e[39]=t("div",{class:"text-white text-xs ml-1"},"新增文案",-1))]),_:1},8,["onClick"])])])):u("",!0)])])])])]),_:1})])]),l(E)?(r(),g(Re,{key:0,ref_key:"remarkPopupRef",ref:z,onClose:e[14]||(e[14]=s=>E.value=!1),onConfirm:l(B)},null,8,["onConfirm"])):u("",!0)],64)}}});const qt=xe(pt,[["__scopeId","data-v-e9b15bba"]]);export{qt as default};
