import{E as Ae,a as De}from"./el-breadcrumb.22a2ac18.js";import{E as Pe}from"./el-card.92a61e7f.js";import{d as Re,bP as $e,a as Te,r as c,c as F,aG as Le,dO as j,o as Ne,k as i,l as d,m as t,q as n,s as r,v as w,t as u,Z as l,J as $,K as G,Y as U,L as x,$ as Se,aI as Ie,I as C,a0 as q,bM as Be,G as p,el as _,ai as Ve,y as Oe,ax as Fe,ay as je,av as Ge,cY as Ue,u as qe}from"./entry.9c858de7.js";import{E as Me}from"./index.5a0721a3.js";import{E as Ke}from"./el-avatar.c9ca9098.js";import{E as ze}from"./index.bbca104f.js";import{E as He}from"./el-empty.9547ccf9.js";import{E as f,a as Xe}from"./index.3c639db8.js";import{_ as Ye}from"./index.vue.2c8f7917.js";/* empty css                   *//* empty css               *//* empty css                 *//* empty css                     */import{u as Je}from"./useSocialPlatform.3ae66bf4.js";import{u as We}from"./useDeviceWs.f32023fe.js";import{u as Ze}from"./useAddDeviceAccount.09fa33ed.js";import{u as Qe}from"./usePaging.c86a33a9.js";import{g as M,m as et}from"./service.9c966dd0.js";import{h as tt}from"./device.b8ac970d.js";import{_ as ot}from"./device-add.vue.010c2a6b.js";import{_ as st}from"./device-progress.vue.0399c6ef.js";import"./index.d2366752.js";import"./_baseIteratee.86867911.js";import"./debounce.3f6e2cd0.js";import"./toNumber.590fb445.js";import"./raf.737e07d1.js";import"./index.c162b53f.js";import"./strings.39ad33fc.js";import"./clamp.c33da429.js";import"./index.c04086ee.js";import"./sph_icon.de3a3562.js";import"./useWebSocket.7a4060d6.js";import"./usePolling.b60e1bb6.js";import"./index.3f0b5ea1.js";/* empty css                    */const lt={class:"h-full flex flex-col p-4"},nt={class:"h-[71px] px-5 flex items-center justify-between border-b border-b-[#E8E8E8]"},rt={class:"flex items-center gap-2"},at={class:"min-w-[170px] flex items-center gap-2 cursor-pointer"},it={class:"text-[#36393F] text-lg font-bold"},ct={class:"flex flex-col"},dt={class:"flex flex-col gap-y-1 p-2 max-h-[300px] overflow-y-auto"},ut=["onClick"],pt={class:"flex justify-center py-3"},mt={key:0,class:"bg-[#F2F3F8] text-xs py-1 px-2 rounded-lg"},ft={class:"grow min-h-0 flex w-full"},_t={class:"w-[178px] bg-white border-r border-r-[#E8E8E8] flex-shrink-0"},vt={class:"flex flex-col gap-y-4 p-4"},gt=["onClick"],ht=["src"],yt={class:"flex-1 overflow-auto flex flex-col mt-4"},xt={class:"flex justify-between items-center px-4"},Et={class:"grow min-h-0 mt-4 w-full"},bt={class:"flex items-center justify-center gap-x-2"},kt={class:"flex flex-col gap-2"},wt=["onClick"],Ct={class:"flex items-center justify-center"},At=["onClick"],Dt={key:0,class:"flex items-center justify-center h-full"},Pt={key:1,class:"flex items-center justify-center h-full"},Rt={class:"flex justify-end p-4"},mo=Re({__name:"[id]",setup($t){const K=$e(),z=Te(),H=qe(),{socialPlatformList:X,currentSocialPlatform:T}=Je(),A=c([]),L=c(null),v=c(!1),E=c(!1),N=c(""),Y=F(()=>A.value.find(s=>s.device_code===a.device_code)),J=F(()=>X.filter(s=>s.show)),{onEvent:W,send:Z}=We(),{showAddDevice:D,addDeviceLoading:Q,progressValue:ee,handleAddAccount:te,refreshAccount:oe,handleRefreshAccount:se}=Ze({send:Z,onEvent:W,onSuccess:s=>{const{msg:o,type:k,data:O}=s;switch(k){case _.GET_USER_INFO:v.value=!1,m();break;case _.OPEN_APP:case _.OPEN_PERSON_CENTER:case _.GET_ACCOUNT_INFO:case _.DATA_SEND:case _.GET_ACCOUNT_INFO_COMPLETE:N.value=o;break;default:E.value=!1,p.closeLoading();break}},onError:s=>{E.value=!0,p.closeLoading(),p.msgError(s.error)}}),le=async()=>{await S(),m()},b=c(!1),ne=async()=>{if(!b.value)try{b.value=!0;const{lists:s}=await M({status:1,device_code:a.device_code});if(s.length==0){p.msgError("暂无在线账号");return}P(s[0])}catch(s){p.msgError(s)}finally{b.value=!1}},re=c(null),S=async()=>{const{lists:s}=await tt({page_size:999});A.value=[{device_model:"全部",device_code:""},...s]},ae=async()=>{D.value=!0,await Ve(),L.value.open()},ie=s=>{E.value=!1,T.value=s,a.type=s,ue()},ce=s=>{a.device_code=s,m()},a=Le({type:j.XHS,name:"",account:"",device_code:""}),{pager:g,getLists:m,resetParams:de,resetPage:ue}=Qe({fetchFun:M,params:a}),pe=s=>{z.push({path:"/app/service",query:{type:j.XHS}})},I=c(),B=c(null),V=()=>{v.value=!0,te({device_code:a.device_code,type:a.type})},P=s=>{v.value=!0,oe.value=[{id:s.id,account:s.account,type:s.type}],se(s.device_code,s.type)},me=()=>{B.value?P(B.value):V()},fe=s=>{H.$confirm({message:"删除账号时，当前执行的任务将中断并无法继续，确定要删除该账号吗？",onConfirm:async()=>{p.loading("删除中...",I.value);try{await et({id:s.id}),p.msgSuccess("删除成功"),m()}catch(o){p.msgError(o)}finally{p.closeLoading()}}})};return Ne(async()=>{a.device_code=K.query.device_code,m()}),S(),(s,o)=>{const k=Ae,O=De,_e=Pe,h=Oe,ve=Fe,R=je,ge=Me,he=Ge,ye=Ke,xe=ze,Ee=He,be=Xe,ke=Ye,we=Ue;return i(),d($,null,[t("div",lt,[n(_e,{class:"!border-none !rounded-xl",shadow:"never"},{default:r(()=>[n(O,null,{default:r(()=>[n(k,null,{default:r(()=>[t("span",{class:"cursor-pointer text-[#8A8C99] hover:text-primary",onClick:o[0]||(o[0]=e=>s.$router.back())}," AI终端 ")]),_:1}),n(k,null,{default:r(()=>[...o[7]||(o[7]=[w("账号设置",-1)])]),_:1})]),_:1})]),_:1}),t("div",{class:"grow min-h-0 bg-white rounded-lg mt-4 flex flex-col overflow-hidden",ref_key:"containerRef",ref:I},[t("div",nt,[t("div",null,[t("div",rt,[n(ge,{"show-arrow":!1,"popper-class":"!p-0 !min-w-[200px]  !border-none !rounded-lg !shadow-[0_0_10px_1px_rgba(0,0,0,0.1)]"},{reference:r(()=>{var e;return[t("div",at,[n(h,{name:"el-icon-ArrowDownBold"}),t("span",it,u((e=l(Y))==null?void 0:e.device_model),1)])]}),default:r(()=>[t("div",ct,[t("div",dt,[(i(!0),d($,null,G(l(A),(e,y)=>(i(),d("div",{class:U(["break-all hover:bg-primary-light-9 rounded-lg p-2 cursor-pointer",{"bg-primary-light-9 text-primary":l(a).device_code===e.device_code}]),key:y,onClick:Ce=>ce(e.device_code)},u(e.device_model),11,ut))),128))]),n(ve,{class:"!m-0"}),t("div",pt,[n(R,{type:"primary",link:"",onClick:ae},{default:r(()=>[n(h,{name:"el-icon-Plus"}),o[8]||(o[8]=t("span",null,"添加设备",-1))]),_:1})])])]),_:1}),l(a).device_code?(i(),d("span",mt,"设备ID："+u(l(a).device_code),1)):x("",!0)])])]),t("div",ft,[t("div",_t,[t("div",vt,[(i(!0),d($,null,G(l(J),(e,y)=>(i(),d("div",{key:y,class:U(["flex items-center gap-x-3 px-4 hover:bg-primary-light-9 py-1.5 cursor-pointer rounded-lg",{"bg-primary-light-9":l(T)===e.type}]),onClick:Ce=>ie(e.type)},[t("img",{src:e.icon,class:"w-6 h-6"},null,8,ht),t("div",null,u(e.name),1)],10,gt))),128))])]),t("div",yt,[t("div",xt,[t("div",null,[n(R,{link:"",onClick:ne,loading:l(b)},{default:r(()=>[n(h,{name:"el-icon-Refresh"}),o[9]||(o[9]=t("span",null,"刷新数据",-1))]),_:1},8,["loading"])]),n(he,{modelValue:l(a).account,"onUpdate:modelValue":o[1]||(o[1]=e=>l(a).account=e),placeholder:"搜索账号信息",class:"!w-[200px]","prefix-icon":"el-icon-Search",clearable:"",onClear:o[2]||(o[2]=e=>l(de)()),onKeyup:o[3]||(o[3]=Se(e=>l(m)(),["enter"]))},null,8,["modelValue"])]),t("div",Et,[Ie((i(),C(be,{ref_key:"tableRef",ref:re,data:l(g).lists,height:"100%",stripe:"","row-style":{height:"60px",cursor:"pointer"},"header-cell-style":{height:"63px"},onRowClick:pe},{empty:r(()=>[l(a).device_code?(i(),d("div",Dt,[o[14]||(o[14]=w(" 还没有账号，",-1)),n(R,{type:"primary",link:"",onClick:V},{default:r(()=>[...o[13]||(o[13]=[w("点击获取设备账号信息",-1)])]),_:1})])):(i(),d("div",Pt,[n(Ee,{description:"暂无账号信息"})]))]),default:r(()=>[n(l(f),{label:"头像",width:"80"},{default:r(({row:e})=>[n(ye,{src:e.avatar},null,8,["src"])]),_:1}),n(l(f),{label:"账号/昵称",prop:"account","min-width":"180"},{default:r(({row:e})=>[t("div",bt,[t("div",null,[t("div",null,u(e.account),1),t("div",null,"("+u(e.nickname)+")",1)]),e.status==1?(i(),C(xe,{key:0,type:"success"},{default:r(()=>[...o[10]||(o[10]=[w("当前账号",-1)])]),_:1})):x("",!0)])]),_:1}),n(l(f),{label:"粉丝数量",prop:"fans","min-width":"100"},{default:r(({row:e})=>[t("div",null,u(e.fans||"-"),1)]),_:1}),n(l(f),{label:"点赞数量",prop:"thumbup_collect","min-width":"100"},{default:r(({row:e})=>[t("div",null,u(e.thumbup_collect||"-"),1)]),_:1}),n(l(f),{label:"关注数量",prop:"followers","min-width":"100"},{default:r(({row:e})=>[t("div",null,u(e.followers||"-"),1)]),_:1}),n(l(f),{label:"更新时间",prop:"create_time",width:"180"}),n(l(f),{label:"操作",width:"120px",fixed:"right"},{default:r(({row:e})=>[t("div",kt,[e.status==1?(i(),d("div",{key:0,class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:q(y=>P(e),["stop"])},[t("span",Ct,[n(h,{name:"el-icon-Refresh"})]),o[11]||(o[11]=t("span",null,"刷新数据",-1))],8,wt)):x("",!0),t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:q(y=>fe(e),["stop"])},[n(h,{name:"el-icon-Delete"}),o[12]||(o[12]=t("span",null,"账号移除",-1))],8,At)])]),_:1})]),_:1},8,["data"])),[[we,l(g).loading]])]),t("div",Rt,[n(ke,{modelValue:l(g),"onUpdate:modelValue":o[4]||(o[4]=e=>Be(g)?g.value=e:null),onChange:l(m)},null,8,["modelValue","onChange"])])])])],512)]),l(D)?(i(),C(ot,{key:0,ref_key:"addDeviceRef",ref:L,"bind-loading":l(Q),onClose:o[5]||(o[5]=e=>D.value=!1),onConfirm:le},null,8,["bind-loading"])):x("",!0),l(v)?(i(),C(st,{key:1,"progress-value":l(ee),"progress-error":l(E),step:l(N),onClose:o[6]||(o[6]=e=>v.value=!1),onRetry:me},null,8,["progress-value","progress-error","step"])):x("",!0)],64)}}});export{mo as default};
