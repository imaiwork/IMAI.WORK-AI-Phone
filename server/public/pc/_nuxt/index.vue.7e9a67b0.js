import{d as U,bP as Y,aG as Z,r as m,Z as o,k as l,l as i,m as t,q as n,s as c,$ as J,v,aI as C,J as $,K as Q,Y as R,a0 as I,cZ as W,t as r,L as h,I as T,bO as V,ai as P,ay as X,av as ee,y as se,ba as te,cY as oe,u as le,G as ne}from"./entry.45b56a4a.js";import{E as ae}from"./index.515d6243.js";import{_ as ie}from"./index.vue.fdfa7631.js";import{E as re}from"./el-image.c740ce69.js";/* empty css                     */import"./el-image-viewer.68e4a550.js";import{u as ce}from"./usePaging.9b885ff9.js";import{p as de,q as pe}from"./matrix.418b34fe.js";import{_ as ue}from"./empty.vue.edd4a3c1.js";import{SidebarTypeEnum as fe}from"./index.db2ee73f.js";import _e from"./create-panel.627a5a93.js";import me from"./preview-video-result.0e91a778.js";import{E as ve}from"./index.c9f70b6f.js";const xe={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},he={class:"flex-shrink-0 px-[14px] border-[0] border-b-[1px] border-app-border-1"},ge={class:"flex items-center justify-end h-[88px]"},ke={class:"flex items-center gap-[14px]"},ye=["infinite-scroll-disabled"],be={class:"h-full p-4"},we={key:0},Ee={class:"grid grid-cols-1 xl:grid-cols-2 gap-4"},Ce=["onClick"],$e=["onClick"],Re={class:"flex-shrink-0 w-[143px] border border-app-border-2 overflow-hidden rounded-md bg-black"},Ie={class:"flex-1 flex flex-col gap-y-[10px]"},Te={class:"text-white break-all line-clamp-1 mr-4"},Ve={class:"flex items-center gap-x-1"},Pe={class:"text-white"},Be={class:"flex items-center gap-x-1 text-white"},Se={class:"text-white"},Le={class:"text-white"},Ae={class:"flex items-center gap-x-2"},De={key:0,class:"text-white text-center text-xs w-full py-4"},Ne={key:1,class:"h-full flex items-center justify-center"},We=U({__name:"index",setup(qe){const B=Y(),f=Z({name:"",page_no:1,page_size:20}),{pager:d,getLists:g,resetPage:u}=ce({fetchFun:de,params:f,isScroll:!0}),S={0:"草稿箱",1:"待处理",2:"生成中",3:"已完成",4:"失败",5:"部分完成"},L=()=>{_.value=!1,window.history.replaceState("","",`?type=${fe.DIGITAL_HUMAN_CREATION}`),u()},A=()=>{f.page_no++,g()},k=m(),_=m(B.query.is_create=="1"),y=async()=>{var a;_.value=!0,V({is_create:1}),await P(),(a=k.value)==null||a.createEmptyTask()},D=async a=>{a.status==0&&(_.value=!0,V({is_create:1,create_id:a.id}))},N=async(a,e)=>{le().$confirm({message:"确定要删除该数字人任务吗？",theme:"dark",onConfirm:async()=>{try{await pe({id:a}),d.lists.splice(e,1)}catch(p){ne.msgError(p)}}})},b=m(),x=m(!1),q=async a=>{var e;x.value=!0,await P(),(e=b.value)==null||e.open(a)};return g(),(a,e)=>{const p=X,K=ee,j=se,G=te,H=ae,M=ie,z=re,F=oe,O=ve;return o(_)?(l(),T(_e,{key:1,ref_key:"createPanelRef",ref:k,onBack:L},null,512)):(l(),i("div",xe,[t("div",he,[n(H,null,{default:c(()=>[t("div",ge,[t("div",ke,[n(K,{modelValue:o(f).name,"onUpdate:modelValue":e[1]||(e[1]=s=>o(f).name=s),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:e[2]||(e[2]=s=>o(u)()),onKeydown:e[3]||(e[3]=J(s=>o(u)(),["enter"]))},{append:c(()=>[n(p,{text:"",onClick:e[0]||(e[0]=s=>o(u)())},{default:c(()=>[...e[7]||(e[7]=[v(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),n(p,{type:"primary",class:"!rounded-full !h-10 !px-4",onClick:e[4]||(e[4]=s=>y())},{default:c(()=>[n(j,{name:"local-icon-add_circle",color:"#ffffff"}),e[8]||(e[8]=t("span",{class:"ml-2"},"创建批量数字人任务",-1))]),_:1}),t("div",null,[n(G,{content:"刷新"},{default:c(()=>[n(p,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:e[5]||(e[5]=s=>o(u)())})]),_:1})])])])]),_:1})]),C((l(),i("div",{class:"grow min-h-0 overflow-y-auto flex flex-col dynamic-scroller","infinite-scroll-immediate":!1,"infinite-scroll-disabled":!o(d).isLoad,"infinite-scroll-distance":10},[C((l(),i("div",be,[o(d).lists.length?(l(),i("div",we,[t("div",Ee,[(l(!0),i($,null,Q(o(d).lists,(s,w)=>(l(),i("div",{class:R(["flex gap-x-4 h-[222px] relative overflow-hidden bg-app-bg-3 border border-app-border-2 rounded-xl p-4",{"cursor-pointer":s.status==0}]),key:w,onClick:E=>D(s)},[t("div",{class:"absolute right-2 top-2 w-6 h-6",onClick:I(E=>N(s.id,w),["stop"])},[n(M,{theme:o(W).DARK},null,8,["theme"])],8,$e),t("div",Re,[n(z,{src:s.pic,class:"w-full h-full",fit:"cover"},{error:c(()=>[...e[9]||(e[9]=[t("div",{class:"w-full h-full flex items-center justify-center text-white card-gradient"}," 暂无封面 ",-1)])]),_:1},8,["src"])]),t("div",Ie,[t("div",Te,[v(r(s.name),1),s.automatic_clip==1?(l(),i($,{key:0},[v("（AI剪辑）")],64)):h("",!0)]),t("div",Ve,[t("span",Pe,"生成状态："+r(s.success_num||0)+"/"+r(s.video_count||1),1),t("span",{class:R([[3,5].includes(s.status)?"text-[#3BB840]":"text-primary"])},r(S[s.status]),3)]),t("div",Be,[e[10]||(e[10]=t("span",null,"生成视频：",-1)),t("span",null,"成功"+r(s.success_num||0),1),t("span",null,"失败"+r(s.error_num||0),1)]),t("div",Se,"任务创建："+r(s.create_time),1),t("div",Le,"最新提交："+r(s.latest_submission_time),1),t("div",Ae,[n(p,{class:"!h-10 w-[126px] !border-app-border-2",color:"#1f1f1f",onClick:I(E=>q(s.id),["stop"])},{default:c(()=>[...e[11]||(e[11]=[v("查看视频",-1)])]),_:1},8,["onClick"])])])],10,Ce))),128))]),o(d).isLoad?h("",!0):(l(),i("div",De,"暂无更多了~"))])):(l(),i("div",Ne,[n(ue,{"btn-text":"创建批量数字人任务",msg:"快去发布你的专属数字人吧","custom-click":()=>y()},null,8,["custom-click"])]))])),[[F,o(d).loading]])],8,ye)),[[O,A]]),o(x)?(l(),T(me,{key:0,ref_key:"previewVideoResultRef",ref:b,onClose:e[6]||(e[6]=s=>x.value=!1)},null,512)):h("",!0)]))}}});export{We as _};
