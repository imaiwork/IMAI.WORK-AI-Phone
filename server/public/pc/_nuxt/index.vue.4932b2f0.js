import{d as Y,bP as q,aG as z,r as _,o as J,Z as o,k as l,l as i,m as s,q as n,s as d,v as y,$ as W,aI as Z,J as S,K as V,t as b,L as B,bM as H,I as D,ai as $,bO as Q,G as F,ay as X,y as ee,av as se,ax as te,cY as oe,u as le}from"./entry.563c232b.js";import{E as ne}from"./index.9ed38239.js";import{_ as ae}from"./index.vue.d663f363.js";import{E as ie}from"./el-empty.92ad44f2.js";/* empty css                     */import{u as re}from"./usePaging.4417e13f.js";import{_ as ce}from"./flow_title_img.b33c9278.js";import{aj as de,aG as me}from"./person_wechat.703f63bb.js";import{_ as fe}from"./flow-add.vue.c409dc03.js";import pe from"./create-panel.116f43b1.js";import{SidebarTypeEnum as L}from"./index.a1206616.js";const ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAACVBMVEVHcEwkVPMjU/TCW17aAAAAAnRSTlMAgJsrThgAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAA5SURBVEhLY2AYBaMhMBoCSCHAyAQBjGAxfDyYplEdNAwrUgN3VD2uxAtJrqSGz2jZMBoCoyEACwEA0fMDAfienuwAAAAASUVORK5CYII=",_e={key:0,class:"h-full flex flex-col bg-white rounded-xl"},Ae={class:"flex items-center justify-between p-4"},xe={class:"flex items-center gap-2"},ye={class:"grow min-h-0 flex flex-col"},ge={key:0,class:"grow min-h-0 py-2"},we={class:"flex flex-col gap-6 p-4"},ve={class:"flex items-center justify-between h-[56px]"},he={class:"flex items-center gap-4"},Ee={class:"text-lg font-bold"},ke={class:"grow min-h-0"},Ce={class:"h-full flex items-center whitespace-nowrap overflow-x-auto px-6"},Se={class:"flex flex-col items-center gap-2"},Ve={class:"text-[#5E656E]"},be={key:0,class:"flex-1 flex justify-center"},Be={class:"flex justify-end p-4"},De={key:1,class:"h-full flex items-center justify-center"},Oe=Y({__name:"index",setup($e){const{query:g}=q(),M=le(),f=z({flow_name:""}),{pager:r,getLists:w,resetPage:m,resetParams:Fe}=re({fetchFun:de,params:f,isScroll:!0}),R=()=>{f.flow_name="",m()},A=_(!1),v=_(),h=_(),p=_(g.is_create=="1"&&parseInt(g.type)==L.FLOW),j=async()=>{var a;A.value=!0,await $(),(a=v.value)==null||a.open()},I=async a=>{var e;p.value=!0,await $(),Q({id:a,is_create:"1"}),(e=h.value)==null||e.getDetail(a)},E=async(a,e)=>{await M.$confirm({message:"确定删除该客户流程吗？",onConfirm:async()=>{try{await me({id:a});const c=r.lists.findIndex(u=>u.id==a);r.lists.splice(c,1),F.msgSuccess("删除成功"),e&&k()}catch(c){F.msgError(c)}}})},k=()=>{p.value=!1,window.history.replaceState("","",`?type=${L.FLOW}`),m()};return J(()=>{p.value||w()}),(a,e)=>{const c=X,u=ee,P=se,N=te,U=ne,G=ae,T=ie,K=oe;return o(p)?(l(),D(pe,{key:1,ref_key:"createPanelRef",ref:h,onDelete:E,onBack:k},null,512)):(l(),i("div",_e,[s("div",Ae,[n(c,{type:"primary",onClick:j},{default:d(()=>[...e[5]||(e[5]=[y("新建客户流程",-1)])]),_:1}),s("div",xe,[n(P,{modelValue:o(f).flow_name,"onUpdate:modelValue":e[1]||(e[1]=t=>o(f).flow_name=t),class:"!w-[240px]",clearable:"",placeholder:"请输入流程名称",onClear:R,onKeyup:e[2]||(e[2]=W(t=>o(m)(),["enter"]))},{append:d(()=>[n(c,{onClick:e[0]||(e[0]=t=>o(m)())},{default:d(()=>[n(u,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])]),Z((l(),i("div",ye,[o(r).lists.length>0?(l(),i("div",ge,[n(U,null,{default:d(()=>[s("div",we,[(l(!0),i(S,null,V(o(r).lists,(t,O)=>(l(),i("div",{key:O,class:"h-[160px] flex flex-col rounded-xl shadow-lighter px-4"},[s("div",ve,[s("div",he,[e[6]||(e[6]=s("img",{src:ce,class:"w-6 h-6"},null,-1)),s("div",Ee,b(t.flow_name),1)]),s("div",null,[n(c,{type:"primary",size:"small",onClick:x=>I(t.id)},{default:d(()=>[...e[7]||(e[7]=[y("编辑",-1)])]),_:1},8,["onClick"]),n(c,{type:"danger",size:"small",onClick:x=>E(t.id)},{default:d(()=>[...e[8]||(e[8]=[y("删除",-1)])]),_:1},8,["onClick"])])]),n(N,{class:"!m-0 border-[#E7E7E7]"}),s("div",ke,[s("div",Ce,[(l(!0),i(S,null,V(t.key_stages,(x,C)=>(l(),i("div",{key:C,class:"flex items-center gap-2 w-[200px] flex-shrink-0"},[s("div",Se,[n(u,{name:"el-icon-LocationFilled",color:"var(--color-primary)",size:20}),s("span",Ve,b(x.sub_stage_name),1)]),C<t.key_stages.length-1?(l(),i("div",be,[...e[9]||(e[9]=[s("img",{src:ue,class:"h-6"},null,-1)])])):B("",!0)]))),128))])])]))),128))])]),_:1}),s("div",Be,[n(G,{modelValue:o(r),"onUpdate:modelValue":e[3]||(e[3]=t=>H(r)?r.value=t:null),onChange:o(w)},null,8,["modelValue","onChange"])])])):(l(),i("div",De,[n(T,{description:"暂无数据"})]))])),[[K,o(r).loading]]),o(A)?(l(),D(fe,{key:0,ref_key:"flowAddRef",ref:v,onClose:e[4]||(e[4]=t=>A.value=!1),onSuccess:o(m)},null,8,["onSuccess"])):B("",!0)]))}}});export{Oe as _};
