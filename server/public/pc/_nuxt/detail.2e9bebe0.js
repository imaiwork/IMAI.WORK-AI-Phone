import{d as O,bP as Z,r as g,aG as H,c as E,D as Q,k as l,l as a,m as t,q as r,t as m,Z as s,I as C,s as h,L as f,$ as W,aI as X,J as I,K as ee,a0 as te,Y as se,v as $,bM as oe,ai as V,G as B,y as ne,ay as le,av as ie,cY as ae,u as re,_ as de}from"./entry.563c232b.js";import{E as ce}from"./index.9ed38239.js";import{E as ue}from"./el-empty.92ad44f2.js";import{_ as pe}from"./index.vue.d663f363.js";/* empty css                     */import{u as me}from"./usePaging.4417e13f.js";import{c as fe,w as xe,x as ve}from"./knowledge_base.519704cc.js";import{KnTypeEnum as _e}from"./index.5bd136e1.js";import ye from"./subsection-edit.92b985a0.js";import"./index.b6452ee7.js";import"./index.941331c1.js";import"./strings.0730af8d.js";import"./_baseIteratee.4589a236.js";import"./toNumber.590accd9.js";import"./clamp.43011008.js";import"./index.be457d98.js";import"./index.vue.96af9406.js";import"./el-image.3350cb2d.js";import"./el-image-viewer.164b39e3.js";import"./throttle.4081a158.js";import"./debounce.cf3b8bee.js";import"./index.875ea2c9.js";import"./index.aabb37e8.js";import"./index.477a7d18.js";import"./cloneDeep.3c027ec4.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./index.vue.ff9e1552.js";const ke={class:"h-full bg-white rounded-[20px] flex flex-col"},ge={class:"flex-shrink-0 h-[88px] flex items-center justify-between gap-x-2 px-[30px] border-b border-[#0000000d]"},he={class:"grow min-h-0 flex flex-col"},be={class:"flex-shrink-0 h-[62px] flex items-center justify-between gap-x-2 px-[30px] border-b border-[#0000000d]"},we={class:"flex items-center gap-x-2"},Ce={class:"grow min-h-0"},Ee={class:"px-3"},Ie=["onClick"],$e={key:0,class:"mt-[3px]"},Ve={class:"flex-1"},Be={class:"flex justify-between items-center"},De=["onClick"],Fe={class:"mt-[10px] flex text-[11px]"},Le={class:"text-[#00000080]"},je={key:0,class:"mt-[10px] flex text-[11px]"},Se={class:"text-[#00000080]"},qe={key:1,class:"flex items-center justify-center h-full"},Ke={class:"flex flex-col gap-y-2 px-[30px] justify-center items-center my-4"},Ne={class:"relative z-[8887]"},Re=O({__name:"detail",props:{knType:{},knId:{}},emits:["back"],setup(D,{emit:F}){const _=D,L=F,b=Z(),j=re(),y=g(!1),x=g(),i=g([]),v=H({keywords:""}),k=g(b.query.file_id),S=E(()=>b.query.file_name),u=E(()=>_.knType==_e.RAG),{pager:d,getLists:p}=me({fetchFun:o=>u.value?fe({...o,keywords:v.keywords,id:k.value}):xe({...o,kb_id:_.knId,fd_id:k.value,keyword:v.keywords}),params:v}),q=async()=>{var o,e;y.value=!0,await V(),(o=x.value)==null||o.open(),(e=x.value)==null||e.setFormData({fd_id:k.value,kb_id:_.knId})},K=async o=>{var e,c;y.value=!0,await V(),(e=x.value)==null||e.open("edit"),(c=x.value)==null||c.getDetail(o.uuid)},N=o=>i.value.includes(o),R=o=>{const e=i.value.indexOf(o);e>-1?i.value.splice(e,1):i.value.push(o)},A=()=>{j.$confirm({message:"确定删除所选分段吗？",onConfirm:async()=>{try{await ve({kb_id:_.knId,uuids:i.value}),B.msgSuccess("删除成功"),i.value=[],p()}catch(o){B.msgError(o)}}})},T=()=>{i.value=[]};return Q(()=>b.query.file_id,o=>{k.value=o,o&&p()},{immediate:!0}),(o,e)=>{const c=ne,w=le,z=ie,G=ce,P=ue,M=pe,U=ae;return l(),a(I,null,[t("div",ke,[t("div",ge,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=n=>L("back"))},[r(c,{name:"el-icon-ArrowLeft"}),t("div",null,m(s(S)),1)]),s(u)?f("",!0):(l(),C(w,{key:0,type:"primary",class:"!rounded-full !h-10",onClick:q},{default:h(()=>[r(c,{name:"local-icon-add_circle"}),e[7]||(e[7]=t("span",{class:"ml-2"},"添加分段",-1))]),_:1}))]),t("div",he,[t("div",be,[t("div",we,[e[8]||(e[8]=t("span",{class:"inline-block w-[6px] h-[6px] rounded-full bg-primary"},null,-1)),t("span",null,m(s(d).count)+"分段",1)]),r(z,{modelValue:s(v).keywords,"onUpdate:modelValue":e[1]||(e[1]=n=>s(v).keywords=n),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入关键词",clearable:"",onClear:e[2]||(e[2]=n=>s(p)()),onKeydown:e[3]||(e[3]=W(n=>s(p)(),["enter"]))},null,8,["modelValue"])]),X((l(),a("div",Ce,[s(d).lists.length?(l(),C(G,{key:0},{default:h(()=>[t("div",Ee,[(l(!0),a(I,null,ee(s(d).lists,(n,Y)=>(l(),a("div",{key:n.id,class:"flex gap-x-2 border-b border-[#0000000d] py-[15px] px-[30px] hover:bg-[#f6f6f6] cursor-pointer",onClick:J=>R(n.uuid)},[s(u)?f("",!0):(l(),a("div",$e,[r(c,{name:"local-icon-success_fill",color:N(n.uuid)?"var(--color-primary)":"#0000000d"},null,8,["color"])])),t("div",Ve,[t("div",Be,[t("div",null,"分段-"+m(Y+1),1),s(u)?f("",!0):(l(),a("div",{key:0,class:"w-5 h-5 rounded-md bg-[#0000000d] flex items-center justify-center cursor-pointer",onClick:te(J=>K(n),["stop"])},[r(c,{name:"local-icon-edit3",size:14})],8,De))]),t("div",Fe,[e[9]||(e[9]=t("div",{class:"flex-shrink-0"},"文档内容：",-1)),t("div",Le,m(n.content||n.question),1)]),s(u)?f("",!0):(l(),a("div",je,[e[10]||(e[10]=t("div",{class:"flex-shrink-0"},"补充内容：",-1)),t("div",Se,m(n.answer||"-"),1)]))])],8,Ie))),128))])]),_:1})):(l(),a("div",qe,[r(P,{description:"暂无分段"})]))])),[[U,s(d).loading]])]),t("div",Ke,[s(u)?f("",!0):(l(),a("div",{key:0,class:se(["w-[428px] h-[50px] bg-[#f6f6f6] rounded-md border border-[#efefef] flex justify-between items-center px-[14px] transition-all duration-300",[s(i).length>0?"opacity-100 translate-y-[0]":"opacity-0 translate-y-[100%]"]])},[t("div",null,"已选择"+m(s(i).length)+"项",1),t("div",null,[r(w,{color:"#FF3C26",onClick:A},{default:h(()=>[...e[11]||(e[11]=[$("删除",-1)])]),_:1}),r(w,{onClick:T},{default:h(()=>[...e[12]||(e[12]=[$("取消",-1)])]),_:1})])],2)),t("div",Ne,[r(M,{modelValue:s(d),"onUpdate:modelValue":e[4]||(e[4]=n=>oe(d)?d.value=n:null),layout:"prev, pager, next",onChange:s(p)},null,8,["modelValue","onChange"])])])]),s(y)?(l(),C(ye,{key:0,ref_key:"subsectionEditRef",ref:x,onClose:e[5]||(e[5]=n=>y.value=!1),onSuccess:e[6]||(e[6]=n=>s(p)())},null,512)):f("",!0)],64)}}});const ft=de(Re,[["__scopeId","data-v-806e3a81"]]);export{ft as default};
