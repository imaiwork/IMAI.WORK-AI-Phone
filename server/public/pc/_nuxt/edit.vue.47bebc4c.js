import{d as X,au as Z,c as f,A as $,r as _,aG as H,cy as Q,k as r,I as b,s as n,m as u,t as Y,Z as t,q as s,l as m,K as S,J as D,v as I,bM as ee,G as oe,y as le,aw as te,av as ae,az as se,ay as ne}from"./entry.45b56a4a.js";import{E as re}from"./el-image.c740ce69.js";import{_ as ie}from"./index.26ec0fac.js";import{E as de,a as ue}from"./index.def52f2a.js";import{E as me}from"./index.82050671.js";import"./el-image-viewer.68e4a550.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import{u as ce}from"./useDictOptions.f1ba5a71.js";import{V as pe,W as fe,X as _e}from"./person_wechat.703f63bb.js";import{k as be}from"./knowledge_base.519704cc.js";const ge={class:"font-bold text-xl text-black"},ke={class:"pb-10"},ye={class:""},ve={class:"h-20 w-20 bg-[#F4F4F4] p-1 rounded-lg hover:border-primary border border-dashed border-[transparent]"},xe={key:0,class:"flex flex-col justify-center items-center h-full w-full"},he={key:1,class:"flex flex-col justify-center items-center h-full w-full"},we={class:"absolute bottom-0 left-0 right-0 p-3 bg-white"},Ve={class:"flex justify-end mt-3"},Me=X({__name:"edit",emits:["success","close"],setup(Ee,{expose:L,emit:R}){const g=R,k=Z(),q=f(()=>k.getAiModelConfig.channel||[]),y=f(()=>{const{shop_logo:a}=k.getWebsiteConfig||{};return a}),B=$(),i=_(!1),v=_(),o=H({id:"",logo:y.value,name:"",description:"",company_background:"",index_id:"",rerank_min_score:"",model:""}),U={logo:[{required:!0,message:"请上传机器人logo"}],name:[{required:!0,message:"请输入机器人名称"}],description:[{required:!0,message:"请输入机器人角色设定"}],company_background:[{required:!0,message:"请输入您的企业背景信息"}],question:[{required:!0,message:"请输入提问案例"}],answer:[{required:!0,message:"请输入回答格式"}]},x=_("add"),A=f(()=>x.value==="add"?"添加机器人":"编辑机器人"),{optionsData:h}=ce({knbLists:{api:be,params:{page_size:25e3},transformData:a=>a.lists}}),z=a=>{var e;o.rerank_min_score=(e=h.knbLists.find(c=>c.index_id===a))==null?void 0:e.rerank_min_score},j=a=>{const{data:{uri:e}}=a;o.logo=e},M=(a="add")=>{x.value=a,i.value=!0,o.logo=y.value},N=async()=>{await v.value.validate();try{o.id?await pe(o):await fe(o),i.value=!1,g("success")}catch(a){oe.msgError(a||"提交失败")}},w=()=>{i.value=!1,g("close")},{lockFn:O,isLock:W}=Q(N),G=async a=>{const e=await _e({id:a});V(e)},V=async a=>{for(const e in o)a[e]!=null&&a[e]!=null&&(o[e]=a[e])};return L({open:M,getDetail:G,setFormData:V}),(a,e)=>{const c=le,K=re,J=ie,d=te,p=ae,E=de,C=ue,P=se,F=ne,T=me;return r(),b(T,{modelValue:t(i),"onUpdate:modelValue":e[5]||(e[5]=l=>ee(i)?i.value=l:null),ref_key:"popupRef",ref:B,async:!0,size:"500px","confirm-button-text":"","cancel-button-text":"",onClose:w},{header:n(()=>[u("div",ge,Y(t(A)),1)]),default:n(()=>[u("div",ke,[s(P,{model:t(o),rules:U,ref_key:"formRef",ref:v,"label-position":"top"},{default:n(()=>[s(d,{label:"机器人logo",prop:"logo"},{default:n(()=>[u("div",ye,[s(J,{class:"w-full h-full",limit:1,"show-file-list":!1,"show-progress":"",onSuccess:j},{default:n(()=>[u("div",ve,[t(o).logo?(r(),m("div",he,[s(K,{src:t(o).logo},null,8,["src"])])):(r(),m("div",xe,[s(c,{name:"el-icon-CirclePlusFilled",color:"var(--color-primary)",size:18})]))])]),_:1})])]),_:1}),s(d,{label:"机器人名称",prop:"name"},{default:n(()=>[s(p,{modelValue:t(o).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(o).name=l),placeholder:"请输入机器人名称"},null,8,["modelValue"])]),_:1}),s(d,{label:"机器人角色设定",prop:"description"},{default:n(()=>[s(p,{modelValue:t(o).description,"onUpdate:modelValue":e[1]||(e[1]=l=>t(o).description=l),type:"textarea","show-word-limit":"",placeholder:"点击输入您要要设定的内容",maxlength:2e3,rows:6},null,8,["modelValue"])]),_:1}),s(d,{label:"您的企业背景信息",prop:"company_background"},{default:n(()=>[s(p,{modelValue:t(o).company_background,"onUpdate:modelValue":e[2]||(e[2]=l=>t(o).company_background=l),type:"textarea","show-word-limit":"",placeholder:"点击输入您的企业背景信息，机器人将会配合该信息进行回复",maxlength:2e3,rows:6},null,8,["modelValue"])]),_:1}),s(d,{label:"挂靠知识库",prop:"index_id"},{default:n(()=>[s(C,{modelValue:t(o).index_id,"onUpdate:modelValue":e[3]||(e[3]=l=>t(o).index_id=l),placeholder:"请选择挂靠知识库",clearable:"",onChange:z},{default:n(()=>[(r(!0),m(D,null,S(t(h).knbLists,l=>(r(),b(E,{key:l.id,label:l.name,value:l.index_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(d,{label:"AI模型",prop:"model"},{default:n(()=>[s(C,{modelValue:t(o).model,"onUpdate:modelValue":e[4]||(e[4]=l=>t(o).model=l),placeholder:"请选择AI模型",filterable:""},{default:n(()=>[(r(!0),m(D,null,S(t(q),l=>(r(),b(E,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),u("div",we,[u("div",Ve,[s(F,{onClick:w},{default:n(()=>[...e[6]||(e[6]=[I("取消",-1)])]),_:1}),s(F,{type:"primary",loading:t(W),onClick:t(O)},{default:n(()=>[...e[7]||(e[7]=[I(" 确定 ",-1)])]),_:1},8,["loading","onClick"])])])]),_:1},8,["modelValue"])}}});export{Me as _};
