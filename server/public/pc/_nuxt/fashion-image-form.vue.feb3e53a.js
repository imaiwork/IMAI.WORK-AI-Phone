import{_ as ae}from"./index.vue.96af9406.js";import{d as ne,aG as re,r as h,aW as ie,G as v,k as f,l as _,m as o,q as l,s as n,Z as r,J as g,a0 as F,t as ce,K as M,L as b,I as U,v as C,Y as fe,u as pe,y as ue,aw as me,ay as de,az as _e}from"./entry.563c232b.js";import{_ as ge}from"./index.875ea2c9.js";import{E as he,a as ve}from"./el-tabs.a314917a.js";import{E as xe}from"./el-image.3350cb2d.js";import{E as we}from"./index.9ed38239.js";import{E as ye}from"./el-image-viewer.164b39e3.js";/* empty css                     */import{u as Ee}from"./useDictOptions.c0bd6b2d.js";import{a as be,c as Ce,d as ke}from"./drawing.7058a163.js";import{FashionImageTypeEnum as p}from"./index.fb0aa6a9.js";import{_ as V}from"./case-image-v2.vue.eb79772c.js";const Se={class:"h-full flex flex-col"},Ie={class:"h-[164px] w-full flex flex-col items-center justify-center leading-[1.5] relative"},Le=["src"],Re=["onClick"],Pe={class:"type-tabs"},De={class:"grow min-h-0"},Te={class:"p-4"},ze={class:"w-full"},Oe={class:"w-full"},Fe={class:"w-full"},Me={class:"flex justify-between gap-2"},Ue={class:"w-full h-[420px]"},Ve={class:"grid grid-cols-3 gap-2"},We={class:"h-[127px] w-full flex-col rounded-md flex items-center justify-center bg-app-bg-3"},$e=["onClick"],je={class:"absolute top-0 left-0 w-full h-full invisible group-hover:visible bg-[var(--el-overlay-color-lighter)] flex items-center justify-center"},Be=["onClick"],He={class:"fixed right-4 top-[93px] z-[22]"},W=".jpg,.jpeg,.png",$=10,os=ne({__name:"fashion-image-form",emits:["update:formData","generatePrompt"],setup(Ne,{expose:j,emit:B}){const H=B,k=[{label:"上下装",value:p.UPPER_LOWER_CLOTHES},{label:"连衣裙",value:p.DRESS}],e=re({type:p.UPPER_LOWER_CLOTHES,dress:"",upper_clothes:"",lower_clothes:"",persons:[],img_count:0}),S=[1/3,3],I=[4096,4096],N=(t,s)=>{const a=t.data.uri;if(e.type==p.DRESS){e.upper_clothes=a,e.lower_clothes=e.upper_clothes;return}e[s]=a},{optionsData:m}=Ee({modelList:{api:be,params:{case_type:4,page_size:999},transformData:t=>t.lists.map(s=>({...s,result_image:s.result_image}))}}),G=t=>{const s=t.data.uri;m.modelList.unshift({result_image:s}),Ce({result_image:s})},q=t=>{e.persons.includes(t)?e.persons=[]:e.persons=[t],e.img_count=e.persons.length},A=t=>{pe().$confirm({title:"提示",message:"确定删除该模特吗？",theme:"dark",onConfirm:async()=>{const s=m.modelList[t];if(s.user_id)try{await ke({id:s.id}),v.msgSuccess("删除成功"),m.modelList.splice(t,1),e.persons.splice(t,1)}catch{v.msgError("删除失败")}}})},w=h(!1),L=h(0),R=h([]),J=t=>{w.value=!0,L.value=t,R.value=m.modelList.map(s=>s.result_image)},P=h(),K=()=>{P.value.open()},Y=t=>{const{data:s}=t,a=s.result_image,c=m.modelList.find(d=>d.result_image==a);if(c){e.persons=[a],e.persons.includes(a)||e.persons.push(a);return}m.modelList.unshift(c),e.persons=[a]},D=h(),Z=()=>{D.value.open()},Q=t=>{var c,d;const{case_type:s,data:a}=t;s==0&&(e.upper_clothes=(c=a.params)==null?void 0:c.images[0],e.lower_clothes=(d=a.params)==null?void 0:d.images[1],e.type=p.UPPER_LOWER_CLOTHES),s==1&&(e.dress=a.result_image,e.upper_clothes=e.dress,e.lower_clothes=e.dress,e.type=p.DRESS)};let T;const X={setup(t,{slots:s}){return()=>{T=s.default}}},y=t=>T(t);return ie(()=>{H("update:formData",e)}),j({getFormData:()=>{var t;return{params:{upper_clothes:e.upper_clothes,lower_clothes:e.lower_clothes,persons:e.persons,img_count:e.persons.length},type:e.type,type_name:(t=k.find(s=>s.value==e.type))==null?void 0:t.label}},validateForm:()=>new Promise((t,s)=>{if(!e.upper_clothes){v.msgWarning("请上传上衣"),s(!1);return}if(e.type==p.UPPER_LOWER_CLOTHES&&!e.lower_clothes){v.msgWarning("请上传下装"),s(!1);return}if(e.persons.length==0){v.msgWarning("请选择模特"),s(!1);return}t(!0)})}),(t,s)=>{const a=ae,c=ue,d=ge,ee=he,se=ve,x=me,E=de,te=xe,z=we,oe=_e,le=ye;return f(),_(g,null,[o("div",Se,[l(X,null,{default:n(({type:i})=>[l(d,{class:"w-full h-full","show-progress":"",drag:"","show-file-list":!1,accept:W,"ratio-size":[S[0],S[1]],"image-resolution":[I[0],I[1]],"max-size":$,onSuccess:u=>N(u,i)},{default:n(()=>[o("div",Ie,[r(e)[i]?(f(),_(g,{key:0},[o("img",{src:r(e)[i],class:"w-full h-full object-contain"},null,8,Le),o("div",{class:"absolute top-1 right-1 cursor-pointer w-6 h-6",onClick:F(u=>r(e)[i]="",["stop"])},[l(a)],8,Re),s[2]||(s[2]=o("div",{class:"absolute bottom-3 cursor-pointer px-[10px] text-white rounded-full border border-[#ffffff1a] bg-[#ffffff4d] shadow-[0px_6px_12px_0px_rgba(0,0,0,0.24)] h-[28px] flex items-center justify-center"}," 更换图片 ",-1))],64)):(f(),_(g,{key:1},[l(c,{name:"local-icon-file_add",size:28,color:"#ffffff"}),s[3]||(s[3]=o("div",{class:"text-xs text-white mt-3"},"点此上传图片 支持拖拽上传",-1)),o("div",{class:"text-xs text-[#ffffff4d] mt-3 mx-[50px]"}," 单个文件不超过"+ce($)+"MB，（宽/高）范围：[1/3, 3]，请勿上传gif格式图片 ")],64))])]),_:2},1032,["ratio-size","image-resolution","onSuccess"])]),_:1}),o("div",Pe,[l(se,{modelValue:r(e).type,"onUpdate:modelValue":s[0]||(s[0]=i=>r(e).type=i)},{default:n(()=>[(f(),_(g,null,M(k,(i,u)=>l(ee,{name:i.value,label:i.label,key:u},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),o("div",De,[l(z,null,{default:n(()=>[o("div",Te,[l(oe,{model:r(e),"label-position":"top"},{default:n(()=>[r(e).type==r(p).UPPER_LOWER_CLOTHES?(f(),_(g,{key:0},[l(x,{label:"上衣部分"},{default:n(()=>[o("div",ze,[l(y,{type:"upper_clothes"})])]),_:1}),l(x,{label:"下装部分"},{default:n(()=>[o("div",Oe,[l(y,{type:"lower_clothes"})])]),_:1})],64)):b("",!0),r(e).type==r(p).DRESS?(f(),U(x,{key:1,label:"连衣裙部分"},{default:n(()=>[o("div",Fe,[l(y,{type:"upper_clothes"})])]),_:1})):b("",!0),l(x,null,{label:n(()=>[o("div",Me,[s[5]||(s[5]=o("div",null,[o("div",{class:"text-white"},"模特类型"),o("div",{class:"text-[#ffffff4d] text-[11px]"},"提示：上传模特请选择模特类型图片")],-1)),l(E,{type:"primary",size:"small",onClick:K},{default:n(()=>[...s[4]||(s[4]=[C("更多模特",-1)])]),_:1})])]),default:n(()=>[o("div",Ue,[l(z,null,{default:n(()=>[o("div",Ve,[l(d,{drag:"","show-progress":"","show-file-list":!1,accept:W,onSuccess:G},{default:n(()=>[o("div",We,[l(c,{name:"local-icon-file_add",size:28,color:"#ffffff"}),s[6]||(s[6]=o("span",{class:"mt-2 text-[11px] text-[#ffffff80]"},"点击添加模特",-1))])]),_:1}),(f(!0),_(g,null,M(r(m).modelList,(i,u)=>(f(),_("div",{key:u,class:fe(["relative h-[130px] w-full flex-col rounded-md flex items-center justify-center bg-app-bg-3 overflow-hidden border-[2px] border-[#ffffff33] cursor-pointer group",r(e).persons.includes(i.result_image)?"border-primary":""]),onClick:O=>q(i.result_image)},[l(te,{src:i.result_image,class:"w-full h-full",fit:"cover"},null,8,["src"]),o("div",je,[o("div",{class:"cursor-pointer absolute top-0 right-0",onClick:F(O=>J(u),["stop"])},[l(c,{name:"local-icon-fullscreen",size:32})],8,Be),l(E,{color:"#FF3C26",class:"w-[68px] !h-7 !rounded-full",onClick:O=>A(u)},{default:n(()=>[...s[7]||(s[7]=[C("删除",-1)])]),_:1},8,["onClick"])])],10,$e))),128))])]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})])]),o("div",He,[l(E,{type:"primary",class:"!rounded-full w-[100px] !h-10",onClick:Z},{default:n(()=>[...s[8]||(s[8]=[C(" 优秀案例 ",-1)])]),_:1})]),r(w)?(f(),U(le,{key:0,"initial-index":r(L),"url-list":r(R),onClose:s[1]||(s[1]=i=>w.value=!1)},null,8,["initial-index","url-list"])):b("",!0),l(V,{ref_key:"caseImageRef",ref:D,type:"fashion",onChoose:Q},null,512),l(V,{ref_key:"modelImageRef",ref:P,type:"model",onChoose:Y},null,512)],64)}}});export{os as _};
