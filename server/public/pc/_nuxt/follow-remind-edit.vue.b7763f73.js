import{E as C,a as I}from"./index.899f58ef.js";import{d as j,r as i,aG as U,bC as H,cy as N,G as g,bK as R,k as S,I as $,s as m,q as a,Z as o,m as p,t as q,az as z,cX as A,aw as B,av as G}from"./entry.556496e9.js";import{E as L}from"./el-input-number.fadfd561.js";import{E as O}from"./el-time-picker.6d9d3c3a.js";/* empty css                  *//* empty css               *//* empty css                     */import{aC as P,aD as T}from"./person_wechat.703f63bb.js";const K={class:"flex items-center gap-x-2 text-xs"},te=j({__name:"follow-remind-edit",emits:["close","success"],setup(M,{expose:E,emit:w}){const c=w,f=i("add"),_=i(),t=U({flow_id:"",stage_id:"",remind_id:"",status:0,judgment:0,send_time:H().add(10,"minutes").format("HH:mm:ss"),content:""}),V={send_time:[{required:!0,message:"请选择提醒时间",trigger:"blur"},{validator:(l,e,s)=>{const r=new Date,u=new Date(`${r.getFullYear()}-${r.getMonth()+1}-${r.getDate()} ${e}`);t.judgment==0&&u<r?s(new Error("提醒时间不能小于当前时间")):s()}}],content:[{required:!0,message:"请输入提醒内容",trigger:"blur"}]},d=i(),{lockFn:v,isLock:b}=N(async()=>{var l,e;await((l=_.value)==null?void 0:l.validate());try{t.remind_id?await P(t):await T(t),(e=d.value)==null||e.close(),c("success"),g.msgSuccess("操作成功")}catch(s){g.msgError(s)}}),x=l=>{var e;f.value=l,(e=d.value)==null||e.open()},k=()=>{c("close")};return E({open:x,setFormData:l=>{R(l,t)}}),(l,e)=>{const s=C,r=I,u=B,F=L,y=O,D=G;return S(),$(A,{ref_key:"popupRef",ref:d,title:o(f)==="add"?"新建跟进提醒":"编辑跟进提醒",width:"610px",async:"","confirm-loading":o(b),onClose:k,onConfirm:o(v)},{default:m(()=>[a(o(z),{ref_key:"formRef",ref:_,model:o(t),rules:V,"label-position":"top"},{default:m(()=>[a(u,{label:"提醒规则",prop:"status"},{default:m(()=>[a(r,{modelValue:o(t).status,"onUpdate:modelValue":e[0]||(e[0]=n=>o(t).status=n),placeholder:"请选择提醒规则"},{default:m(()=>[a(s,{label:"以停留标签天数为判定规则",value:0}),a(s,{label:"以沉默天数为判定规则",value:1})]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"时间规则",prop:"send_time"},{default:m(()=>[p("div",K,[p("span",null,q(o(t).status==0?"停留超过":"沉默超过"),1),a(F,{modelValue:o(t).judgment,"onUpdate:modelValue":e[1]||(e[1]=n=>o(t).judgment=n),size:"small"},null,8,["modelValue"]),e[4]||(e[4]=p("span",null,"天后，次日",-1)),a(y,{modelValue:o(t).send_time,"onUpdate:modelValue":e[2]||(e[2]=n=>o(t).send_time=n),placeholder:"请选择提醒时间",size:"small",class:"!w-[150px]","value-format":"HH:mm:ss"},null,8,["modelValue"])])]),_:1}),a(u,{label:"发送内容",prop:"content"},{default:m(()=>[a(D,{modelValue:o(t).content,"onUpdate:modelValue":e[3]||(e[3]=n=>o(t).content=n),placeholder:"请输入提醒内容",type:"textarea",class:"w-full",rows:5},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirm-loading","onConfirm"])}}});export{te as _};
