import{d as V,bP as S,a as T,z as A,aH as N,c as f,aG as q,A as D,cy as K,D as L,k as x,l as y,m as t,q as c,s as k,Z as s,bM as G,v,J as U,t as $,L as j,dv as I,c_ as P,c$ as z,G as H,y as J,ay as M}from"./entry.8705b591.js";import{E as O}from"./index.d5b2ab73.js";/* empty css                     */import{d as W,e as Z}from"./knowledge_base.519704cc.js";import{KnTypeEnum as Q}from"./index.5bd136e1.js";import{B as X,K as Y}from"./base-form.1d6e249e.js";const ee={class:"p-4 h-full"},te={class:"h-full flex flex-col bg-white rounded-xl"},se={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#0000000d]"},oe={class:"grow min-h-0 mt-4 flex flex-col w-[456px] mx-auto"},ae={class:"flex-shrink min-h-0 mt-[23px]"},ne={class:"px-2"},re={class:"flex justify-center my-[30px]"},fe=V({__name:"create-panel",emits:["success","back"],setup(le,{emit:b}){const g=b,i=S(),w=T(),_=A(),{getTokenByScene:h}=_,{userTokens:E}=N(_),d=f(()=>{var o;return(o=h(I.KNOWLEDGE_CREATE))==null?void 0:o.score}),m=f(()=>a.type==Q.RAG),a=q({name:"",description:"",cover:"",type:i.query.type}),p=D(),B=async()=>{await p.value.validateForm();try{const{name:o,description:e,cover:l}=a;let r=l;if(!l){const u=await P(Y,"kn_default_cover.png");r=(await z({file:u})).uri}const n=m.value?await W({name:o,description:e,image:r}):await Z({name:o,intro:e,image:r,documents_model_id:2,documents_model_sub_id:2,embedding_model_id:3,embedding_model_sub_id:3});w.replace({path:`/knowledge_base/detail/${n.id}`,query:{kn_type:a.type,index_id:n.index_id,category_id:n.category_id,kn_name:n.name}})}catch(o){H.msgError(o||"操作失败")}},R=()=>{g("back")},{lockFn:C,isLock:F}=K(B);return L(()=>i.query,()=>{a.type=i.query.type}),(o,e)=>{const l=J,r=O,n=M;return x(),y("div",ee,[t("div",te,[t("div",se,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:R},[c(l,{name:"el-icon-ArrowLeft"}),e[1]||(e[1]=t("div",null,"返回上一步",-1))])]),t("div",oe,[e[3]||(e[3]=t("div",{class:"text-[20px] font-bold mt-6"},"创建新的知识库",-1)),t("div",ae,[c(r,null,{default:k(()=>[t("div",ne,[c(X,{ref_key:"baseFormRef",ref:p,modelValue:s(a),"onUpdate:modelValue":e[0]||(e[0]=u=>G(a)?a.value=u:null)},null,8,["modelValue"])])]),_:1})]),t("div",re,[c(n,{type:"primary",class:"!h-[50px] !rounded-full w-[318px]",loading:s(F),disabled:s(E)<s(d)&&s(m),onClick:s(C)},{default:k(()=>[e[2]||(e[2]=v(" 创建知识库 ",-1)),s(d)&&s(m)?(x(),y(U,{key:0},[v("("+$(s(d))+"算力)",1)],64)):j("",!0)]),_:1},8,["loading","disabled","onClick"])])])])])}}});export{fe as _};
