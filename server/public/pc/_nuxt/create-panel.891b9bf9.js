import{d as K,z as X,c as D,r as u,dH as q,aG as A,o as F,bb as Y,k as m,l as w,m as n,q as i,s as f,v as h,Z as s,J as I,L as k,I as Z,cZ as z,aI as J,t as M,dv as Q,G as d,dO as B,ai as ee,y as te,ay as oe,av as se,cX as ne,_ as ae}from"./entry.8705b591.js";import{_ as re}from"./index.vue.3f013733.js";import{f as le,u as ie,h as ce,i as de}from"./matrix.418b34fe.js";import{_ as C}from"./copywriting-card.vue.4a702175.js";import"./index.d5b2ab73.js";/* empty css                     */const pe={class:"h-full bg-app-bg-2 rounded-[20px] overflow-y-auto dynamic-scroller"},ue={class:"h-full flex flex-col min-w-[1000px]"},me={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},fe={class:"flex items-center gap-1"},_e={class:"grow min-h-0 flex flex-col mx-auto p-5"},ye={class:"flex justify-end items-center gap-x-2 flex-shrink-0"},ge={class:"grow min-h-0 flex justify-center gap-x-[18px] mt-5"},ve={class:"content-item"},xe={class:"content-item"},be={key:1,class:"content-item"},we={class:"-my-2"},he={class:"mt-[18px]"},ke={class:"mt-[18px]"},Ce=K({__name:"create-panel",props:{type:{}},emits:["back"],setup(U,{emit:L}){const N=U,T=L,_=X(),G=D(()=>{var t;return c.total_num*((t=_.getTokenByScene(Q.KEYWORD_TO_COPYWRITING))==null?void 0:t.score)}),y=u(!1),g=u(!1),V=q(),e=A({id:V.id||"",title:[],oral_copy:[],described:[],copywriting_type:N.type||Number(V.copywriting_type)}),c=A({keyword:"",total_num:1}),E=D(()=>{const t=o=>o.some(p=>{var a;return(a=p.content)==null?void 0:a.trim()});return e.copywriting_type===1?!t(e.title)||!t(e.described):e.copywriting_type===2?!t(e.oral_copy):!0}),O=async()=>{if(!e.id)return;const t=await le({id:e.id});e.title=t.title||[],e.described=t.described||[],e.oral_copy=t.oral_copy||[]},P=async()=>{if(E.value){d.msgWarning("请确保所有必填项都已填写内容");return}y.value=!0;try{const t=p=>{var a;return(a=p.content)==null?void 0:a.trim()},o={...e,type:B.XHS,title:e.title.filter(t),oral_copy:e.oral_copy.filter(t),described:e.described.filter(t)};e.id?await ie(o):await ce(o),d.msgSuccess("操作成功"),T("back")}catch(t){d.msgError(t)}finally{y.value=!1}},v=u(),x=u(!1),R=async()=>{var t;x.value=!0,await ee(),(t=v.value)==null||t.open()},S=()=>{var t;(t=v.value)==null||t.close()},W=async()=>{if(_.userTokens<=0){d.msgPowerInsufficient();return}if(!c.keyword.trim())return d.msgWarning("请输入您希望生成的主题内容");if(!c.total_num||c.total_num<1)return d.msgWarning("生成数量必须大于0");g.value=!0;try{const t=await de({...c,type:B.XHS,copywriting_type:e.copywriting_type,channel:2});if(!t)return d.msgError("生成失败！");const{described:o,oral_copy:p,title:a}=t;if(e.copywriting_type===1){const b=a.map(r=>(r.content=r.content.slice(0,20),r));e.title.push(...b),e.described.push(...o.map(r=>({content:r.content,topic:(r==null?void 0:r.topic)||[]})))}else e.copywriting_type===2&&e.oral_copy.push(...p);_.getUser(),d.msgSuccess("生成成功！"),S()}catch(t){d.msgError(t)}finally{g.value=!1}},j=()=>{T("back")};return F(()=>{e.id&&O()}),(t,o)=>{const p=te,a=oe,b=re,r=se,$=ne,H=Y("number-input");return m(),w(I,null,[n("div",pe,[n("div",ue,[n("div",me,[n("div",{class:"flex items-center gap-2 cursor-pointer",onClick:j},[i(p,{name:"el-icon-ArrowLeft",color:"#ffffff"}),o[6]||(o[6]=n("div",{class:"text-white"},"返回上一步",-1))]),n("div",fe,[i(a,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:s(y),disabled:s(E),onClick:P},{default:f(()=>[...o[7]||(o[7]=[h(" 保存 ",-1)])]),_:1},8,["loading","disabled"])])]),n("div",_e,[n("div",ye,[i(a,{class:"!rounded-full !h-10 w-[106px] !border-app-border-2",color:"#181818",onClick:R},{default:f(()=>[...o[8]||(o[8]=[h(" 智能生成 ",-1)])]),_:1})]),n("div",ge,[s(e).copywriting_type===1?(m(),w(I,{key:0},[n("div",ve,[i(C,{"model-value":s(e).title,"onUpdate:modelValue":o[0]||(o[0]=l=>s(e).title=l),type:1},null,8,["model-value"])]),n("div",xe,[i(C,{"model-value":s(e).described,"onUpdate:modelValue":o[1]||(o[1]=l=>s(e).described=l),type:2},null,8,["model-value"])])],64)):k("",!0),s(e).copywriting_type===2?(m(),w("div",be,[i(C,{"model-value":s(e).oral_copy,"onUpdate:modelValue":o[2]||(o[2]=l=>s(e).oral_copy=l),type:3,"show-topic":!1},null,8,["model-value"])])):k("",!0)])])])]),s(x)?(m(),Z($,{key:0,ref_key:"popupRef",ref:v,"cancel-button-text":"","confirm-button-text":"",style:{"background-color":"var(--app-bg-color-2)","box-shadow":"0px 0px 0px 1px var(--app-border-color-1)"},"show-close":!1,onClosed:o[5]||(o[5]=l=>x.value=!1)},{default:f(()=>[n("div",we,[n("div",{class:"w-6 h-6 absolute top-[18px] right-[18px] cursor-pointer",onClick:S},[i(b,{theme:s(z).DARK},null,8,["theme"])]),o[9]||(o[9]=n("div",{class:"text-white text-[15px] font-bold"},"智能生成",-1)),n("div",he,[i(r,{modelValue:s(c).keyword,"onUpdate:modelValue":o[3]||(o[3]=l=>s(c).keyword=l),placeholder:"您希望生成什么样的主题内容",class:"!h-11"},null,8,["modelValue"]),J(i(r,{modelValue:s(c).total_num,"onUpdate:modelValue":o[4]||(o[4]=l=>s(c).total_num=l),min:1,type:"number",placeholder:"您希望生成的数量",class:"!h-11 mt-2"},null,8,["modelValue"]),[[H,{decimal:0}]])]),n("div",ke,[i(a,{type:"primary",class:"!rounded-full !h-[50px] w-full",loading:s(g),onClick:W},{default:f(()=>[h(" 开始（消耗"+M(s(G))+"算力） ",1)]),_:1},8,["loading"])])])]),_:1},512)):k("",!0)],64)}}});const Ie=ae(Ce,[["__scopeId","data-v-cfe9e46f"]]);export{Ie as default};
