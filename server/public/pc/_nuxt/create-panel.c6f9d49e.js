import{d as we,z as ge,c as W,aG as Ve,bC as Ce,r as D,D as Ee,A as S,cy as De,G as p,dO as Be,bb as Ne,k as d,l as i,m as t,q as a,s as n,v as g,Z as l,J as v,K as y,I as b,t as f,Y as U,cZ as z,L as m,aI as q,a0 as $e,dv as Z,ai as T,y as Re,ay as Ae,av as Se,ba as Ue,d0 as Te,d1 as Oe,ax as Ie,_ as Pe}from"./entry.556496e9.js";import{E as Fe,a as je}from"./index.899f58ef.js";import{_ as Ge}from"./index.vue.83bf2a64.js";import{E as Le}from"./el-date-picker-panel.fd5365ad.js";import{E as He}from"./el-time-picker.6d9d3c3a.js";import{E as Ke}from"./el-switch.316f10b8.js";import{E as Ye}from"./index.4bb9b943.js";/* empty css                  *//* empty css               *//* empty css                     */import{c as Me}from"./sph.d6d2831a.js";import{CreateTypeEnum as B}from"./index.22c5df69.js";import{_ as We}from"./ai-add-keyword.vue.1492dfa8.js";import{_ as ze}from"./ai-add-friend.vue.99fbcbe2.js";import{_ as qe}from"./ai-private-chat.vue.dbc35103.js";import{_ as Ze}from"./remark-pop.vue.b0b28a3a.js";import{useCreateTask as Je}from"./useCreateTask.5614baab.js";import"./index.ef7246b4.js";import"./strings.09a7c832.js";import"./_baseIteratee.4a27397d.js";import"./toNumber.844d22bd.js";import"./clamp.b3f2460d.js";import"./index.c754b099.js";import"./customParseFormat.9e2b166e.js";import"./panel-time-pick.db59fe8e.js";import"./index.e9eda615.js";import"./debounce.0430f44a.js";import"./chatEnum.1c450e0f.js";import"./useDictOptions.8bb858a6.js";import"./device.b8ac970d.js";import"./person_wechat.703f63bb.js";const Qe={class:"h-full bg-app-bg-2 rounded-[20px] flex flex-col"},Xe={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#ffffff1a]"},et={class:"flex items-center gap-1"},tt={class:"grow min-h-0"},st={class:"w-[456px] mx-auto mt-6"},lt={class:"mt-6 flex flex-col gap-y-3"},ot={class:"keyword-content"},at={class:"max-h-[200px] overflow-y-auto flex flex-col gap-y-2 dynamic-scroller"},rt={class:"flex-1"},dt=["onClick"],nt={class:"flex justify-end mt-3"},it={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4"},ct={class:"mt-4"},mt={class:"flex flex-wrap gap-2"},pt=["onClick"],ft={key:0,class:"mt-2"},ut={class:"mt-4"},_t={key:0,class:"mt-2"},vt={class:"text-[#FF2442] mt-1 text-xs"},xt={class:"mb-3 flex items-center gap-x-2"},ht={class:"cursor-pointer"},yt={class:"w-[303px]"},bt={class:"mt-5"};const kt={class:"bg-app-bg-3 rounded-xl shadow-[0_0_0_1px_var(--app-border-color-2)] p-4"},wt={class:"flex justify-between items-center"},gt={class:"mt-2"},Vt={class:"mt-2"},Ct={class:"mt-2"},Et={class:"flex items-center gap-x-4"},Dt={class:"flex-1"},Bt={class:"flex items-center gap-x-2"},Nt={class:"flex-1"},$t={class:"flex-1"},Rt={class:"flex items-center gap-x-2"},At={class:"flex-1"},St={class:"mt-3"},Ut={class:"flex items-center justify-between"},Tt={key:0,class:"mt-3"},Ot={class:"flex justify-end mt-4"},It={key:1},Pt={class:"flex flex-wrap gap-2"},Ft=["onClick"],jt={class:"text-white text-xs"},Gt=["onClick"],Lt={class:"flex justify-end"},Ht=we({__name:"create-panel",emits:["back"],setup(Kt,{emit:J}){const O=J,I=ge(),P=W(()=>{var r;return(r=I.getTokenByScene(Z.SPH_OCR))==null?void 0:r.score}),Q=W(()=>{var r;return(r=I.getTokenByScene(Z.SPH_LOCAL_OCR))==null?void 0:r.score}),o=Ve({name:`视频号获客任务${Ce().format("YYYYMMDDHHmmss")}`,device_codes:[],type:[4],keywords:[""],chat_type:"0",chat_number:30,chat_interval_time:10,add_type:"1",remark:"",add_number:15,add_interval_time:10,greeting_content:"",crawl_type:B.ACCOUNT,private_message_prompt:"",add_friends_prompt:"",wechat_id:[],wechat_reg_type:0,ocr_type:1,add_remark_enable:1,remarks:[],task_frep:1,custom_date:[],time_config:["",""]}),N=D(""),{getWechatRemarks:X,deviceOptions:F,currentFrequency:k,disabledDate:ee,handleFrequency:te,isAddRemarkGen:j,remarkPopupRef:se,handleAddRemark:le,handleAddRemarkConfirm:oe,handleEditRemark:ae,handleDeleteRemark:re,checkTimeConfig:de}=Je(o);Ee(X,r=>{o.remarks=[...r||[]]},{immediate:!0});const ne=[{label:"视频获客",value:B.VIDEO},{label:"账号获客",value:B.ACCOUNT}],$=D(!1),G=S(),L=async r=>{r=="ai"?($.value=!0,await T(),G.value.open()):o.keywords.push("")},ie=r=>{o.keywords.length!=0&&o.keywords.push(...r)},ce=r=>{if(o.keywords.length==1){p.msgWarning("检索关键词至少存在一个！");return}o.keywords.splice(r,1)},V=D(!1),C=D(!1),R=S(),A=S(),me=async r=>{var e,x,u,_;r=="add_friend"?(V.value=!0,await T(),(e=R.value)==null||e.open(),(x=R.value)==null||x.setFormData({content:o.add_friends_prompt})):(C.value=!0,await T(),(u=A.value)==null||u.open(),(_=A.value)==null||_.setFormData({content:o.private_message_prompt}))},pe=r=>{V.value=!1,o.add_friends_prompt=r},fe=r=>{C.value=!1,o.private_message_prompt=r},{lockFn:ue,isLock:_e}=De(async()=>{if(o.name)if(o.device_codes.length==0){p.msgWarning("请选择执行设备");return}else if(o.keywords.length==1&&!o.keywords[0]){p.msgWarning("请输入检索关键词");return}else if(o.add_type=="1"&&o.wechat_id.length==0){p.msgWarning("请选择加微微信");return}else if(k.value==5&&o.custom_date.length==0){p.msgWarning("请选择自定义日期");return}else if(de()){if(o.add_remark_enable==1&&o.remarks.length==0){p.msgWarning("请输入加好友备注内容");return}}else return;else{p.msgWarning("请输入任务名称");return}try{await Me({...o,keywords:o.keywords.filter(r=>r),time_config:[`${o.time_config[0]}-${o.time_config[1]}`],type:[Be.SPH]}),p.msgSuccess("创建成功"),O("back")}catch(r){N.value=r,p.msgError(r)}});return(r,e)=>{const x=Re,u=Ae,_=Se,h=Fe,E=je,H=Ge,ve=Le,xe=He,he=Ue,K=Te,ye=Oe,Y=Ke,be=Ie,ke=Ye,M=Ne("number-input");return d(),i(v,null,[t("div",Qe,[t("div",Xe,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:e[0]||(e[0]=s=>O("back"))},[a(x,{name:"el-icon-ArrowLeft",color:"#ffffff"}),e[27]||(e[27]=t("div",{class:"text-white"},"返回",-1))]),t("div",et,[a(u,{type:"primary",class:"!rounded-full !h-10 w-[98px]",loading:l(_e),onClick:l(ue)},{default:n(()=>[...e[28]||(e[28]=[g(" 创建任务 ",-1)])]),_:1},8,["loading","onClick"])])]),t("div",tt,[a(ke,null,{default:n(()=>[t("div",st,[e[63]||(e[63]=t("div",{class:"text-[20px] font-bold text-white"},"创建新的自动获客任务",-1)),t("div",lt,[t("div",null,[e[29]||(e[29]=t("div",{class:"text-[#ffffff80] mb-3"},"任务名称",-1)),a(_,{modelValue:l(o).name,"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).name=s),placeholder:"请输入任务名称",class:"!h-11",maxlength:"30","show-word-limit":"",clearable:""},null,8,["modelValue"])]),t("div",null,[e[30]||(e[30]=t("div",{class:"text-[#ffffff80] mb-3"},"任务类型",-1)),t("div",null,[a(E,{modelValue:l(o).crawl_type,"onUpdate:modelValue":e[2]||(e[2]=s=>l(o).crawl_type=s),placeholder:"请选择任务类型",class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[(d(),i(v,null,y(ne,s=>a(h,{label:s.label,value:s.value,key:s.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),t("div",null,[e[31]||(e[31]=t("div",{class:"text-[#ffffff80] mb-3"},"执行设备",-1)),t("div",null,[a(E,{modelValue:l(o).device_codes,"onUpdate:modelValue":e[3]||(e[3]=s=>l(o).device_codes=s),placeholder:"请选择执行设备",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[(d(!0),i(v,null,y(l(F).deviceLists,s=>(d(),b(h,{label:s.device_name,value:s.device_code,key:s.device_code},{default:n(()=>[g(f(s.device_name)+" ("+f(s.device_code)+") ",1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),t("div",null,[e[35]||(e[35]=t("div",{class:"text-[#ffffff80] mb-3"},"检索关键词",-1)),t("div",ot,[t("div",at,[(d(!0),i(v,null,y(l(o).keywords,(s,c)=>(d(),i("div",{key:c,class:"flex items-center bg-app-bg-3 gap-x-2 border border-app-border-2 px-3 h-11 rounded-md"},[t("div",{class:U(["rounded-[100px] text-white min-w-[32px] h-5 flex items-center justify-center",[s?"bg-[#3BB840]":"shadow-[0_0_0_1px_var(--app-border-color-2)]"]])},f(c+1),3),t("div",rt,[a(_,{modelValue:l(o).keywords[c],"onUpdate:modelValue":w=>l(o).keywords[c]=w,class:"!h-11",placeholder:"请输入相关关键词",maxlength:"30","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),e[32]||(e[32]=t("div",{class:"w-[1px] h-[12px] bg-[#ffffff1a]"},null,-1)),t("div",null,[t("div",{class:"w-4 h-4",onClick:w=>ce(c)},[a(H,{"icon-size":10,theme:l(z).DARK},null,8,["theme"])],8,dt)])]))),128))]),t("div",nt,[a(u,{type:"primary",class:"!h-[26px] !text-[11px]",onClick:e[4]||(e[4]=s=>L("ai"))},{default:n(()=>[...e[33]||(e[33]=[g("AI添加",-1)])]),_:1}),a(u,{class:"!h-[26px] !text-[11px] !border-app-border-2",color:"#181818",onClick:e[5]||(e[5]=s=>L("manual"))},{default:n(()=>[...e[34]||(e[34]=[g("手动添加",-1)])]),_:1})])])]),t("div",null,[e[39]||(e[39]=t("div",{class:"text-[#ffffff80] mb-3"},"时间设置",-1)),t("div",it,[e[37]||(e[37]=t("div",{class:"text-white"},"任务执行天数",-1)),t("div",ct,[t("div",mt,[(d(),i(v,null,y([1,3,5,10,30],(s,c)=>t("div",{key:c,class:U(["cursor-pointer rounded-md px-4 py-2 border border-app-border-2 text-white hover:bg-app-bg-1",[l(o).task_frep==s&&l(k)!=5?"bg-primary":""]]),onClick:w=>l(te)(s,c)},f(s)+"天 ",11,pt)),64)),t("div",{class:U(["cursor-pointer rounded-md px-4 py-2 border border-app-border-2 text-white",[l(k)==5?"bg-primary":""]]),onClick:e[6]||(e[6]=s=>k.value=5)}," 自定义 ",2)]),l(k)==5?(d(),i("div",ft,[a(ve,{modelValue:l(o).custom_date,"onUpdate:modelValue":e[7]||(e[7]=s=>l(o).custom_date=s),type:"dates",placeholder:"请选择自定义日期",format:"MM-DD","value-format":"YYYY-MM-DD","popper-class":"dark-date-picker-popper","disabled-date":l(ee)},null,8,["modelValue","disabled-date"])])):m("",!0)]),e[38]||(e[38]=t("div",{class:"text-white mt-4"},"每日执行时间",-1)),t("div",ut,[a(xe,{modelValue:l(o).time_config,"onUpdate:modelValue":e[8]||(e[8]=s=>l(o).time_config=s),type:"time","is-range":"","start-placeholder":"请选择开始时间","end-placeholder":"请选择结束时间",format:"HH:mm","value-format":"HH:mm","popper-class":"dark-select-popper","show-arrow":!1},null,8,["modelValue"])]),l(N)?(d(),i("div",_t,[e[36]||(e[36]=t("div",null,"任务冲突",-1)),t("view",vt,f(l(N)),1)])):m("",!0)])]),t("div",null,[t("div",xt,[e[40]||(e[40]=t("div",{class:"text-[#ffffff80]"},"线索识别方式",-1)),a(he,{content:"请选择线索识别方式",placement:"top"},{content:n(()=>[t("div",yt,[t("div",null," 本地识别（每条扣"+f(l(Q))+"算力）使用系统内置识别逻辑完成，识别率较依赖本地环境，复杂图片可能不够精准 ",1),t("div",bt," 云端OCR识别（每条扣 "+f(l(P))+" 算力）使用云端OCR服务识别微信号，每次识别消耗"+f(l(P))+"算力，识别率更高，支持更复杂的图片和场景 ",1)])]),default:n(()=>[t("div",ht,[a(x,{name:"local-icon-tips2",color:"#ffffff"})])]),_:1})]),t("div",null,[a(ye,{modelValue:l(o).ocr_type,"onUpdate:modelValue":e[9]||(e[9]=s=>l(o).ocr_type=s)},{default:n(()=>[a(K,{value:1},{default:n(()=>[...e[41]||(e[41]=[t("span",{class:"text-white"},"云端OCR识别",-1)])]),_:1}),a(K,{value:2},{default:n(()=>[...e[42]||(e[42]=[t("span",{class:"text-white"},"本地识别",-1)])]),_:1})]),_:1},8,["modelValue"])])]),m("",!0),t("div",kt,[t("div",wt,[e[51]||(e[51]=t("div",{class:"text-white"},"自动加好友设置",-1)),t("div",null,[a(Y,{modelValue:l(o).add_type,"onUpdate:modelValue":e[15]||(e[15]=s=>l(o).add_type=s),style:{"--el-switch-off-color":"#333333"},"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])]),l(o).add_type=="1"?(d(),i(v,{key:0},[t("div",gt,[e[52]||(e[52]=t("div",{class:"text-[#ffffff80] mb-3"},"加微微信：",-1)),a(E,{modelValue:l(o).wechat_id,"onUpdate:modelValue":e[16]||(e[16]=s=>l(o).wechat_id=s),placeholder:"请选择添加的微信",class:"!h-11",multiple:"",filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[(d(!0),i(v,null,y(l(F).wechatLists,s=>(d(),b(h,{label:s.wechat_nickname,value:s.wechat_id,key:s.wechat_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",Vt,[e[53]||(e[53]=t("div",{class:"text-[#ffffff80] mb-3"},"加微规则：",-1)),a(E,{modelValue:l(o).wechat_reg_type,"onUpdate:modelValue":e[17]||(e[17]=s=>l(o).wechat_reg_type=s),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1},{default:n(()=>[a(h,{label:"全部",value:0}),a(h,{label:"微信号",value:1}),a(h,{label:"手机号",value:2})]),_:1},8,["modelValue"])]),t("div",Ct,[e[58]||(e[58]=t("div",{class:"text-[#ffffff80] mb-3"},"自动加好友频率：",-1)),t("div",Et,[t("div",Dt,[e[55]||(e[55]=t("div",{class:"text-white mb-3"},"当天执行",-1)),t("div",Bt,[t("div",Nt,[q(a(_,{modelValue:l(o).add_number,"onUpdate:modelValue":e[18]||(e[18]=s=>l(o).add_number=s),type:"number",class:"!h-11"},null,8,["modelValue"]),[[M,{min:1,max:99}]])]),e[54]||(e[54]=t("span",{class:"text-[#ffffff80]"},"条",-1))])]),t("div",$t,[e[57]||(e[57]=t("div",{class:"text-white mb-3"},"每次间隔",-1)),t("div",Rt,[t("div",At,[q(a(_,{modelValue:l(o).add_interval_time,"onUpdate:modelValue":e[19]||(e[19]=s=>l(o).add_interval_time=s),type:"number",class:"!h-11"},null,8,["modelValue"]),[[M,{min:1,max:999}]])]),e[56]||(e[56]=t("span",{class:"text-[#ffffff80]"},"分钟",-1))])])])]),t("div",St,[t("div",Ut,[e[59]||(e[59]=t("div",{class:"text-white mb-3"},"加好友验证内容",-1)),a(Y,{modelValue:l(o).add_remark_enable,"onUpdate:modelValue":e[20]||(e[20]=s=>l(o).add_remark_enable=s),style:{"--el-switch-off-color":"#333333"},"active-value":1,"inactive-value":0},null,8,["modelValue"])]),l(o).add_remark_enable==0?(d(),i("div",Tt,[a(_,{modelValue:l(o).remark,"onUpdate:modelValue":e[21]||(e[21]=s=>l(o).remark=s),type:"textarea",placeholder:"请输入备注内容，为了避免封控，系统将自动调用AI进行去重润色",resize:"none",rows:3},null,8,["modelValue"]),t("div",Ot,[a(u,{type:"primary",class:"!h-[26px] !text-[11px]",onClick:e[22]||(e[22]=s=>me("add_friend"))},{default:n(()=>[...e[60]||(e[60]=[g("AI提示词设置",-1)])]),_:1})])])):m("",!0),l(o).add_remark_enable==1?(d(),i("div",It,[t("div",Pt,[(d(!0),i(v,null,y(l(o).remarks,(s,c)=>(d(),i("div",{key:c,class:"cursor-pointer hover:bg-app-bg-1 transition-all duration-300 border border-app-border-2 rounded-md px-4 py-2 flex items-center",onClick:w=>l(ae)(s,c)},[t("div",jt,f(s),1),e[61]||(e[61]=t("div",{class:"w-[1px] h-[8px] bg-app-border-2 mx-2"},null,-1)),t("div",{class:"w-4 h-4",onClick:$e(w=>l(re)(c),["stop"])},[a(H,{theme:l(z).DARK,"icon-size":10},null,8,["theme"])],8,Gt)],8,Ft))),128))]),a(be,{class:"!my-4 !border-app-border-2"}),t("div",Lt,[a(u,{class:"!h-8 !border-[#ffffff1a]",color:"#121212",onClick:l(le)},{default:n(()=>[a(x,{name:"el-icon-Plus",color:"#ffffff",size:12}),e[62]||(e[62]=t("div",{class:"text-white text-xs ml-1"},"新增文案",-1))]),_:1},8,["onClick"])])])):m("",!0)])],64)):m("",!0)])])])]),_:1})])]),l($)?(d(),b(We,{key:0,ref_key:"aiAddKeywordRef",ref:G,type:l(o).crawl_type==l(B).VIDEO?2:3,onClose:e[23]||(e[23]=s=>$.value=!1),onSuccess:ie},null,8,["type"])):m("",!0),l(V)?(d(),b(ze,{key:1,ref_key:"aiAddFriendRef",ref:R,onClose:e[24]||(e[24]=s=>V.value=!1),onConfirm:pe},null,512)):m("",!0),l(C)?(d(),b(qe,{key:2,ref_key:"aiPrivateChatRef",ref:A,onClose:e[25]||(e[25]=s=>C.value=!1),onConfirm:fe},null,512)):m("",!0),l(j)?(d(),b(Ze,{key:3,ref_key:"remarkPopupRef",ref:se,onClose:e[26]||(e[26]=s=>j.value=!1),onConfirm:l(oe)},null,8,["onConfirm"])):m("",!0)],64)}}});const ws=Pe(Ht,[["__scopeId","data-v-53b589d5"]]);export{ws as default};
