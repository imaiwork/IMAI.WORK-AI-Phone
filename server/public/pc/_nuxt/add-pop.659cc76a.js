import{_ as P}from"./index.vue.96af9406.js";import{d as j,au as $,z as K,aH as Z,c as x,A as X,r as Q,aG as W,cy as Y,D as ee,k as p,I as v,s as r,m as s,q as a,Z as t,cZ as te,l as S,K as oe,J as E,L as I,v as V,t as se,cX as le,dv as g,G as C,y as ae,av as ne,aw as re,az as ie,ay as de,_ as ce}from"./entry.563c232b.js";import{E as pe,a as me}from"./index.b6452ee7.js";import{_ as ue}from"./index.875ea2c9.js";/* empty css                  *//* empty css               *//* empty css                     */import{s as fe,v as _e}from"./digital_human.299b9036.js";import{DigitalHumanModelVersionEnum as d}from"./index.d52c6f2c.js";import"./index.9ed38239.js";import"./index.941331c1.js";import"./strings.0730af8d.js";import"./_baseIteratee.4589a236.js";import"./toNumber.590accd9.js";import"./clamp.43011008.js";import"./index.be457d98.js";import"./index.aabb37e8.js";import"./index.477a7d18.js";import"./cloneDeep.3c027ec4.js";/* empty css                  *//* empty css                    *//* empty css                  */const xe={class:"-my-4"},ve={class:"flex items-center gap-x-1 rounded-full bg-[#ffffff08] p-1 mt-5 w-fit"},ge={class:"h-[166px] bg-app-bg-1 rounded-lg flex flex-col justify-center items-center"},he={class:"w-12 h-12 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer mt-8 flex-shrink-0"},we={class:"px-[35px] mt-[18px]"},ke=j({__name:"add-pop",emits:["success","close"],setup(be,{expose:H,emit:B}){const h=B,D=$(),c=K(),{userTokens:R}=Z(c),w=x(()=>{const{channel:o}=D.getDigitalHumanConfig;return o&&o.length>0?o.filter(n=>{if(n.id=parseInt(n.id),n.status==1&&(d.SHANJIAN==n.id||d.CHANJING==n.id||d.STANDARD==n.id))return n}):[]}),u=x(()=>{var o,e,n;return{[d.STANDARD]:(o=c.getTokenByScene(g.HUMAN_VOICE))==null?void 0:o.score,[d.CHANJING]:(e=c.getTokenByScene(g.HUMAN_VOICE_CHANJING))==null?void 0:e.score,[d.SHANJIAN]:(n=c.getTokenByScene(g.HUMAN_VOICE_SHANJIAN))==null?void 0:n.score}[l.model_version]}),f=X(),k=Q(),l=W({url:"",name:"",gender:"male",model_version:d.STANDARD}),T={name:[{required:!0,message:"请输入音色名称"}],url:[{required:!0,message:"请上传音频"}],model_version:[{required:!0,message:"请选择模型"}]},F=x(()=>".mp3,.m4a,.wav"),J=o=>{const{data:{uri:e}}=o;l.url=e},M=()=>{f.value.open()},U=async()=>{var o;if(R.value<u.value){C.msgPowerInsufficient();return}await k.value.validate();try{await l.model_version==d.SHANJIAN?await fe({name:l.name,audio_url:l.url}):await _e(l),(o=f.value)==null||o.close(),c.getUser(),h("success")}catch(e){C.msgError(e||"克隆失败")}},b=()=>{h("close")},{lockFn:G,isLock:A}=Y(U);return ee(()=>w.value,o=>{o&&o.length>0&&(l.model_version=o[0].id)},{immediate:!0}),H({open:M}),(o,e)=>{const n=P,N=ae,O=ne,m=re,_=pe,y=me,q=ue,z=ie,L=de;return p(),v(le,{ref_key:"popupRef",ref:f,width:"400px",async:"",style:{padding:"18px","background-color":"var(--app-bg-color-2)"},"confirm-button-text":"","cancel-button-text":"","show-close":!1,onClose:b},{default:r(()=>[s("div",xe,[s("div",{class:"w-6 h-6 absolute top-4 right-4",onClick:b},[a(n,{theme:t(te).DARK},null,8,["theme"])]),e[7]||(e[7]=s("div",{class:"flex items-center gap-x-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[s("rect",{width:"20",height:"20",rx:"10",fill:"#0065FB"}),s("path",{d:"M6 8V12",stroke:"white","stroke-width":"1.2"}),s("path",{d:"M14 8V12",stroke:"white","stroke-width":"1.2"}),s("path",{d:"M10 6V14",stroke:"white","stroke-width":"1.2"})]),s("span",{class:"text-white font-bold text-[20px]"},"上传本地音频")],-1)),s("div",ve,[a(N,{name:"local-icon-tips",size:16}),e[3]||(e[3]=s("span",{class:"text-[#ffffff4d] text-xs"},"注意：请根据性别上传对应的音频文件素材。",-1))]),a(z,{class:"mt-[17px]",model:t(l),rules:T,ref_key:"formRef",ref:k,"label-position":"top",disabled:t(A)},{default:r(()=>[a(m,{label:"音色名称",prop:"name"},{default:r(()=>[a(O,{modelValue:t(l).name,"onUpdate:modelValue":e[0]||(e[0]=i=>t(l).name=i),class:"!h-11",placeholder:"请输入音色名称",maxlength:"30"},null,8,["modelValue"])]),_:1}),a(m,{label:"使用模型",prop:"model_version"},{default:r(()=>[a(y,{modelValue:t(l).model_version,"onUpdate:modelValue":e[1]||(e[1]=i=>t(l).model_version=i),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1,placeholder:"请选择模型"},{default:r(()=>[(p(!0),S(E,null,oe(t(w),i=>(p(),v(_,{key:i.id,value:i.id,label:i.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(l).model_version!=t(d).SHANJIAN?(p(),v(m,{key:0,label:"性别",prop:"gender"},{default:r(()=>[a(y,{modelValue:t(l).gender,"onUpdate:modelValue":e[2]||(e[2]=i=>t(l).gender=i),class:"!h-11",placeholder:"请选择性别","popper-class":"dark-select-popper","show-arrow":!1},{default:r(()=>[a(_,{value:"male",label:"男"}),a(_,{value:"female",label:"女"})]),_:1},8,["modelValue"])]),_:1})):I("",!0),a(m,{label:"上传音频",prop:"url"},{default:r(()=>[a(q,{class:"w-full",drag:"",type:"audio","list-type":"text",limit:1,"max-size":10,accept:t(F),onSuccess:J},{default:r(()=>[s("div",ge,[s("div",he,[a(N,{name:"el-icon-Plus",color:"#ffffff"})]),e[4]||(e[4]=s("div",{class:"text-white text-xs mt-3"},"上传录音文件",-1)),e[5]||(e[5]=s("div",{class:"text-xs text-[rgba(255,255,255,0.3)] text-center mt-4"}," 文件不超过20MB,不支持gif/avif等音频格式以外的文件 ",-1))])]),_:1},8,["accept"])]),_:1})]),_:1},8,["model","disabled"]),s("div",we,[a(L,{type:"primary",class:"w-full !h-[50px] !rounded-full",loading:t(A),onClick:t(G)},{default:r(()=>[e[6]||(e[6]=V("开始转写 ",-1)),t(u)?(p(),S(E,{key:0},[V("（消耗"+se(t(u))+"算力）",1)],64)):I("",!0)]),_:1},8,["loading","onClick"])])])]),_:1},512)}}});const Pe=ce(ke,[["__scopeId","data-v-dce87c96"]]);export{Pe as default};
