import{d as F,bP as q,aG as H,r as w,o as K,k as s,l as i,Z as a,m as n,q as o,s as l,$ as R,v as r,aI as G,I as v,J as c,K as J,t as k,Y as O,L as d,bC as A,bM as Z,bO as D,G as B,ay as Q,av as X,y as ee,ba as te,cY as oe,u as ae,_ as se}from"./entry.556496e9.js";import{E as le}from"./index.4bb9b943.js";import{E as ne,a as ie}from"./index.e8affe9d.js";import{E as re}from"./el-empty.5e752bd7.js";import{_ as pe}from"./index.vue.ba665940.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                 */import{u as de}from"./usePaging.cb2ddca4.js";import{k as me,l as ce}from"./sph.d6d2831a.js";import{SidebarTypeEnum as C}from"./index.22c5df69.js";import ue from"./create-panel.ff4d67d3.js";import{_ as _e}from"./detail.vue.a8f64735.js";import"./_baseIteratee.4a27397d.js";import"./debounce.0430f44a.js";import"./toNumber.844d22bd.js";import"./raf.a745d528.js";import"./index.899f58ef.js";import"./index.ef7246b4.js";import"./strings.09a7c832.js";import"./clamp.b3f2460d.js";import"./index.c754b099.js";import"./index.2280f26b.js";import"./index.eaed1e2d.js";import"./index.65c6aa54.js";import"./cloneDeep.3021ea2e.js";/* empty css                  *//* empty css                    *//* empty css                  */import"./el-date-picker-panel.fd5365ad.js";import"./customParseFormat.9e2b166e.js";import"./panel-time-pick.db59fe8e.js";import"./index.e9eda615.js";import"./el-time-picker.6d9d3c3a.js";import"./el-switch.316f10b8.js";import"./index.vue.83bf2a64.js";/* empty css                  */import"./remark-pop.vue.b0b28a3a.js";import"./useCreateTask.5614baab.js";import"./useDictOptions.8bb858a6.js";import"./device.b8ac970d.js";import"./person_wechat.703f63bb.js";const fe={key:0,class:"h-full flex flex-col bg-app-bg-2 rounded-[20px]"},ye={class:"flex-shrink-0 px-[14px]"},he={class:"flex items-center justify-end h-[88px]"},ge={class:"flex items-center gap-[14px]"},xe={class:"grow min-h-0 overflow-hidden flex flex-col"},be={class:"grow min-h-0"},ve={key:0,class:"flex gap-x-2 justify-center"},ke={class:"rounded-md px-4 py-1 bg-app-bg-4 border border-app-border-2"},Ce={key:1},Ee={class:"flex items-center justify-center gap-x-2"},we={class:"flex justify-end items-center"},Ae={class:"flex justify-center items-center h-full"},De={class:"flex justify-center p-4"},Be=F({__name:"index",setup(Me){const{query:h}=q(),M=ae(),x=H({device_code:"",wechat_no:"",channel:"",exec_type:"",name:"",status:"",page_size:20}),_=w(h.is_create=="1"&&parseInt(h.type)==C.MANUAL_ADD_WECHAT),g=w(h.is_detail=="1"&&parseInt(h.type)==C.MANUAL_ADD_WECHAT),{pager:f,getLists:m,resetPage:$}=de({fetchFun:me,params:x}),T=()=>{_.value=!0,D({is_create:1})},S=u=>{g.value=!0,D({is_detail:1,id:u})},V=u=>({0:"bg-[#999999]",1:"bg-primary",2:"bg-[#FFBC50]",3:"bg-[#3BB840]",4:"bg-[#3BB840]"})[u],Y=async u=>{M.$confirm({message:"确定删除该记录吗？",theme:"dark",onConfirm:async()=>{try{await ce({id:u}),B.msgSuccess("删除成功"),m()}catch(t){B.msgError(t||"删除失败")}}})},E=()=>{_.value=!1,g.value=!1,window.history.replaceState("","",`?type=${C.MANUAL_ADD_WECHAT}`),m()};return K(()=>{_.value||m()}),(u,t)=>{const y=Q,I=X,L=ee,N=te,j=le,p=ne,W=re,P=ie,U=pe,z=oe;return s(),i(c,null,[!a(_)&&!a(g)?(s(),i("div",fe,[n("div",ye,[o(j,null,{default:l(()=>[n("div",he,[n("div",ge,[o(I,{modelValue:a(x).name,"onUpdate:modelValue":t[1]||(t[1]=e=>a(x).name=e),"prefix-icon":"el-icon-Search",class:"!w-[240px] search-name-input",placeholder:"请输入任务名称",clearable:"",onClear:t[2]||(t[2]=e=>a(m)()),onKeydown:t[3]||(t[3]=R(e=>a(m)(),["enter"]))},{append:l(()=>[o(y,{text:"",onClick:t[0]||(t[0]=e=>a(m)())},{default:l(()=>[...t[6]||(t[6]=[r(" 搜索 ",-1)])]),_:1})]),_:1},8,["modelValue"]),o(y,{type:"primary",class:"!rounded-full !h-10",onClick:T},{default:l(()=>[o(L,{name:"local-icon-add_circle",color:"#ffffff"}),t[7]||(t[7]=n("span",{class:"ml-2"},"创建任务 ",-1))]),_:1}),n("div",null,[o(N,{content:"刷新"},{default:l(()=>[o(y,{circle:"",color:"#1f1f1f",icon:"el-icon-Refresh",class:"!w-10 !h-10",onClick:t[4]||(t[4]=e=>a($)())})]),_:1})])])])]),_:1})]),n("div",xe,[n("div",be,[G((s(),v(P,{height:"100%",data:a(f).lists,"header-row-style":{height:"62px"},"row-style":{height:"50px"}},{empty:l(()=>[n("div",Ae,[o(W,{description:"暂无数据"})])]),default:l(()=>[o(p,{prop:"name",label:"任务名称",width:"240",fixed:"left"}),o(p,{label:"执行账号","min-width":"140","show-overflow-tooltip":""},{default:l(({row:e})=>[e.wechats.length>0?(s(),i("div",ve,[(s(!0),i(c,null,J(e.wechats,b=>(s(),i("div",ke,k(b.wechat_nickname),1))),256))])):(s(),i("div",Ce,"-"))]),_:1}),o(p,{label:"任务状态",width:"160",align:"center"},{default:l(({row:e})=>[n("div",Ee,[n("div",{class:O(["w-[6px] h-[6px] rounded-full",V(e.status)])},null,2),n("span",null,[e.status==0?(s(),i(c,{key:0},[r("未开始")],64)):d("",!0),e.status==1?(s(),i(c,{key:1},[r("进行中")],64)):d("",!0),e.status==2?(s(),i(c,{key:2},[r("已暂停")],64)):d("",!0),e.status==3?(s(),i(c,{key:3},[r("已完成")],64)):d("",!0),e.status==4?(s(),i(c,{key:4},[r("已结束")],64)):d("",!0)])])]),_:1}),o(p,{label:"开始时间",width:"120"},{default:l(({row:e})=>[r(k(a(A)(e.start_time).format("YYYY-MM-DD")),1)]),_:1}),o(p,{label:"结束时间",width:"120"},{default:l(({row:e})=>[r(k(a(A)(e.end_time).format("YYYY-MM-DD")),1)]),_:1}),o(p,{prop:"exec_day",label:"已执行天数","min-width":"120"}),o(p,{prop:"create_time",label:"创建时间",width:"180"}),o(p,{label:"操作",width:"120",fixed:"right",align:"right"},{default:l(({row:e})=>[n("div",we,[o(y,{class:"!border-app-border-2",color:"#181818",size:"small",onClick:b=>S(e.id)},{default:l(()=>[...t[8]||(t[8]=[r("详情",-1)])]),_:1},8,["onClick"]),o(y,{type:"danger",link:"",size:"small",onClick:b=>Y(e.id)},{default:l(()=>[...t[9]||(t[9]=[r("删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[z,a(f).loading]])]),n("div",De,[o(U,{modelValue:a(f),"onUpdate:modelValue":t[5]||(t[5]=e=>Z(f)?f.value=e:null),layout:"prev, pager, next",onChange:a(m)},null,8,["modelValue","onChange"])])])])):d("",!0),a(_)?(s(),v(ue,{key:1,onBack:E})):d("",!0),a(g)?(s(),v(_e,{key:2,onBack:E})):d("",!0)],64)}}});const xt=se(Be,[["__scopeId","data-v-a0de34bb"]]);export{xt as default};
