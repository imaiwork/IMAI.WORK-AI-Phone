import{d as H,aH as M,r as V,au as Z,c as F,aG as G,D as X,k as d,I as B,s as r,m as t,q as l,Z as c,cZ as Y,$ as J,v as m,aI as O,l as g,t as Q,bM as W,L as ee,cX as oe,y as te,av as se,ay as ne,cY as le,_ as ae}from"./entry.556496e9.js";import{_ as ie}from"./index.vue.83bf2a64.js";import{E as re,a as ce}from"./index.e8affe9d.js";import{E as ue}from"./index.ef7246b4.js";import{_ as pe}from"./index.vue.ba665940.js";/* empty css                        *//* empty css               *//* empty css                 *//* empty css                     */import{u as de}from"./usePaging.cb2ddca4.js";import{ToneTypeEnum as me}from"./index.d52c6f2c.js";import{g as fe}from"./digital_human.299b9036.js";import{c as _e}from"./cloneDeep.3bea7aa0.js";import"./index.4bb9b943.js";import"./_baseIteratee.4a27397d.js";import"./debounce.0430f44a.js";import"./toNumber.844d22bd.js";import"./raf.a745d528.js";import"./index.899f58ef.js";import"./strings.09a7c832.js";import"./clamp.b3f2460d.js";import"./index.c754b099.js";const ve={class:"rounded-xl overflow-hidden flex flex-col -my-2"},xe={class:"flex items-center justify-between h-[50px] px-4"},ye={class:"flex items-center gap-x-2"},he={class:"w-6 h-6 flex items-center justify-center rounded-md border border-[#ffffff1a]"},ge={class:"px-4 my-4"},be={class:"flex items-center rounded-full h-[50px] border border-[#2a2a2a] px-[5px]"},we={class:"h-[500px] flex flex-col"},Ce={class:"grow min-h-0 cursor-pointer"},Ee={key:0},ke={key:1},Te={class:"w-5 h-5 flex items-center justify-center rounded-full mx-auto"},Ve={class:"flex justify-center my-2 px-2"},Be={key:0,class:"flex justify-center my-2 px-2"},Ie=H({__name:"choose-tone",props:{is_show_original:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1}},emits:["close","confirm"],setup(I,{expose:$,emit:R}){const D=I,b=R,{is_show_original:j,multiple:u}=M(D),w=V(),L=Z(),f=F(()=>{var e;const o=_e((e=L.getDigitalHumanConfig)==null?void 0:e.voice.filter(s=>s.status=="1").map(s=>({...s,voice_id:s.code,builtin:0})));return j.value&&o.unshift({voice_id:-1,name:"视频原音",builtin:1}),o}),p=G({name:"",status:1,model_version:"",builtin:me.USER}),{pager:i,getLists:_}=de({fetchFun:fe,params:p}),v=async()=>{const o=f.value.filter(e=>e.name.includes(p.name));await _(),i.lists.unshift(...o)},a=V(),C=o=>{var s;if(u.value)return((s=a.value)==null?void 0:s.findIndex(y=>y.voice_id===o))>-1;const{voice_id:e}=a.value||{};return e?e===o:!1},S=o=>{const{voice_id:e}=o;C(e)?u.value?a.value=a.value.filter(s=>s.voice_id!==e):a.value={}:u.value?a.value.push(o):a.value=o,u.value||E()},N=o=>{a.value=o},K=async()=>{await _(),i.page==1&&i.lists.unshift(...f.value)},E=()=>{b("confirm",a.value),x()},P=async o=>{var e;(e=w.value)==null||e.open(),p.model_version=o,await _(),i.lists.unshift(...f.value)},x=()=>{b("close")};return X(()=>u.value,o=>{o?a.value=[]:a.value={}},{immediate:!0}),$({open:P,setChooseTone:N}),(o,e)=>{const s=te,y=ie,U=se,k=ne,h=re,T=ue,q=ce,z=pe,A=le;return d(),B(oe,{ref_key:"popupRef",ref:w,width:"528px",class:"choose-anchor-popup",style:{padding:"0","background-color":"var(--app-bg-color-2)","box-shadow":"0px 0px 0px 1px var(--app-border-color-2)"},"confirm-button-text":"","cancel-button-text":"","show-close":!1,onClose:x},{default:r(()=>[t("div",ve,[t("div",xe,[t("div",ye,[t("div",he,[l(s,{name:"local-icon-windows",size:14})]),e[6]||(e[6]=t("div",{class:"text-[20px] text-white font-bold"},"从已有音色中选择",-1))]),t("div",{class:"w-6 h-6",onClick:x},[l(y,{theme:c(Y).DARK},null,8,["theme"])])]),t("div",ge,[t("div",be,[l(U,{modelValue:c(p).name,"onUpdate:modelValue":e[0]||(e[0]=n=>c(p).name=n),class:"flex-1 search-input",clearable:"","prefix-icon":"el-icon-Search",placeholder:"请输入音色名称","input-style":"color: #ffffff",onClear:e[1]||(e[1]=n=>v()),onKeyup:e[2]||(e[2]=J(n=>v(),["enter"]))},null,8,["modelValue"]),l(k,{type:"primary",class:"!text-white !rounded-full !w-[116px] !h-10",onClick:e[3]||(e[3]=n=>v())},{default:r(()=>[...e[7]||(e[7]=[m(" 搜索 ",-1)])]),_:1})])]),t("div",we,[t("div",Ce,[O((d(),B(q,{data:c(i).lists,height:"100%",onRowClick:S},{default:r(()=>[l(h,{label:"音色名称",prop:"name"}),l(h,{label:"音色类型"},{default:r(({row:n})=>[n.voice_id==-1?(d(),g("div",Ee,[e[9]||(e[9]=t("span",null,"当前视频",-1)),l(T,{class:"ml-3",effect:"dark",type:"primary",round:"","disable-transitions":!0},{default:r(()=>[...e[8]||(e[8]=[m("原生",-1)])]),_:1})])):(d(),g("div",ke,[t("span",null,Q(n.builtin==0?"内置音色":"用户音色"),1),l(T,{class:"ml-3 !border-none !text-white",color:"#3BB840",round:"","disable-transitions":!0},{default:r(()=>[...e[10]||(e[10]=[m("免费",-1)])]),_:1})]))]),_:1}),l(h,{label:"操作"},{default:r(({row:n})=>[t("div",Te,[l(s,{name:"local-icon-success_fill",size:20,color:C(n.voice_id)?"var(--color-primary)":"#ffffff1a"},null,8,["color"])])]),_:1})]),_:1},8,["data"])),[[A,c(i).loading]])]),t("div",Ve,[l(z,{modelValue:c(i),"onUpdate:modelValue":e[4]||(e[4]=n=>W(i)?i.value=n:null),layout:"prev, pager, next",onChange:K},null,8,["modelValue"])])]),c(u)?(d(),g("div",Be,[l(k,{type:"primary",class:"!rounded-full w-[318px] !h-[50px]",onClick:e[5]||(e[5]=n=>E())},{default:r(()=>[...e[11]||(e[11]=[m(" 确定 ",-1)])]),_:1})])):ee("",!0)])]),_:1},512)}}});const Qe=ae(Ie,[["__scopeId","data-v-24d85c49"]]);export{Qe as default};
