import{a as X,E as Z}from"./index.c162b53f.js";import{d as D,A as k,r as c,c as j,aG as G,k as u,l as v,q as a,s,Z as e,J as T,K as C,I as d,av as p,L as J,m as P,v as I,t as H,bM as Q,$ as W,cX as Y,ai as ee,aw as le,ay as oe,az as te}from"./entry.9c858de7.js";import{E as ae}from"./index.bbca104f.js";import{E as ne}from"./el-switch.79e3c4c6.js";/* empty css                  *//* empty css               *//* empty css                     */import{FieldTypeEnum as V,FieldTypeMap as se}from"./formEnums.87727bf8.js";import"./index.d2366752.js";import"./strings.39ad33fc.js";import"./_baseIteratee.86867911.js";import"./toNumber.590fb445.js";import"./clamp.c33da429.js";import"./index.c04086ee.js";const ue={class:"edit-popup"},re={class:"flex gap-2"},we=D({__name:"form-edit",emits:["success","close"],setup(de,{expose:U,emit:B}){const x=B,h=k(),_=k(),g=c("add"),F=j(()=>g.value=="edit"?"编辑表单":"新增表单"),y=c([]),o=G({name:V.TEXT,field:"",title:"",placeholder:"",rows:4,options:[],maxlength:200,isRequired:!1}),S={field:[{required:!0,message:"请输入字段值",trigger:["blur"]},{pattern:/^(?!^\d)(?!.*?_$)[A-Za-z_$][A-Za-z\d_$]*$/,message:"字段值格式不正确",trigger:["change"]},{validator(r,l,m){y.value.some(n=>n.field==o.field)?m(new Error("字段不能重复，请修改")):m()},trigger:"change"}],title:[{required:!0,message:"请输入字段名称",trigger:["blur"]}]},i=c(""),E=c(!1),R=c(),$=r=>{o.options.splice(o.options.indexOf(r),1)},q=()=>{E.value=!0,ee(()=>{R.value.input.focus()})},w=()=>{i.value&&o.options.push(i.value),E.value=!1,i.value=""},z=async()=>{var r,l;await((r=h.value)==null?void 0:r.validate()),(l=_.value)==null||l.close(),x("success",{data:o,type:g.value})},A=r=>{var f;const{data:l,lists:m}=r;y.value=m,g.value=l?"edit":"add",l&&Object.keys(o).forEach(n=>{o[n]=l[n]}),(f=_.value)==null||f.open()},L=()=>{x("close")};return U({open:A}),(r,l)=>{const m=Z,f=X,n=le,O=ae,N=oe,K=ne,M=te;return u(),v("div",ue,[a(Y,{ref_key:"popupRef",ref:_,title:e(F),async:!0,width:"550px",onConfirm:z,onClose:L},{default:s(()=>[a(M,{ref_key:"formRef",ref:h,model:e(o),"label-width":"100px","label-position":"top",rules:S},{default:s(()=>[a(n,{label:"字段类型"},{default:s(()=>[a(f,{modelValue:e(o).name,"onUpdate:modelValue":l[0]||(l[0]=t=>e(o).name=t),placeholder:"请输入字段类型",clearable:""},{default:s(()=>[(u(!0),v(T,null,C(e(se),(t,b)=>(u(),d(m,{key:b,label:t,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"字段名称",prop:"title"},{default:s(()=>[a(e(p),{modelValue:e(o).title,"onUpdate:modelValue":l[1]||(l[1]=t=>e(o).title=t),placeholder:"请输入字段名称",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"字段值",prop:"field"},{default:s(()=>[a(e(p),{modelValue:e(o).field,"onUpdate:modelValue":l[2]||(l[2]=t=>e(o).field=t),placeholder:"字段值允许包含数字、字母、下划线_、美元符号$，且必须唯一",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"占位文字",prop:"placeholder"},{default:s(()=>[a(e(p),{modelValue:e(o).placeholder,"onUpdate:modelValue":l[3]||(l[3]=t=>e(o).placeholder=t),placeholder:"请输入占位文字",maxlength:"100",clearable:""},null,8,["modelValue"])]),_:1}),e(o).name==e(V).TEXTAREA?(u(),d(n,{key:0,label:"默认行数"},{default:s(()=>[a(e(p),{modelValue:e(o).rows,"onUpdate:modelValue":l[4]||(l[4]=t=>e(o).rows=t),type:"number",placeholder:"请输入默认行数",max:20},null,8,["modelValue"])]),_:1})):J("",!0),[e(V).MULTIPLE,e(V).SELECT].includes(e(o).name)?(u(),d(n,{key:1,label:"选项"},{default:s(()=>[P("div",re,[(u(!0),v(T,null,C(e(o).options,t=>(u(),d(O,{key:t,closable:"","disable-transitions":!1,onClose:b=>$(t)},{default:s(()=>[I(H(t),1)]),_:2},1032,["onClose"]))),128)),e(E)?(u(),d(e(p),{key:0,ref_key:"InputRef",ref:R,modelValue:e(i),"onUpdate:modelValue":l[5]||(l[5]=t=>Q(i)?i.value=t:null),size:"small",onKeyup:W(w,["enter"]),maxlength:"50",onBlur:w},null,8,["modelValue"])):(u(),d(N,{key:1,size:"small",onClick:q},{default:s(()=>[...l[8]||(l[8]=[I(" + 添加选项 ",-1)])]),_:1}))])]),_:1})):(u(),d(n,{key:2,label:"最大输入长度",prop:"maxlength"},{default:s(()=>[a(e(p),{modelValue:e(o).maxlength,"onUpdate:modelValue":l[6]||(l[6]=t=>e(o).maxlength=t),type:"number",placeholder:"请输入最大输入长度",max:200},null,8,["modelValue"])]),_:1})),a(n,{label:"是否必填"},{default:s(()=>[a(K,{modelValue:e(o).isRequired,"onUpdate:modelValue":l[7]||(l[7]=t=>e(o).isRequired=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{we as default};
