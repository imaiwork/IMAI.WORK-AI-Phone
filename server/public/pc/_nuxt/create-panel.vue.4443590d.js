import{d as F,bP as S,a as A,z as N,aH as T,c as _,aG as q,A as L,cy as D,D as G,k as p,l as f,m as t,q as l,s as x,Z as s,bM as K,v as y,J as j,t as P,L as U,dv as $,G as z,y as H,ay as I}from"./entry.563c232b.js";import{E as J}from"./index.9ed38239.js";/* empty css                     */import{d as M,e as O}from"./knowledge_base.519704cc.js";import{KnTypeEnum as W}from"./index.5bd136e1.js";import Z from"./base-form.43dba5f9.js";const Q={class:"p-4 h-full"},X={class:"h-full flex flex-col bg-white rounded-xl"},Y={class:"flex-shrink-0 flex items-center justify-between px-[14px] h-[88px] border-b border-[#0000000d]"},ee={class:"grow min-h-0 mt-4 flex flex-col w-[456px] mx-auto"},te={class:"flex-shrink min-h-0 mt-[23px]"},se={class:"px-2"},oe={class:"flex justify-center my-[30px]"},me=F({__name:"create-panel",emits:["success","back"],setup(ae,{emit:k}){const b=k,d=S(),v=A(),m=N(),{getTokenByScene:g}=m,{userTokens:h}=T(m),c=_(()=>{var o;return(o=g($.KNOWLEDGE_CREATE))==null?void 0:o.score}),i=_(()=>a.type==W.RAG),a=q({name:"",description:"",cover:"",type:d.query.type}),u=L(),w=async()=>{await u.value.validateForm();try{const{name:o,description:e,cover:r}=a,n=i.value?await M({name:o,description:e,image:r}):await O({name:o,intro:e,image:r,documents_model_id:2,documents_model_sub_id:2,embedding_model_id:3,embedding_model_sub_id:3});v.replace({path:`/knowledge_base/detail/${n.id}`,query:{kn_type:a.type,index_id:n.index_id,category_id:n.category_id,kn_name:n.name}})}catch(o){z.msgError(o||"操作失败")}},E=()=>{b("back")},{lockFn:R,isLock:B}=D(w);return G(()=>d.query,()=>{a.type=d.query.type}),(o,e)=>{const r=H,n=J,V=I;return p(),f("div",Q,[t("div",X,[t("div",Y,[t("div",{class:"flex items-center gap-2 cursor-pointer",onClick:E},[l(r,{name:"el-icon-ArrowLeft"}),e[1]||(e[1]=t("div",null,"返回上一步",-1))])]),t("div",ee,[e[3]||(e[3]=t("div",{class:"text-[20px] font-bold mt-6"},"创建新的知识库",-1)),t("div",te,[l(n,null,{default:x(()=>[t("div",se,[l(Z,{ref_key:"baseFormRef",ref:u,modelValue:s(a),"onUpdate:modelValue":e[0]||(e[0]=C=>K(a)?a.value=C:null)},null,8,["modelValue"])])]),_:1})]),t("div",oe,[l(V,{type:"primary",class:"!h-[50px] !rounded-full w-[318px]",loading:s(B),disabled:s(h)<s(c)&&s(i),onClick:s(R)},{default:x(()=>[e[2]||(e[2]=y(" 创建知识库 ",-1)),s(c)&&s(i)?(p(),f(j,{key:0},[y("("+P(s(c))+"算力)",1)],64)):U("",!0)]),_:1},8,["loading","disabled","onClick"])])])])])}}});export{me as _};
