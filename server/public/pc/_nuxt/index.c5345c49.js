import{d as ne,a as le,r as u,A as ie,cy as ae,G as y,k as m,l as re,m as t,t as T,Z as n,dn as ce,dp as de,q as o,s as i,aI as pe,I as x,v as f,dO as E,bM as ue,L as F,J as me,el as p,e9 as fe,ai as ve,y as _e,ay as ge,av as xe,cX as ye,cY as Ee,u as he}from"./entry.9c858de7.js";import{E as Ce,a as ke}from"./index.3c639db8.js";import{E as be}from"./index.bbca104f.js";import{E as De}from"./index.5a0721a3.js";import{_ as we}from"./index.vue.2c8f7917.js";import{_ as Ae}from"./index.vue.421b9ac0.js";/* empty css                        *//* empty css               *//* empty css                   *//* empty css                 *//* empty css                     */import{u as Ne}from"./usePaging.c86a33a9.js";import{u as Te}from"./useDeviceWs.f32023fe.js";import{u as Re}from"./useAddDeviceAccount.09fa33ed.js";import{h as $e,l as Ie,m as Ve}from"./device.b8ac970d.js";import{_ as Pe}from"./device-add.vue.010c2a6b.js";import{_ as Oe}from"./device-progress.vue.0399c6ef.js";import"./index.d2366752.js";import"./_baseIteratee.86867911.js";import"./debounce.3f6e2cd0.js";import"./toNumber.590fb445.js";import"./raf.737e07d1.js";import"./index.c162b53f.js";import"./strings.39ad33fc.js";import"./clamp.c33da429.js";import"./index.c04086ee.js";import"./useWebSocket.7a4060d6.js";import"./service.9c966dd0.js";import"./usePolling.b60e1bb6.js";import"./index.3f0b5ea1.js";/* empty css                    */const Se=""+new URL("device.5646dcc8.svg",import.meta.url).href,Le={class:"h-full p-4 flex flex-col"},Fe={class:"rounded-[20px] flex items-center gap-3 px-[30px]",style:{background:`linear-gradient(152deg, rgba(0, 101, 251, 0.88) -42.44%, rgba(255, 255, 255, 0) 12.19%)
                    rgb(255, 255, 255)`}},Ue={class:"text-[#000000cc]"},je={class:"grow min-h-0 bg-white rounded-[20px] mt-4 flex flex-col"},Be={class:"h-[88px] px-5 flex items-center justify-between"},Xe={class:"flex items-center gap-x-2"},Ge={class:"text-lg font-bold"},He={class:"grow min-h-0"},Me={class:"flex items-center justify-center gap-x-1"},qe=["onClick"],Ke={class:"flex flex-col gap-2"},Ye=["onClick"],ze=["onClick"],Je={class:"flex items-center justify-center"},We=["onClick"],Ze={class:"flex items-center justify-center"},Qe=["onClick"],et={class:"flex items-center justify-center"},tt=["onClick"],ot={class:"flex items-center justify-center h-full"},st={class:"flex justify-end p-4"},nt={class:"-my-4"},lt={class:"mt-2"},it={class:"mt-6 flex justify-center text-white"},jt=ne({__name:"index",setup(at){const U=le(),j=he(),{pager:v,getLists:r}=Ne({fetchFun:$e}),h=u(!1),C=u(!1),R=u(""),w=ie(),k=u({device_code:"",device_name:""}),{isConnected:B,onEvent:X,send:G}=Te(),{showAddDevice:A,addDeviceLoading:H,progressValue:$,refreshAccount:M,handleAddDeviceConfirm:rt,handleRefreshAccount:I}=Re({send:G,onEvent:X,onSuccess:s=>{const{msg:e,type:a}=s;switch(a){case p.ADD_DEVICE:case p.DEVICE_ONLINE:r();break;case p.GET_USER_INFO:q.value="",C.value=!1,b.value=null,h.value=!1,r();break;case p.APP_EXEC:case p.OPEN_APP:case p.OPEN_PERSON_CENTER:case p.GET_ACCOUNT_INFO:case p.DATA_SEND:case p.GET_ACCOUNT_INFO_COMPLETE:R.value=e;break}},onError:s=>{C.value=!0,$.value=0;const{code:e,error:a,type:c}=s;e==fe.DEVICE_OFFLINE&&r()}}),q=u(""),V=u(),{isLock:K,lockFn:Y}=ae(async()=>{try{await Ie(k.value),y.msgSuccess("更新成功"),P(),r()}catch(s){y.msgError(s||"更新失败")}}),z=s=>{var e;(e=w.value)==null||e.open(),k.value={device_code:s.device_code,device_name:s.device_name}},P=()=>{var s;(s=w.value)==null||s.close()},J=()=>{C.value=!1,I(b.value,V.value)},b=u(null),D=(s,e)=>{b.value=s.device_code,M.value=s.accounts,h.value=!0,V.value=e,I(b.value,e)},O=s=>{const{accounts:e,device_code:a,device_model:c,id:d}=s,_=e.find(N=>N.type==E.XHS);_?U.push({path:`/device/${d}`,query:{account:_.account,device_code:a,device_model:c}}):D(s,E.XHS)},S=u(),L=async()=>{var s;if(!B.value){y.msgError("连接失败，请检查网络连接");return}A.value=!0,await ve(),(s=S.value)==null||s.open()},W=s=>{j.$confirm({message:"确定删除该设备吗？",onConfirm:async()=>{try{await Ve({id:s.id,device_code:s.device_code}),y.msgSuccess("删除设备成功"),r()}catch(e){y.msgError(e||"删除失败")}}})};return r(),(s,e)=>{const a=_e,c=ge,d=Ce,_=be,N=De,Z=ke,Q=we,ee=Ae,te=xe,oe=ye,se=Ee;return m(),re(me,null,[t("div",Le,[t("div",Fe,[e[7]||(e[7]=t("img",{src:Se,class:"w-11 mt-7"},null,-1)),t("div",null,[t("div",Ue,T(n(ce)[n(de).DEVICE]),1),e[6]||(e[6]=t("div",{class:"text-[#00000080]"}," 一键绑定跨平台设备，激活智能流程引擎，全链路接管部门任务，让团队拥有数字化中枢管家。 ",-1))])]),t("div",je,[t("div",Be,[t("div",Xe,[t("span",Ge,"设备总数量："+T(n(v).count)+"台",1),o(c,{text:"",onClick:e[0]||(e[0]=l=>n(r)())},{default:i(()=>[o(a,{name:"el-icon-Refresh"}),e[8]||(e[8]=t("span",{class:"text-[#86909C]"},"刷新",-1))]),_:1})]),t("div",null,[o(c,{type:"primary",class:"!rounded-full !h-10",onClick:L},{default:i(()=>[o(a,{name:"local-icon-add_circle"}),e[9]||(e[9]=t("span",{class:"ml-2"},"添加设备",-1))]),_:1})])]),t("div",He,[pe((m(),x(Z,{data:n(v).lists,height:"100%",stripe:"","row-style":{height:"60px"},"header-cell-style":{height:"63px"}},{empty:i(()=>[t("div",ot,[e[19]||(e[19]=f(" 还没有设备，",-1)),o(c,{type:"primary",link:"",onClick:L},{default:i(()=>[...e[18]||(e[18]=[f("点击添加设备",-1)])]),_:1})])]),default:i(()=>[o(d,{prop:"device_name",label:"设备名称","show-overflow-tooltip":""},{default:i(({row:l})=>[t("div",Me,[o(c,{type:"primary",link:"",onClick:g=>O(l)},{default:i(()=>[f(T(l.device_name),1)]),_:2},1032,["onClick"]),t("span",{class:"cursor-pointer leading-[0]",onClick:g=>z(l)},[o(a,{name:"el-icon-Edit",color:"var(--color-primary)"})],8,qe)])]),_:1}),o(d,{prop:"device_model",label:"设备型号","show-overflow-tooltip":""}),o(d,{prop:"sdk_version",label:"当前SDK版本","show-overflow-tooltip":""}),o(d,{prop:"device_code",label:"设备码","show-overflow-tooltip":""}),o(d,{label:"设备状态"},{default:i(({row:l})=>[l.status==1?(m(),x(_,{key:0,type:"success","disable-transitions":!0},{default:i(()=>[...e[10]||(e[10]=[f("在线",-1)])]),_:1})):l.status==2?(m(),x(_,{key:1,type:"primary","disable-transitions":!0},{default:i(()=>[...e[11]||(e[11]=[f("工作中",-1)])]),_:1})):(m(),x(_,{key:2,type:"danger","disable-transitions":!0},{default:i(()=>[...e[12]||(e[12]=[f("离线",-1)])]),_:1}))]),_:1}),o(d,{prop:"create_time",label:"绑定时间",width:"180","show-overflow-tooltip":""}),o(d,{prop:"name",label:"操作",width:"100",fixed:"right"},{default:i(({row:l})=>[o(N,{"show-arrow":!1,"popper-class":"!w-[130px] !min-w-[130px] !p-[6px] !rounded-xl"},{reference:i(()=>[o(c,{link:""},{default:i(()=>[o(a,{name:"el-icon-MoreFilled"})]),_:1})]),default:i(()=>[t("div",Ke,[t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:g=>O(l)},[o(a,{name:"el-icon-User"}),e[13]||(e[13]=t("span",null,"账号详情",-1))],8,Ye),t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:g=>D(l,n(E).XHS)},[t("span",Je,[o(a,{name:"el-icon-Refresh"})]),e[14]||(e[14]=t("span",null,"更新小红书",-1))],8,ze),t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:g=>D(l,n(E).DOUYIN)},[t("span",Ze,[o(a,{name:"el-icon-Refresh"})]),e[15]||(e[15]=t("span",null,"更新抖音",-1))],8,We),t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:g=>D(l,n(E).KUAISHOU)},[t("span",et,[o(a,{name:"el-icon-Refresh"})]),e[16]||(e[16]=t("span",null,"更新快手",-1))],8,Qe),t("div",{class:"px-2 py-1 hover:bg-primary-light-9 rounded-lg cursor-pointer flex items-center gap-2",onClick:g=>W(l)},[o(a,{name:"el-icon-Delete"}),e[17]||(e[17]=t("span",null,"删除",-1))],8,tt)])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[se,n(v).loading]])]),t("div",st,[o(Q,{modelValue:n(v),"onUpdate:modelValue":e[1]||(e[1]=l=>ue(v)?v.value=l:null),onChange:n(r)},null,8,["modelValue","onChange"])])])]),n(A)?(m(),x(Pe,{key:0,ref_key:"addDeviceRef",ref:S,"bind-loading":n(H),onClose:e[2]||(e[2]=l=>A.value=!1),onConfirm:n(r)},null,8,["bind-loading","onConfirm"])):F("",!0),n(h)?(m(),x(Oe,{key:1,"progress-value":n($),"progress-error":n(C),step:n(R),onClose:e[3]||(e[3]=l=>h.value=!1),onRetry:J},null,8,["progress-value","progress-error","step"])):F("",!0),o(oe,{ref_key:"editPopupRef",ref:w,"append-to-body":"","show-close":!1,"cancel-button-text":"","confirm-button-text":""},{default:i(()=>[t("div",nt,[t("div",{class:"absolute top-2 right-2 w-6 h-6",onClick:P},[o(ee,{"icon-size":12})]),e[21]||(e[21]=t("div",{class:"text-2xl font-bold"},"重命名",-1)),t("div",lt,[o(te,{modelValue:n(k).device_name,"onUpdate:modelValue":e[4]||(e[4]=l=>n(k).device_name=l),placeholder:"请输入名称",class:"!h-11",clearable:"",maxlength:"50"},null,8,["modelValue"])]),t("div",it,[o(c,{type:"primary",round:"",class:"!h-[50px] shadow-[0px_6px_12px_0px_rgba(0,101,251,0.20)] w-[70%] !rounded-full",loading:n(K),onClick:e[5]||(e[5]=l=>n(Y)())},{default:i(()=>[...e[20]||(e[20]=[f(" 确定 ",-1)])]),_:1},8,["loading"])])])]),_:1},512)],64)}}});export{jt as default};
