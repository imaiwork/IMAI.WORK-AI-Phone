import{d as fe,r,k as a,l as d,q as l,s as n,m as e,Z as t,t as c,J as O,K as ue,v as _e,L as P,aI as ve,bM as j,I as _,ai as W,G as T,y as he,ay as xe,cY as ge,u as ye,_ as Te}from"./entry.8705b591.js";import{E as we}from"./index.d9a24f65.js";import{E as Ee,a as ke}from"./el-tabs.5286b06f.js";import{E as be}from"./el-empty.a2e85def.js";import{E as Se}from"./index.92324cf0.js";/* empty css               *//* empty css                  */import{AccountTypeMap as Ae,AccountTypeEnum as Ce,AccountSource as Pe}from"./index.cf59f1a8.js";import{PushTypeEnum as w}from"./index.a1206616.js";import{_ as De}from"./user-flow.vue.9bd01498.js";import Fe from"./user-todo.bdfd7c7f.js";import K from"./user-sop.5aed702c.js";import Ne from"./useHandle.727f0a04.js";import Be from"./useTodo.0c28e667.js";import{_ as Ve}from"./friends-bind-tag.vue.611d32b1.js";import{_ as $e}from"./user-todo-edit.vue.902a468f.js";import{E as D}from"./index.d5b2ab73.js";import"./raf.11208e2e.js";import"./strings.05ad2423.js";import"./clamp.2d199c02.js";import"./toNumber.9701a4c1.js";import"./index.554f7908.js";/* empty css                     */import"./7_day.257301c1.js";import"./flow_title_img.b33c9278.js";import"./el-image.1d071b41.js";import"./el-image-viewer.98cbed9e.js";import"./throttle.2aefc6f7.js";import"./debounce.4efe57e2.js";import"./index.vue.a44fb124.js";import"./index.vue.f28f8d8c.js";import"./date.95a59cef.js";import"./vue-virtual-scroller.esm.bc1f9c4d.js";/* empty css                             */import"./mini-program-card.vue.1b3fb3a1.js";import"./link-card.vue.b31b34fe.js";import"./file-card.vue.d1c72cc2.js";import"./person_wechat.703f63bb.js";import"./usePaging.0c251ebb.js";import"./index.7002e1fb.js";import"./_baseIteratee.889eaccd.js";import"./index.f9213b2f.js";/* empty css                  */import"./el-date-picker-panel.5733be69.js";import"./customParseFormat.cc1515cd.js";import"./panel-time-pick.d92b5a96.js";import"./index.506eb19c.js";const Ue={class:"relative w-full h-full flex"},Re={class:"flex-shrink-0"},Le={class:"h-full flex-1 flex flex-col bg-[#F5F6F9] overflow-hidden"},ze={class:"flex-shrink-0 bg-white px-4 border-b border-[#E6E6E6] pb-5 relative"},Ie={class:"flex items-center gap-x-4 mt-5"},Oe=["src"],je={class:"text-xs text-[#9E9E9E]"},We={class:"text-[#42453F] text-[15px] font-bold"},Ke={class:"mt-5 flex gap-x-12"},Me={class:"text-[#07C160] text-xs"},qe={class:"text-[#494949] text-xs mt-1"},Ge={class:"t"},He={class:"text-xs"},Je={class:""},Ye={class:"text-xs"},Ze={class:"mt-5 border border-[#DBDBDB] rounded-lg p-3"},Qe={class:"flex items-center justify-between"},Xe={class:"flex flex-wrap gap-2 mt-4"},et={key:0,class:"absolute -top-1 -right-1"},tt=["onClick"],st={class:""},ot={class:"w-[14px] h-[14px] bg-primary flex items-center justify-center rounded-[2px]"},lt={class:"grow min-h-0 flex gap-x-6 mt-6 w-full"},at={class:"flex-1 flex flex-col w-full overflow-hidden"},nt={class:"px-4 py-6"},it={key:1,class:"mt-14"},rt={class:"px-4 py-6"},dt={key:1,class:"mt-14"},ct={class:"px-4 py-6"},pt={key:1,class:"mt-14"},mt=fe({__name:"user-detail-panel",emits:["close","changeTodo","changeTag"],setup(ft,{expose:M,emit:q}){const v=q,G=ye(),{currentWechat:F,currentFriend:N,friendInfo:p,friendTagLists:H,friendSopFlow:J,friendSopPush:h,getFriendTagDetail:B,deleteFriendTag:Y,getWeChatFriendSopFlow:V,getWeChatFriendSopPush:x,deleteWeChatFriendSopPush:Z}=Ne(),{todoPager:m,todoParams:$,getTodoLists:Q,resetTodoPage:U,handleDeleteTodo:X}=Be(),u=r(!1),f=r("1"),ee=async o=>{o.paneName!=f.value&&(o.paneName==="1"&&await V(),o.paneName==="2"&&await U(),o.paneName==="3"?await x({push_type:w.AUTO_SOP}):o.paneName==="4"&&await x({push_type:w.TASK}))},E=r(!1),k=r(!1),R=r(),te=async()=>{var o;k.value=!0,await W(),(o=R.value)==null||o.open()},se=o=>{G.$confirm({message:"确定要删除该标签吗？",onConfirm:async()=>{try{await Y(o),v("changeTag"),T.msgSuccess("删除标签成功")}catch(s){T.msgError(s)}}})},oe=async o=>{await X(o),v("changeTodo")},le=r(),ae=o=>{o=="bottom"&&m.isLoad&&!m.loading&&(m.page++,Q())},L=async o=>{try{await Z({id:o}),T.msgSuccess("删除成功"),f.value=="3"?x({push_type:w.AUTO_SOP}):f.value=="4"&&x({push_type:w.TASK})}catch(s){T.msgError(s)}},b=r(!1),S=r(),ne=async o=>{var s;b.value=!0,await W(),(s=S.value)==null||s.open(o.todo_type),S.value.setFormData(o)},ie=async()=>{m.lists=[],U()},A=r(!0),re=async()=>{u.value=!0,A.value=!0,$.friend_id=N.value.UserName,$.wechat_id=F.value.wechat_id;try{await Promise.allSettled([B(),V()])}finally{A.value=!1}},z=()=>{u.value=!1,v("close")};return M({open:re}),(o,s)=>{const g=he,I=xe,de=we,y=Ee,C=be,ce=ke,pe=Se,me=ge;return a(),d(O,null,[l(pe,{modelValue:t(u),"onUpdate:modelValue":s[2]||(s[2]=i=>j(u)?u.value=i:null),class:"user-detail-panel",size:"1000px","show-close":!1,onClose:z},{default:n(()=>[e("div",Ue,[e("div",Re,[l(I,{type:"primary",class:"w-10 h-10 mt-2",onClick:z},{default:n(()=>[l(g,{name:"local-icon-close",size:24,color:"#ffffff"})]),_:1})]),e("div",Le,[e("div",ze,[e("div",Ie,[e("img",{src:t(p).avatar,class:"w-12 h-12 rounded object-cover"},null,8,Oe),e("div",null,[e("div",je,c(t(p).remark||"-"),1),e("div",We,c(t(p).nickname),1)])]),e("div",Ke,[e("div",null,[s[6]||(s[6]=e("div",{class:"text-[#8A8A8A]"},"账号类型：",-1)),e("div",Me,"@"+c(t(Ae)[t(Ce).Personal]),1)]),e("div",null,[s[7]||(s[7]=e("div",{class:"text-[#8A8A8A]"},"来源方式：",-1)),e("div",qe,c(t(Pe)[t(p).source]||"未知"),1)]),e("div",Ge,[s[8]||(s[8]=e("div",{class:"text-[#8A8A8A]"},"出生日期：",-1)),e("div",He,c(t(p).birth_date||"暂无"),1)]),e("div",Je,[s[9]||(s[9]=e("div",{class:"text-[#8A8A8A]"},"联系地址：",-1)),e("div",Ye,c(t(p).contact_address||"暂无"),1)])]),e("div",Ze,[e("div",Qe,[s[10]||(s[10]=e("div",{class:"font-bold"},"客户标签",-1)),l(I,{link:"",onClick:s[0]||(s[0]=i=>E.value=!t(E))},{default:n(()=>[l(g,{name:"el-icon-Edit",color:"#9E9E9E",size:16})]),_:1})]),e("div",Xe,[(a(!0),d(O,null,ue(t(H),i=>(a(),d("div",{key:i.id,class:"relative"},[l(de,{type:"primary"},{default:n(()=>[_e(c(i.tag_name),1)]),_:2},1024),t(E)?(a(),d("div",et,[e("span",{class:"bg-[#D43030] rounded-full w-[14px] h-[14px] flex items-center justify-center cursor-pointer",onClick:ut=>se(i.tag_id)},[l(g,{name:"el-icon-Close",size:10,color:"#ffffff"})],8,tt)])):P("",!0)]))),128)),e("div",st,[e("div",{class:"h-[24px] w-[64px] el-tag el-tag--primary el-tag--light",onClick:te},[e("span",ot,[l(g,{name:"el-icon-Plus",size:10,color:"#ffffff"})])])])])])]),e("div",lt,[ve((a(),d("div",at,[l(ce,{modelValue:t(f),"onUpdate:modelValue":s[1]||(s[1]=i=>j(f)?f.value=i:null),class:"tab-panel h-full w-full rounded-tr-md",type:"border-card",onTabClick:ee},{default:n(()=>[l(y,{label:"客户流程",name:"1"},{default:n(()=>[l(De,{"flow-data":t(J)},null,8,["flow-data"])]),_:1}),l(y,{label:"待办活动",name:"2"},{default:n(()=>[l(t(D),{class:"h-full",ref_key:"todoScrollRef",ref:le,onEndReached:ae},{default:n(()=>[e("div",nt,[t(m).lists.length>0?(a(),_(Fe,{key:0,list:t(m).lists,onEdit:ne,onDelete:oe},null,8,["list"])):(a(),d("div",it,[l(C,{description:"暂无内容"})]))])]),_:1},512)]),_:1}),l(y,{label:"SOP任务",name:"3"},{default:n(()=>[l(t(D),{class:"h-full"},{default:n(()=>[e("div",rt,[t(h).length>0?(a(),_(K,{key:0,list:t(h),onDelete:L},null,8,["list"])):(a(),d("div",dt,[l(C,{description:"暂无内容"})]))])]),_:1})]),_:1}),l(y,{label:"群发任务",name:"4"},{default:n(()=>[l(t(D),{class:"h-full"},{default:n(()=>[e("div",ct,[t(h).length>0?(a(),_(K,{key:0,list:t(h),onDelete:L},null,8,["list"])):(a(),d("div",pt,[l(C,{description:"暂无内容"})]))])]),_:1})]),_:1})]),_:1},8,["modelValue"])])),[[me,t(A)]])])])])]),_:1},8,["modelValue"]),t(k)?(a(),_(Ve,{key:0,ref_key:"friendsBindTagRef",ref:R,onClose:s[3]||(s[3]=i=>k.value=!1),onSuccess:s[4]||(s[4]=i=>{v("changeTag"),t(B)()})},null,512)):P("",!0),t(b)?(a(),_($e,{key:1,ref_key:"userTodoEditRef",ref:S,"wechat-id":t(F).wechat_id,"friend-id":t(N).UserName,onClose:s[5]||(s[5]=i=>b.value=!1),onConfirm:ie},null,8,["wechat-id","friend-id"])):P("",!0)],64)}}});const rs=Te(mt,[["__scopeId","data-v-efeaa200"]]);export{rs as default};
