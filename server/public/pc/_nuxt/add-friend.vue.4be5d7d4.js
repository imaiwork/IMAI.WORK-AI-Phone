import{d as U,A as S,r as R,aG as q,cy as D,G as J,k as f,I as $,s as a,m as e,q as t,Z as l,$ as M,v as L,t as h,bM as X,l as w,K as Z,J as H,cX as O,y as Q,ay as Y,av as ee,u as se}from"./entry.45b56a4a.js";import{a as te,E as ne}from"./index.b74582d2.js";import{_ as oe}from"./index.vue.96e940f8.js";import{E as le}from"./index.515d6243.js";import{E as ae}from"./el-empty.2f864f77.js";/* empty css                        *//* empty css               *//* empty css                     */import{u as ie}from"./usePaging.9b885ff9.js";import{y as ce,z as re}from"./person_wechat.703f63bb.js";import{_ as de}from"./sidebar-panel.vue.af6d184c.js";const fe={class:"w-full bg-white rounded-lg flex h-[50vh] overflow-hidden"},pe={class:"w-[94px] flex-shrink-0"},_e={class:"flex-1 flex flex-col border-r border-gray-200"},ue={class:"flex-shrink-0"},me={class:"h-[70px] flex items-center justify-end px-4"},he={class:"grow min-h-0"},xe=["src"],ve={class:"p-4 flex justify-end"},ge={class:"w-[248px] flex-shrink-0 flex flex-col"},we={class:"flex-shrink-0"},ye={class:"w-full h-[66px] bg-primary flex justify-between items-center px-4"},ke={class:"text-white"},be={class:"grow min-h-0 py-4"},Ce={class:"flex flex-col gap-y-4 px-4"},Ee=["src"],Se={class:"flex-1 text-[#414142]"},Re={class:"line-clamp-1"},$e=["onClick"],Le={key:1,class:"flex items-center justify-center h-full"},Ve={class:"flex-shrink-0 mx-2 py-2"},Ie={class:"absolute -right-10 top-2"},qe=U({__name:"add-friend",props:{wechatId:{}},emits:["close","success"],setup(y,{expose:V,emit:I}){const k=y,b=I,F=se(),C=S(),r=S(),x=R([]),p=q({wechat_id:"",nickname:""}),{pager:_,getLists:v}=ie({fetchFun:ce,params:p}),g=async()=>{var s,c;await v();const o=(s=r.value)==null?void 0:s.getSelectionRows();(c=r.value)==null||c.clearSelection(),o.forEach(d=>{var u;(u=r.value)==null||u.toggleRowSelection(d)})},i=R([]),B=o=>{i.value=o},T=async o=>{var s;(s=r.value)==null||s.toggleRowSelection(o,void 0)},j=async()=>{await F.$confirm({message:"确定要清空吗？",onConfirm:async()=>{var o;i.value=[],(o=r.value)==null||o.clearSelection()}})},{isLock:z,lockFn:N}=D(async()=>{if(i.value.length===0){J.msgWarning("请选择要添加的好友");return}E(),b("success",i.value)}),W=async()=>{const{lists:o}=await re({page_size:999,wechat_id:k.wechatId});x.value=o,x.value.length>0&&(p.wechat_id=k.wechatId,v())},A=()=>{var o;(o=C.value)==null||o.open(),W()},E=()=>{b("close")};return V({open:A}),(o,s)=>{const c=Q,d=Y,u=ee,m=ne,K=oe,P=le,G=ae;return f(),$(O,{"custom-class":"add-friend",ref_key:"popupRef",ref:C,"hide-title":"",width:"900px","show-close":!1,"cancel-button-text":"","confirm-button-text":""},{default:a(()=>[e("div",fe,[e("div",pe,[t(de,{"wechat-list":l(x),"show-add-we-chat":!1,"current-wechat":{wechat_id:y.wechatId}},null,8,["wechat-list","current-wechat"])]),e("div",_e,[e("div",ue,[e("div",me,[t(u,{modelValue:l(p).nickname,"onUpdate:modelValue":s[1]||(s[1]=n=>l(p).nickname=n),placeholder:"搜索",class:"!w-[200px] h-[32px]",clearable:"",onClear:s[2]||(s[2]=n=>g()),onKeyup:s[3]||(s[3]=M(n=>g(),["enter"]))},{append:a(()=>[t(d,{onClick:s[0]||(s[0]=n=>g())},{default:a(()=>[t(c,{name:"el-icon-Search"})]),_:1})]),_:1},8,["modelValue"])])]),e("div",he,[t(l(te),{ref_key:"friendTableRef",ref:r,data:l(_).lists,stripe:"",height:"100%","row-style":{height:"60px"},"row-key":"friend_id",onSelectionChange:B},{default:a(()=>[t(m,{type:"selection","reserve-selection":"",width:"55",fixed:"left"}),t(m,{prop:"friend_nickname",label:"微信名称"}),t(m,{prop:"avatar",label:"头像"},{default:a(({row:n})=>[e("img",{src:n.friend_avatar,class:"w-8 h-8 rounded mx-auto"},null,8,xe)]),_:1}),t(m,{prop:"remark",label:"备注名称"},{default:a(({row:n})=>[L(h(n.remark||"-"),1)]),_:1})]),_:1},8,["data"])]),e("div",ve,[t(K,{modelValue:l(_),"onUpdate:modelValue":s[4]||(s[4]=n=>X(_)?_.value=n:null),onChange:l(v)},null,8,["modelValue","onChange"])])]),e("div",ge,[e("div",we,[e("div",ye,[e("div",ke,"已选好友（"+h(l(i).length)+"）人",1),t(d,{link:"",onClick:j},{default:a(()=>[t(c,{name:"local-icon-clean",size:16,color:"#ffffff"}),s[5]||(s[5]=e("span",{class:"text-white ml-2"},"清空",-1))]),_:1})])]),e("div",be,[l(i).length>0?(f(),$(P,{key:0},{default:a(()=>[e("div",Ce,[(f(!0),w(H,null,Z(l(i),n=>(f(),w("div",{key:n.friend_id,class:"flex items-center gap-x-4"},[e("img",{src:n.friend_avatar,class:"flex-shrink-0 w-8 h-8 rounded"},null,8,Ee),e("div",Se,[e("div",Re,h(n.friend_nickname),1),e("div",null,h(n.remark||"-"),1)]),e("div",{class:"flex-shrink-0 w-4 h-4 rounded-full bg-error flex items-center justify-center cursor-pointer",onClick:Fe=>T(n)},[t(c,{name:"local-icon-close",color:"#ffffff"})],8,$e)]))),128))])]),_:1})):(f(),w("div",Le,[t(G,{description:"暂无数据"})]))]),e("div",Ve,[t(d,{type:"primary",class:"w-full !h-[37px]",loading:l(z),onClick:l(N)},{default:a(()=>[...s[6]||(s[6]=[L(" 确定添加 ",-1)])]),_:1},8,["loading","onClick"])])])]),e("div",Ie,[t(d,{circle:"",type:"primary",onClick:E},{default:a(()=>[t(c,{name:"local-icon-close",color:"#ffffff",size:16})]),_:1})])]),_:1},512)}}});export{qe as _};
