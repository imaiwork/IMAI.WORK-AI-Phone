import{_ as L}from"./index.vue.3f013733.js";import{d as P,au as j,z as $,aH as K,c as _,A as Z,r as X,aG as Q,cy as W,D as Y,k as m,I as A,s as r,m as o,q as l,Z as s,cZ as ee,l as y,K as te,J as N,v as S,t as oe,L as se,cX as ne,dv as x,G as E,y as ae,av as le,aw as re,az as ie,ay as ce,_ as de}from"./entry.8705b591.js";import{E as me,a as pe}from"./index.7002e1fb.js";import{_ as ue}from"./index.4557d148.js";/* empty css                  *//* empty css               *//* empty css                     */import{s as fe,v as _e}from"./digital_human.299b9036.js";import{DigitalHumanModelVersionEnum as i}from"./index.d52c6f2c.js";import"./index.d5b2ab73.js";import"./index.d9a24f65.js";import"./strings.05ad2423.js";import"./_baseIteratee.889eaccd.js";import"./toNumber.9701a4c1.js";import"./clamp.2d199c02.js";import"./index.f9213b2f.js";import"./index.b44dd729.js";import"./index.b617bec7.js";import"./cloneDeep.699e051d.js";/* empty css                  *//* empty css                    *//* empty css                  */const xe={class:"-my-4"},he={class:"flex items-center gap-x-1 rounded-full bg-[#ffffff08] p-1 mt-5 w-fit"},ve={class:"h-[166px] bg-app-bg-1 rounded-lg flex flex-col justify-center items-center"},ge={class:"w-12 h-12 rounded-xl flex items-center justify-center border border-dashed border-[#ffffff1a] hover:border-[#ffffff33] cursor-pointer mt-8 flex-shrink-0"},we={class:"px-[35px] mt-[18px]"},ke=P({__name:"add-pop",emits:["success","close"],setup(be,{expose:C,emit:I}){const h=I,V=j(),d=$(),{userTokens:H}=K(d),v=_(()=>{const{channel:t}=V.getDigitalHumanConfig;return t&&t.length>0?t.filter(a=>{if(a.id=parseInt(a.id),a.status==1&&(i.SHANJIAN==a.id||i.CHANJING==a.id||i.STANDARD==a.id))return a}):[]}),p=_(()=>{var t,e,a;return{[i.STANDARD]:(t=d.getTokenByScene(x.HUMAN_VOICE))==null?void 0:t.score,[i.CHANJING]:(e=d.getTokenByScene(x.HUMAN_VOICE_CHANJING))==null?void 0:e.score,[i.SHANJIAN]:(a=d.getTokenByScene(x.HUMAN_VOICE_SHANJIAN))==null?void 0:a.score}[n.model_version]}),u=Z(),g=X(),n=Q({url:"",name:"",gender:"male",model_version:i.STANDARD}),B={name:[{required:!0,message:"请输入音色名称"}],url:[{required:!0,message:"请上传音频"}],model_version:[{required:!0,message:"请选择模型"}]},D=_(()=>".mp3,.m4a,.wav"),R=t=>{const{data:{uri:e}}=t;n.url=e},T=()=>{u.value.open()},F=async()=>{var t;if(H.value<p.value){E.msgPowerInsufficient();return}await g.value.validate();try{await n.model_version==i.SHANJIAN?await fe({name:n.name,audio_url:n.url}):await _e(n),(t=u.value)==null||t.close(),d.getUser(),h("success")}catch(e){E.msgError(e||"克隆失败")}},w=()=>{h("close")},{lockFn:J,isLock:k}=W(F);return Y(()=>v.value,t=>{t&&t.length>0&&(n.model_version=t[0].id)},{immediate:!0}),C({open:T}),(t,e)=>{const a=L,b=ae,M=le,f=re,U=me,G=pe,O=ue,q=ie,z=ce;return m(),A(ne,{ref_key:"popupRef",ref:u,width:"400px",async:"",style:{padding:"18px","background-color":"var(--app-bg-color-2)"},"confirm-button-text":"","cancel-button-text":"","show-close":!1,onClose:w},{default:r(()=>[o("div",xe,[o("div",{class:"w-6 h-6 absolute top-4 right-4",onClick:w},[l(a,{theme:s(ee).DARK},null,8,["theme"])]),e[6]||(e[6]=o("div",{class:"flex items-center gap-x-2"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[o("rect",{width:"20",height:"20",rx:"10",fill:"#0065FB"}),o("path",{d:"M6 8V12",stroke:"white","stroke-width":"1.2"}),o("path",{d:"M14 8V12",stroke:"white","stroke-width":"1.2"}),o("path",{d:"M10 6V14",stroke:"white","stroke-width":"1.2"})]),o("span",{class:"text-white font-bold text-[20px]"},"上传本地音频")],-1)),o("div",he,[l(b,{name:"local-icon-tips",size:16}),e[2]||(e[2]=o("span",{class:"text-[#ffffff4d] text-xs"},"注意：请根据性别上传对应的音频文件素材。",-1))]),l(q,{class:"mt-[17px]",model:s(n),rules:B,ref_key:"formRef",ref:g,"label-position":"top",disabled:s(k)},{default:r(()=>[l(f,{label:"音色名称",prop:"name"},{default:r(()=>[l(M,{modelValue:s(n).name,"onUpdate:modelValue":e[0]||(e[0]=c=>s(n).name=c),class:"!h-11",placeholder:"请输入音色名称",maxlength:"30"},null,8,["modelValue"])]),_:1}),l(f,{label:"使用模型",prop:"model_version"},{default:r(()=>[l(G,{modelValue:s(n).model_version,"onUpdate:modelValue":e[1]||(e[1]=c=>s(n).model_version=c),class:"!h-11","popper-class":"dark-select-popper","show-arrow":!1,placeholder:"请选择模型"},{default:r(()=>[(m(!0),y(N,null,te(s(v),c=>(m(),A(U,{key:c.id,value:c.id,label:c.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"上传音频",prop:"url"},{default:r(()=>[l(O,{class:"w-full",drag:"",type:"audio","list-type":"text",limit:1,"max-size":10,accept:s(D),onSuccess:R},{default:r(()=>[o("div",ve,[o("div",ge,[l(b,{name:"el-icon-Plus",color:"#ffffff"})]),e[3]||(e[3]=o("div",{class:"text-white text-xs mt-3"},"上传录音文件",-1)),e[4]||(e[4]=o("div",{class:"text-xs text-[rgba(255,255,255,0.3)] text-center mt-4"}," 文件不超过20MB,不支持gif/avif等音频格式以外的文件 ",-1))])]),_:1},8,["accept"])]),_:1})]),_:1},8,["model","disabled"]),o("div",we,[l(z,{type:"primary",class:"w-full !h-[50px] !rounded-full",loading:s(k),onClick:s(J)},{default:r(()=>[e[5]||(e[5]=S("开始转写 ",-1)),s(p)?(m(),y(N,{key:0},[S("（消耗"+oe(s(p))+"算力）",1)],64)):se("",!0)]),_:1},8,["loading","onClick"])])])]),_:1},512)}}});const Pe=de(ke,[["__scopeId","data-v-d2fbdcf1"]]);export{Pe as default};
